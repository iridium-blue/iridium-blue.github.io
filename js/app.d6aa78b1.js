(function(t){function e(e){for(var s,o,r=e[0],c=e[1],l=e[2],d=0,m=[];d<r.length;d++)o=r[d],a[o]&&m.push(a[o][0]),a[o]=0;for(s in c)Object.prototype.hasOwnProperty.call(c,s)&&(t[s]=c[s]);u&&u(e);while(m.length)m.shift()();return i.push.apply(i,l||[]),n()}function n(){for(var t,e=0;e<i.length;e++){for(var n=i[e],s=!0,r=1;r<n.length;r++){var c=n[r];0!==a[c]&&(s=!1)}s&&(i.splice(e--,1),t=o(o.s=n[0]))}return t}var s={},a={app:0},i=[];function o(e){if(s[e])return s[e].exports;var n=s[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=t,o.c=s,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)o.d(n,s,function(e){return t[e]}.bind(null,s));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],c=r.push.bind(r);r.push=e,r=r.slice();for(var l=0;l<r.length;l++)e(r[l]);var u=c;i.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"003a":function(t,e,n){"use strict";var s=n("d662"),a=n.n(s);a.a},"034f":function(t,e,n){"use strict";var s=n("c21b"),a=n.n(s);a.a},"088d":function(t,e,n){},"0e93":function(t,e,n){"use strict";var s=n("1b68"),a=n.n(s);a.a},1:function(t,e){},1435:function(t,e,n){"use strict";var s=n("410f"),a=n.n(s);a.a},"178d":function(t,e,n){"use strict";var s=n("da9c"),a=n.n(s);a.a},"1b68":function(t,e,n){},2:function(t,e){},3:function(t,e){},"31dd":function(t,e,n){"use strict";var s=n("fdca"),a=n.n(s);a.a},"366c":function(t,e,n){"use strict";var s=n("9be0"),a=n.n(s);a.a},"3e91":function(t,e,n){},"3f47":function(t,e,n){"use strict";var s=n("5764"),a=n.n(s);a.a},4:function(t,e){},"410f":function(t,e,n){},"44f7":function(t,e,n){},"48bb":function(t,e,n){"use strict";var s=n("088d"),a=n.n(s);a.a},"4d3c":function(t,e,n){"use strict";var s=n("b7fe"),a=n.n(s);a.a},"52be":function(t,e,n){"use strict";var s=n("d8f1"),a=n.n(s);a.a},"52db":function(t,e,n){"use strict";var s=n("c742"),a=n.n(s);a.a},5582:function(t,e,n){"use strict";var s=n("ee67"),a=n.n(s);a.a},"56d7":function(t,e,n){"use strict";n.r(e);n("6762"),n("2fdb"),n("28a5"),n("cadf"),n("551c"),n("097d");var s=n("2b0e"),a=n("a925"),i=n("c16e"),o=n.n(i),r=n("2b52"),c=n("85ff"),l=n.n(c),u=(n("d06d"),n("0874")),d=n("f78c"),m=n.n(d),v=n("31bd"),p=n("8a03"),f=n.n(p),b=(n("5abe"),n("da28")),h=n.n(b),g=(n("4418"),n("55ab"),n("2ef0")),C=n.n(g),w=n("e508"),_=n("9483");Object(_["a"])("".concat("/","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},cached:function(){console.log("Content has been cached for offline use.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(t){console.error("Error during service worker registration:",t)}});var y=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"mdl-layout mdl-js-layout mdl-layout--fixed-header",attrs:{id:"app"}},[n("router-view",{attrs:{name:"hdr"}}),n("main",{staticClass:"mdl-layout__content"},[n("div",{staticClass:"page-content"},[n("router-view")],1)])],1)},x=[],O=(n("ac6a"),console.log);function k(t){return Array.prototype.slice.call(document.querySelectorAll(t),0)}function D(){var t=k(".navbar-item.has-dropdown:not(.is-hoverable)"),e=k(".burger");function n(){t.forEach(function(t){t.classList.remove("is-active")})}t.length>0&&(t.forEach(function(t){t.addEventListener("click",function(e){e.stopPropagation(),t.classList.toggle("is-active")})}),document.addEventListener("click",function(t){n()})),document.addEventListener("keydown",function(t){var e=t||window.event;27===e.keyCode&&n()}),e.length>0?(O("--- We haz ".concat(e.length," burgers. ---")),O(e),e.forEach(function(t){t.addEventListener("click",function(){var e=t.dataset.target,n=document.getElementById(e);t.classList.toggle("is-active"),n.classList.toggle("is-active")})})):O("--- Yes! We haz no burgers ---")}function E(){k(".burger").forEach(function(t){return t.classList.remove("is-active")}),k(".burger-bar").forEach(function(t){return t.classList.remove("is-active")})}O("        ############# Responsive menu event handling installed #############");var P={name:"app",data:function(){return{}},created:function(){document.addEventListener("DOMContentLoaded",D)}},S=P,I=(n("034f"),n("2877")),j=Object(I["a"])(S,y,x,!1,null,null,null);j.options.__file="App.vue";var T=j.exports,A=n("be94"),N=n("2f62"),L=(n("456d"),n("7f7f"),n("f751"),n("aef6"),n("68d3")),$=n.n(L),R=n("d6e1"),U=n("3de5"),M=n.n(U),F=n("5d16"),B=(n("638c"),n("4833")),J=n.n(B),Q=(console.log,"https"),Y="yourdb.yourpublic.work",q="ib2018_101",V={server:"https://wt-a0a68818c7b34a465e865e888dc419c9-0.sandbox.auth0-extend.com/webtasksso",authPath:"/authentication/google/start",tokenTimeToLive:2e4,tokenName:"tkn",activityName:"actv",authName:"authd",returnRouteName:"retRoute",localStorageNameSpace:"vuesppwa-",productionTip:!1,testAuthUrlEnvVar:"AUTH_TEST_URL",logger:{logLevel:"info",stringifyArguments:!1,showLogLevel:!0,showMethodName:!0,separator:"|",showConsoleColors:!0},version:"0.0.101",dbServerProtocol:Q,dbServerURI:Y,databaseName:q},z=Object(g["debounce"])(function(t,e,n,s){window.lgr.warn("deBouncedRefresh --\x3e Change to ".concat(t,": ").concat(e.action)),window.lgr.debug("".concat(JSON.stringify(e,null,2))),window.lgr.debug("".concat(JSON.stringify(n,null,2))),s(n)},50),G=void 0,K=V.databaseName,W=console.log;console.error;if(R["a"].plugin(M.a),R["a"].plugin(F["a"]),R["a"].plugin(J.a),!K)throw new Error("VuePouchDB Error → a main database name is expected !");var H=new R["a"](K),Z={spinner:null,start:function(t){if(Xr.getters.isAuthenticated<1)Xr.commit("dbmgr/setCategoriesLoading",!1);else{var e=Xr.getters["dbmgr/getCategoriesLoading"];e||(Z.spinner=t.open({container:null}),window.lgr.debug("Started loader spinner"))}},kill:function(){var t=Xr.getters["dbmgr/getCategoriesLoading"];window.lgr.debug("Checking loader spinner :: \n".concat(JSON.stringify(t,null,2))),t&&(Z.spinner.close(),window.lgr.debug("Killed loader spinner"))}},X={interceptors:{request:{interceptors:[],use:function(t){window.lgr.debug("\n        ??????????????????????????????\n          interceptor: ".concat(JSON.stringify(t,null,2),"\n        ??????????????????????????????")),G.interceptors.push(t)}}},get:function(t,e){return new Promise(function(n){window.lgr.debug("\n      endPoint: ".concat(JSON.stringify(t,null,2),"\n      parameters: ").concat(JSON.stringify(e,null,2),"\n    "));var s=Xr.getters["dbmgr/getDbMgr"];s.liveFind({aggregate:!0,selector:e.selector}).on("update",function(t,s){z(e.category,t,s,n)}).on("ready",function(){W("Initial query complete.")}).on("cancelled",function(){W("LiveFind cancelled.")}).on("error",function(t){W("Oh no!",t)})})}};H.setSchema([{singular:"product",plural:"allProducts"},{singular:"aBottle",plural:"allBottles",relations:{ultimo:{belongsTo:"aPerson"}}},{singular:"aPerson",plural:"allPersons",relations:{bottles:{hasMany:"aBottle"}}},{singular:"Customer",plural:"Customers",documentType:"aPerson"},{singular:"Inventory",plural:"Inventories",documentType:"aPerson"},{singular:"Movement",plural:"Movements",relations:{inventory:{belongsTo:"Inventory"},customer:{belongsTo:"Customer"},bottles:{hasMany:"aBottle"}}}]);var tt="idxTypeName";H.createIndex({index:{fields:["data.type","data.nombre"],name:tt,ddoc:"indexes"}}).then(function(t){window.lgr.debug("New index ".concat(tt," :: ").concat(JSON.stringify(t,null,2)))}).catch(function(t){window.lgr.debug("Failed to create index ".concat(tt," :: ").concat(JSON.stringify(t,null,2)))});var et="idxId";H.createIndex({index:{fields:["id"],name:et,ddoc:"indexes"}}).then(function(t){window.lgr.debug("New index ".concat(et," :: ").concat(JSON.stringify(t,null,2)))}).catch(function(t){window.lgr.debug("Failed to create index ".concat(et," :: ").concat(JSON.stringify(t,null,2)))});var nt="idxTypeCode";H.createIndex({index:{fields:["data.type","data.codigo"],name:nt,ddoc:"indexes"}}).then(function(t){window.lgr.debug("New index ".concat(nt," :: ").concat(JSON.stringify(t,null,2)))}).catch(function(t){window.lgr.debug("Failed to create index ".concat(nt," :: ").concat(JSON.stringify(t,null,2)))});var st="idxTypeId";H.createIndex({index:{fields:["data.type","data.id"],name:st,ddoc:"indexes"}}).then(function(t){window.lgr.debug("New index ".concat(st," :: ").concat(JSON.stringify(t,null,2)))}).catch(function(t){window.lgr.debug("Failed to create index ".concat(st," :: ").concat(JSON.stringify(t,null,2)))});var at="idxTypeInventory";H.createIndex({index:{fields:["data.type","data.inventory"],name:at,ddoc:"indexes"}}).then(function(t){window.lgr.debug("New index ".concat(at," :: ").concat(JSON.stringify(t,null,2)))}).catch(function(t){window.lgr.debug("Failed to create index ".concat(at," :: ").concat(JSON.stringify(t,null,2)))});var it=function(t){var e=t;e.pouch=H,e.prototype.$pouch=H},ot={install:it,PouchDB:R["a"],LoaderProgress:Z},rt=(n("a481"),function(t){var e="_";return t.replace(/[Áá]/g,"a").replace(/[Éé]/g,"e").replace(/[Íí]/g,"i").replace(/[Ôó]/g,"o").replace(/[Úú]/g,"u").replace(/[ñÑ]/g,"n").replace(/[a-z][A-Z]/g,function(t){return"".concat(t[0]," ").concat(e," ").concat(t[1].toLowerCase())}).replace(/\W$/g,"").replace(/\W/g,"_").replace(/_{1,}/g,"_").replace(/[A-Z]/g,function(t){return t.toLowerCase()})}),ct=function(t){return t.map(function(t){return rt(t)})},lt=(console.log,{text:function(t){return t},integer:function(t){return t},title:function(t){return t},percent:function(t,e){var n="number"===typeof t?t:parseFloat(t);return{raw:parseFloat((n||0).toFixed(4)),str:"".concat((100*(n||0)).toFixed(e||1),"%")}},boolean:function(t){return"si"===t},JSON1:function(t,e){return e.JSON1.fn(e.JSON1.vl)},foreignKey1:function(t,e){var n=e.foreignKey1.fn(e.foreignKey1.vl);return n},usd:function(t){return{raw:(t||0).toFixed(2),str:"$ ".concat((t||0).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,"))}},date:function(t){if(t.length<10)return t;var e=new Date(Date.parse(t)).toISOString().split("T")[0];return e}}),ut=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",[n("b-table",{attrs:{data:t.isEmpty?[]:t.persons,columns:t.columns,striped:!0,paginated:"","per-page":20,"current-page":1,"opened-detailed":t.defaultOpenedDetails,detailed:"","detail-key":"codigo",focusable:""},on:{"details-open":function(e,n){return t.$toast.open("Expanded "+e.nombre)}},scopedSlots:t._u([{key:"header",fn:function(e){return[n("b-tooltip",{attrs:{position:"is-left",active:!!e.column.meta,label:e.column.meta,dashed:""}},[t._v("\n          "+t._s(e.column.label)+"\n        ")])]}},{key:"detail",fn:function(t){var e=t.row;return[n("person-detail",{attrs:{id:e.codigo}})]}}])},[n("template",{slot:"empty"},[n("section",{staticClass:"section"},[n("div",{staticClass:"content has-text-grey has-text-centered",staticStyle:{"font-size":"large"}},[n("icon",{attrs:{scale:"3",name:"thumbs-down"}}),n("p",[t._v("No results")])],1)])])],2),n("div",{staticClass:"block"},[t._v("\n        "+t._s(t.refresh)+"\n        "),n("button",{staticClass:"button is-small is-primary",on:{click:function(e){t.columnSelectorOpen=!t.columnSelectorOpen}}},[t._v("\n            Column Selection\n        ")])]),n("b-collapse",{staticClass:"panel",attrs:{open:t.columnSelectorOpen},on:{"update:open":function(e){t.columnSelectorOpen=e}}},[n("ul",[n("b-field",{attrs:{grouped:"","group-multiline":""}},t._l(t.columns,function(e,s){return n("div",{key:s,staticClass:"control"},[n("li",[n("b-checkbox",{model:{value:e.visible,callback:function(n){t.$set(e,"visible",n)},expression:"column.visible"}},[t._v("\n                "+t._s(e.meta)+"\n              ")])],1)])}))],1)])],1)},dt=[],mt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",[n("nav",{staticClass:"panel"},[n("p",{staticClass:"panel-heading"},[n("span",{staticClass:"is-size-6"},[t._v("Registro #"+t._s(t.p(t.id).codigo))])]),n("b-tabs",{model:{value:t.activeSubTab,callback:function(e){t.activeSubTab=e},expression:"activeSubTab"}},[n("b-tab-item",[n("template",{slot:"header"},[n("p",{staticClass:"button is-small is-outlined"},[n("b-icon",{attrs:{icon:"eye"}})],1)]),n("person-record",{attrs:{pers:t.p(t.id)}})],2),n("b-tab-item",{attrs:{visible:t.canAlter()}},[n("template",{slot:"header"},[n("p",{staticClass:"button is-small is-info is-outlined"},[n("b-icon",{attrs:{icon:"edit"}})],1)]),n("person-update",{attrs:{pers:t.p(t.id)}})],2),n("b-tab-item",{attrs:{visible:t.canAssign()}},[n("template",{slot:"header"},[n("p",{staticClass:"button is-small is-warning has-text-weight-bold is-outlined"},[n("b-icon",{attrs:{icon:"lock"}})],1)]),n("person-auth",{attrs:{pers:t.p(t.id)}})],2),n("b-tab-item",{attrs:{visible:t.canAssign()}},[n("template",{slot:"header"},[n("p",{staticClass:"button is-small is-danger is-outlined"},[n("b-icon",{attrs:{icon:"trash"}})],1)]),t._v('\n        The record for "'+t._s(t.p(t.id).nombre)+'" will be marked for deletion, will no longer appear in the persons list, but will be kept for historical purposes.\n\n        '),n("nav",{staticClass:"level"},[n("div",{staticClass:"level-right"},[n("div",{staticClass:"level-item has-text-centered"},[n("a",{staticClass:"button is-info",on:{click:function(e){t.activeSubTab=0}}},[t._v("Go back")])])]),n("div",{staticClass:"level-left"},[n("div",{staticClass:"level-item has-text-centered"},[n("a",{staticClass:"button is-danger"},[t._v("Yes, Delete")])])])])],2)],1)],1)])},vt=[],pt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("nav",{staticClass:"level"},[n("div",{staticClass:"level-item has-text-centered"},[n("div",[n("p",{staticClass:"heading"},[t._v(t._s(t.pers.tipo_de_documento))]),n("p",{staticClass:"is-size-5"},[t._v(t._s(t.pers.ruc_cedula))])])]),n("div",{staticClass:"level-item has-text-centered"},[n("div",[n("p",{staticClass:"heading"},[t._v("Nombre")]),n("p",{staticClass:"is-size-5"},[t._v(t._s(t.pers.nombre))])])]),n("div",{staticClass:"level-item has-text-centered"},[n("div",[n("p",{staticClass:"heading"},[t._v("Telefono")]),n("p",{staticClass:"is-size-5"},[t._v(t._s(t.pers.telefono_1))])])])]),n("nav",{staticClass:"level"},[n("div",{staticClass:"level-right"},[n("div",{staticClass:"level-item has-text-centered"},[n("div",[n("p",{staticClass:"heading"},[t._v("Direccion")]),n("p",{staticClass:"is-size-5"},[t._v(t._s(t.pers.direccion))])])])]),n("div",{staticClass:"level-right"},[n("div",{staticClass:"level-item has-text-centered"},[n("div",[n("p",{staticClass:"heading"},[t._v("Mail")]),n("p",{staticClass:"is-size-5"},[t._v(t._s(t.pers.email))])])])]),n("div",{staticClass:"level-left"},[n("div",{staticClass:"level-item has-text-centered"},[n("div",{class:["no"===t.pers.distribuidor?"strike-out":""]},[t._v("\n            "+t._s("hq"==t.pers.distribuidor?"Sede Principal":"Distribuidor")+"\n          ")])])])])])},ft=[],bt={props:{pers:{type:Object,required:!0,default:function(){return{codigo:9999,ruc_cedula:"34-4545",nombre:"asdf asdf asdf asdf",telefono:"23452345",direccion:"asdfasdf",distribuidor:"si",retencion:"no",tipo_de_documento:"RUC"}}}}},ht=bt,gt=(n("31dd"),Object(I["a"])(ht,pt,ft,!1,null,"1fdfe7cc",null));gt.options.__file="Retrieve.vue";var Ct=gt.exports,wt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.values?n("code",{staticClass:"my-form my-form--code",domProps:{textContent:t._s(t.values)}}):n("formulate",{staticClass:"my-form",attrs:{name:t.formUid,initial:t.pers},on:{submit:t.saveForm}},[n("formulate-element",{attrs:{name:"codigo",type:"hidden",placeholder:"-1"}}),n("article",{staticClass:"tile is-child box"},[n("h3",{staticClass:"title"},[t._v("Person")]),n("div",{staticClass:"columns is-mobile is-multiline is-centered"},[n("div",{staticClass:"column"},[n("div",{staticClass:"control"},[n("label",{staticClass:"label"},[t._v("Nombre")]),n("formulate-element",{attrs:{name:"nombre",type:"text",placeholder:"Nombre y Appellidos","element-classes":"nameTextbox"}})],1)]),n("div",{staticClass:"column"},[n("div",{staticClass:"control"},[n("label",{staticClass:"label"},[t._v("Telefono")]),n("formulate-element",{attrs:{name:"telefono_1",type:"tel",placeholder:"# de telefono"}})],1)]),n("div",{staticClass:"column"},[n("div",{staticClass:"control"},[n("label",{staticClass:"label"},[t._v("Tipo de Identificación")]),n("formulate-element",{staticClass:"select is-small is-focused",attrs:{name:"tipo",type:"select",initial:"_07",options:t.typesId}})],1)]),n("div",{staticClass:"column"},[n("div",{staticClass:"control"},[n("label",{staticClass:"label"},[t._v("Identificación")]),n("formulate-element",{attrs:{name:"ruc_cedula",type:"text",placeholder:"Codigo de identificación","element-classes":"identTextbox"}})],1)]),n("div",{staticClass:"column"},[n("div",{staticClass:"control"},[n("label",{staticClass:"label"},[t._v("Dirección")]),n("formulate-element",{attrs:{name:"direccion",type:"text",placeholder:"Dirección","element-classes":"addrTextbox"}})],1)]),n("div",{staticClass:"column"},[n("div",{staticClass:"control"},[n("label",{staticClass:"label"},[t._v("Distribuidor?")]),n("formulate-element",{attrs:{type:"checkbox",label:"  ",name:"distribuidor"}})],1)]),n("div",{staticClass:"column"},[n("div",{staticClass:"control"},[n("label",{staticClass:"label"},[t._v("Correos Electronicos")]),n("formulate-element",{attrs:{name:"email",type:"text",placeholder:"Correos Electronicos","element-classes":"emailTextbox"}})],1)]),n("div",{staticClass:"control"},[n("formulate-element",{attrs:{type:"submit",name:"Save",elementClasses:"button is-info"}})],1)])])],1)],1)},_t=[],yt=(console.log,{props:["pers"],data:function(){return{values:!1}},computed:Object(A["a"])({},Object(N["c"])("person",{enums:"getEnums"}),Object(N["d"])("person",{isUpdating:"isUpdating"}),{formUid:function(){return"pers_".concat(this.pers.codigo)},typesId:function(){var t=[],e=this.enums.DocTypeLookup||{};return Object.keys(e).forEach(function(n){var s=e[n];t.push({name:s,value:n,id:n,label:s})}),t}}),methods:Object(A["a"])({},Object(N["b"])("person",{saveForm:"saveForm"}))}),xt=yt,Ot=(n("7425"),Object(I["a"])(xt,wt,_t,!1,null,"737926ed",null));Ot.options.__file="Update.vue";var kt=Ot.exports,Dt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.values?n("code",{staticClass:"my-form my-form--code",domProps:{textContent:t._s(t.values)}}):n("formulate",{staticClass:"my-form",attrs:{name:t.formUid,initial:t.permissionsField},on:{submit:t.saveForm}},[n("formulate-element",{attrs:{name:"codigo",type:"hidden",placeholder:"-1"}}),n("article",{staticClass:"tile is-child box"},[n("h3",[t._v(t._s(t.pers.nombre))]),n("h5",[t._v("Sus Permisos por Recurso")]),n("div",{staticClass:"columns is-mobile is-multiline is-centered"},[t._l(t.resources,function(e){return n("div",{staticClass:"column"},[n("div",{staticClass:"control"},[n("label",{staticClass:"label"},[t._v(t._s(e))]),n("formulate-element",{staticClass:"select is-small is-focused",attrs:{name:e,type:"select",initial:"0",options:t.levels}})],1)])}),n("div",{staticClass:"control"},[n("formulate-element",{attrs:{type:"submit",name:"Save",elementClasses:"button is-info"}})],1)],2)])],1)],1)},Et=[],Pt=(n("1c4c"),n("5df3"),n("4f7f"),n("3835")),St=(n("ffc1"),n("4b58")),It="Person",jt="person",Tt="persons",At="persons/list",Nt={};Nt[It]=[jt,Tt,At];var Lt=Nt,$t=Object.assign({},Lt),Rt="Product",Ut="product",Mt="products",Ft="products/list",Bt={};Bt[Rt]=[Ut,Mt,Ft];var Jt=Bt,Qt="Invoice",Yt="invoices/list",qt="invoices",Vt="invoice",zt={};zt[Qt]=[qt,Vt,Yt];var Gt=zt,Kt=Object.assign({},Jt,Gt),Wt="Example",Ht="protected",Zt="classified",Xt={};Xt[Wt]=[Ht,Zt];var te=Xt,ee=Object.assign({},te),ne="Bottle",se="bottles/test",ae="bottles/list",ie="bottles",oe="bottle",re={};re[ne]=[ie,oe,ae,se];for(var ce=re,le=Object.assign({},ce),ue=Object.assign({},$t,Kt,ee,le),de=(console.log,Object.assign({},ue)),me=(console.log,["reassign","delete","edit","view","none"]),ve=function(t){var e=t.map(function(t){return t.toLowerCase().split(" ").join("_")}),n=0,s={};while(n<me.length-1)s[me[n]]=Array.from(e),n+=1,e.pop();return s},pe=["Do Nothing","Only View","Comment","Alter","Assign"],fe={},be=[],he=0;he<pe.length;he+=1){var ge=pe[he],Ce=ge.toUpperCase().split(" ").join("_");fe[Ce]=he,be.push({name:ge,value:he,id:he,label:ge})}fe.alvls=pe,fe.options=be,fe.olvls=Array.from(pe,function(t,e){return{id:e,axs:t}}),fe.aliases=ve(pe),fe.idxAliases=me.reverse();var we=fe,_e=console.log;we.idxAliases.forEach(function(t){"none"!==t&&St["a"].addAlias(t,we.aliases[t])});var ye=St["b"].define(function(t){Object.entries(de).forEach(function(e){var n=Object(Pt["a"])(e,2),s=(n[0],n[1]);t("do_nothing",s)})}),xe=function(t,e,n){return window.ability&&window.ability.can?"home"===t.name?null:!!window.ability.can("only_view",t.name)&&null:null},Oe=[xe],ke={user:{permissions:{Example:we.VIEW_ONLY,Invoice:we.VIEW_ONLY,Person:we.OWN,Product:we.VIEW_ONLY,Bottle:we.VIEW_ONLY}}},De={getUserPermissions:function(t){return t.user.permissions}},Ee={changePermission:function(t,e){window.lgr.debug('Access Control (mutation) :: changePermissions of "'.concat(e.resource,'"')),t.user.permissions[e.resource]=e.setting}},Pe={resetPermissions:function(t,e){var n=e.payload,s=e.ability,a=JSON.parse(n.permissions.replace(/'/g,'"'));Object.keys(a).forEach(function(e){var n={resource:e,setting:a[e]};_e(n),t.dispatch("changePermissions",{change:n,ability:s})}),_e("\n\n      Permissions reset >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>\n    ")},changePermissions:function(t,e){var n=e.change,s=e.ability;t.commit("changePermission",n);var a=[];s.rules.map(function(t){var e=!1;return t.subject.forEach(function(t){e||(e=de[n.resource].includes(t))}),e?a.push({actions:we.idxAliases[n.setting],subject:de[n.resource]}):a.push(t),t}),s.update(a)}},Se={namespaced:!0,state:ke,getters:De,mutations:Ee,actions:Pe},Ie=new Set;Object.keys(de).forEach(function(t){Ie.add(t)});var je=Array.from(Ie),Te=console.log,Ae={props:["pers"],data:function(){return{values:!1}},computed:Object(A["a"])({},Object(N["c"])("person",{enums:"getEnums"}),{permissionsField:function(){return Te("xxxxxxxxxxxxxxxxxxx this.pers xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"),Te(this.pers),Te(this.pers.permissions),this.pers.permissions?this.pers.permissions:{}},formUid:function(){return"pers_".concat(this.pers.codigo)},levels:function(){return we.options},resources:function(){return Te("Resources"),Te(je),je}}),methods:Object(A["a"])({},Object(N["b"])("person",{saveForm:"saveForm"}))},Ne=Ae,Le=(n("178d"),Object(I["a"])(Ne,Dt,Et,!1,null,null,null));Le.options.__file="Permissions.vue";var $e=Le.exports,Re=(console.log,{name:"RUDcards",props:["id"],data:function(){return{activeSubTab:0}},components:{"person-record":Ct,"person-update":kt,"person-auth":$e},computed:Object(A["a"])({},Object(N["c"])("person",{p:"getPerson"})),methods:{canAlter:function(){return this.$can("alter","person")},canAssign:function(){return this.$can("assign","person")}}}),Ue=Re,Me=Object(I["a"])(Ue,mt,vt,!1,null,null,null);Me.options.__file="RUDcards.vue";var Fe=Me.exports,Be={name:"PersonList",mounted:function(){window.lgr.debug("!!!!!!!!!!!!!!!! mounted person list !!!!!!!!!!!!!!!!!!"),Z.start(this.$loading),this.$store.watch(function(t){return t.dbmgr.categoriesLoading},Z.kill)},beforeMount:function(){window.lgr.debug("\n * * Ready to fetch persons * * \n"),this.isLoadingList||this.persons.length>0||this.onFetchPersons()},props:{tst:{val:"passed in with props"}},data:function(){var t=[];return{anObj:{tst:"passed in as data"},isFullPage:!1,isEmpty:!1,defaultOpenedDetails:[123],selected:t[1],columnSelectorOpen:!1}},components:{"person-detail":Fe},computed:Object(A["a"])({},Object(N["c"])("person",{persons:"list",prod:"getPerson",columns:"getColumns",getDirtyData:"getDirtyData"}),Object(N["c"])({loggedIn:"isAuthenticated"}),Object(N["d"])("person",{isLoadingList:"isFetchingList",isUpdating:"isUpdating",isCreating:"isCreating"}),{refresh:function(){return this.getDirtyData>0&&(window.lgr.error("* * Person list dirty? (".concat(this.getDirtyData,") * *")),this.fetchPersons()),this.getDirtyData>0?"|":"_"}}),methods:Object(A["a"])({},Object(N["b"])(["handle401","notifyUser"]),Object(N["b"])("person",{fetchPersons:"fetchAll",setColumns:"setColumns",setDirtyData:"setDirtyData"}),{onFetchPersons:function(){window.lgr.debug(" * * Try to fetch persons * *"),this.fetchPersons()}})},Je=Be,Qe=Object(I["a"])(Je,ut,dt,!1,null,null,null);Qe.options.__file="List.vue";var Ye=Qe.exports,qe=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",[n("b-tabs",{model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},[n("b-tab-item",{attrs:{label:"Add Person"}},[n("Create")],1),n("b-tab-item",{attrs:{visible:t.canEdit(),label:"Persons"}},[n("router-view",{attrs:{name:"personsList"}})],1)],1),n("router-link",{staticClass:"button is-small is-link is-outlined",attrs:{to:{name:"home"}}},[n("icon",{attrs:{name:"arrow-circle-up"}}),t._v("\n     Home\n  ")],1)],1)},Ve=[],ze=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("b-loading",{attrs:{"is-full-page":!1,active:t.isCreating,canCancel:!0},on:{"update:active":function(e){t.isCreating=e}}}),n("formulate",{staticClass:"my-form",attrs:{name:"createPerson"},on:{submit:t.saveForm}},[n("formulate-element",{attrs:{name:"codigo",type:"hidden",placeholder:"-1"}}),n("article",{staticClass:"tile is-child box"},[n("h3",{staticClass:"title"},[t._v("Person")]),n("div",{staticClass:"columns is-mobile is-multiline is-centered"},[n("div",{staticClass:"column is-narrow"},[n("div",{staticClass:"control"},[n("label",{staticClass:"label"},[t._v("Nombre")]),n("formulate-element",{attrs:{name:"nombre",type:"text",initial:"Joe Bloggs",placeholder:"Nombre y Appellidos","element-classes":"nameTextbox"}})],1)]),n("div",{staticClass:"column"},[n("div",{staticClass:"control"},[n("label",{staticClass:"label"},[t._v("Tipo de Identificación")]),n("formulate-element",{staticClass:"select is-small",attrs:{name:"tipo",type:"select",initial:"_05",options:t.typesId}})],1)]),n("div",{staticClass:"column"},[n("div",{staticClass:"control"},[n("label",{staticClass:"label"},[t._v("Identificación")]),n("formulate-element",{attrs:{name:"ruc_cedula",type:"text",initial:"1713931416",placeholder:"Codigo de identificación","element-classes":"identTextbox"}})],1)]),n("div",{staticClass:"column"},[n("div",{staticClass:"control"},[n("label",{staticClass:"label"},[t._v("Correos Electronicos")]),n("formulate-element",{attrs:{name:"email",type:"text",initial:"a@b.cd",placeholder:"Correos Electronicos","element-classes":"emailTextbox"}})],1)]),n("div",{staticClass:"column"},[n("div",{staticClass:"control"},[n("label",{staticClass:"label"},[t._v("Distribuidor?")]),n("formulate-element",{attrs:{type:"checkbox",label:"  ",name:"distribuidor"}})],1)]),n("div",{staticClass:"column"},[n("div",{staticClass:"control"},[n("label",{staticClass:"label"},[t._v("Telefono")]),n("formulate-element",{attrs:{name:"telefono",type:"tel",initial:"4444719",placeholder:"# de telefono"}})],1)]),n("div",{staticClass:"column"},[n("div",{staticClass:"control"},[n("label",{staticClass:"label"},[t._v("Dirección")]),n("formulate-element",{attrs:{name:"direccion",initial:"#1 1st St., Here, There, Everywhere",type:"text",placeholder:"Dirección","element-classes":"addrTextbox"}})],1)]),n("div",{staticClass:"control"},[n("formulate-element",{attrs:{type:"submit",name:"Save",elementClasses:"button is-info"}})],1)])])],1)],1)},Ge=[],Ke=console.log,We={props:["pers"],data:function(){return{values:!1}},computed:Object(A["a"])({},Object(N["c"])("person",{enums:"getEnums"}),Object(N["d"])("person",{isCreating:"isCreating"}),{typesId:function(){Ke("CC %%%%%%%%%%%%%%%%%%");var t=[],e=this.enums.DocTypeLookup;return e?Object.keys(e).forEach(function(n){var s=e[n];t.push({name:s,value:n,id:n,label:s})}):t.push({name:"aa",value:"AA",id:"AA-",label:"aa-"}),Ke(t),t}}),methods:Object(A["a"])({},Object(N["b"])("person",{saveForm:"saveForm"}))},He=We,Ze=(n("0e93"),Object(I["a"])(He,ze,Ge,!1,null,null,null));Ze.options.__file="Create.vue";var Xe=Ze.exports,tn=console.log,en={name:"Person",components:{Create:Xe},computed:Object(A["a"])({},Object(N["c"])("person",{currentTab:"getCurrentTab"}),{activeTab:{get:function(){return Xr.state.person.currentTab},set:function(t){return Xr.dispatch("person/setCurrentTab",t)}}}),methods:Object(A["a"])({qtst:function(){tn(" ------- Quick Test -------"),this.onCreatePerson()},canEdit:function(){return this.$can("comment","persons/list")},onCreatePerson:function(){this.createPerson({data:{store:"person",mode:"post",data:{ruc_cedula:"0708217086001",nombre:"Jesu Cristo",direccion:"#1 Pearly Gates",telefono:"099-444-4719",distribuidor:"si",retencion:"si",tipo:"_04",scabetti:"333",tipo_de_documento:"RUC"}}})}},Object(N["b"])("person",{createPerson:"create",setTab:"setCurrentTab"}))},nn=en,sn=Object(I["a"])(nn,qe,Ve,!1,null,null,null);sn.options.__file="Layout.vue";var an=sn.exports,on=[{meta:"Codigo",label:"ID",field:"codigo",centered:!1,width:5,visible:!0,numeric:!0},{meta:"RUC/Cedula",label:"RUC",field:"ruc_cedula",centered:!1,width:14,visible:!0,numeric:!1},{meta:"Nombre",label:"NBR",field:"nombre",centered:!1,width:70,visible:!0,numeric:!1},{meta:"Dirección",label:"DIR",field:"direccion",centered:!1,width:"",visible:!1,numeric:!1},{meta:"Telefono",label:"TLF",field:"telefono",centered:!1,width:18,visible:!0,numeric:!1},{meta:"Distribuidor?",label:"DST",field:"distribuidor",centered:!0,width:3,visible:!1,numeric:!1},{meta:"Retencion?",label:"RET",field:"retencion",centered:!0,width:3,visible:!1,numeric:!1},{meta:"Tipo",label:"TIP",field:"tipo",centered:!0,width:3,visible:!1,numeric:!0},{meta:"Tipo de Documento",label:"DOC",field:"tipo_de_documento",centered:!1,width:27,visible:!1,numeric:!1}],rn=console.log,cn=[{name:At,path:"list",components:{personsList:Ye}}],ln=[].concat(cn),un=[{name:Tt,path:"persons",component:an,children:ln}],dn="codigo",mn="person",vn=$()({resource:mn,idAttribute:dn,client:X,state:{columns:on,enums:{},personsMap:{},paginator:{s:1,c:100},dirtyData:-1},actions:{fetchAll:function(t){var e=t.dispatch;rn("<<<<<< fetchAll persons >>>>>>");var n={customUrlFnArgs:vn.state.paginator,config:{category:"Persons",selector:{$and:[{_id:{$gte:"aPerson_1_0000000000000000"}},{_id:{$lt:"aPerson_3_0000000000000000"}}]}}};e("fetchList",n).then(function(t){window.lgr.info(" * * Fetched persons * *"),window.lgr.debug("             >>================================================<<\n            persons response: ".concat(JSON.stringify(t,null,2),"\n          ")),e("setColumns",t.columns),vn.state.dirtyData=-1}).catch(function(t){window.lgr.error("*** Error while fetching persons :: ".concat(t.message," ***")),t.message.endsWith("401")?e("handle401",null,{root:!0}):e("notifyUser",{txt:"Error while fetching persons :: ".concat(t.message),lvl:"is-danger"},{root:!0})})},setColumns:function(t,e){var n=t.commit;window.lgr.debug("Person.index --\x3e actions.setColumns ".concat(JSON.stringify(e,null,2))),n("tableColumns",e)},setEnums:function(t,e){var n=t.commit;window.lgr.debug("Person.index --\x3e actions.setEnums"),n("enums",e)},setMap:function(t,e){var n=t.commit;window.lgr.debug("Person.index --\x3e actions.setProdMap"),n("prodMap",e)},setDirtyData:function(t,e){var n=t.commit;window.lgr.debug("Person.index --\x3e actions.setDirtyData"),n("dirtyData",e)}},getters:{getColumns:function(t){return t.columns},getPersons:function(t){return t.list},getEnums:function(t){return t.enums},getDirtyData:function(t){return t.dirtyData},getPersonsMap:function(t){return t.personsMap},getPaginator:function(t){return t.paginator},getPerson:function(t){return function(e){return t.entities[e]}}},mutations:{persons:function(t,e){rn("".concat(e.id," = ").concat(e.data.codigo,"/").concat(e.data.nombre)),t.entities[e.id]=e.data},enums:function(t,e){t.enums=e},dirtyData:function(t,e){t.dirtyData=e},prodMap:function(t,e){t.personsMap=e},tableColumns:function(t,e){window.lgr.debug("Person.index --\x3e mutation.tableColumns"),t.columns=e}},onFetchListSuccess:function(t,e){window.lgr.error("\n      Parse list success handler >>>>>>>>>>>>>>>>>>>>>>>>>>\n      ".concat(JSON.stringify(t.dirtyData,null,2),"\n    ")),t.dirtyData=-1},customUrlFn:function(t,e){rn("config server --\x3e ".concat(V.server)),rn("client --\x3e ".concat(JSON.stringify(X,null,2))),rn("using paginator --\x3e ".concat(e));var n=t?"/".concat(t):"",s=e?"s=".concat(e.s,"&c=").concat(e.c):"s=0&c=0";rn("using customUrlFn( ".concat(n,", ").concat(s," )")),rn("URI :: ".concat(V.server,"/api/").concat(mn).concat(n,"?").concat(s));var a="".concat(V.server,"/api/").concat(mn).concat(n,"?").concat(s);return a},parseSingle:function(t){rn("parseSingle"),rn(t.data),rn(Xr.state.persons.entities[t.data.itemID]);var e={};return e[dn]=t.data.itemID,Object.assign({},t,{data:e})},parseList:function(t){var e={},n=[],s={},a=[],i=[];window.lgr.debug("||================================================||\n      persons response: ".concat(JSON.stringify(t,null,2),"\n      persons response length: ").concat(t.length,"\n    "));var o={name:"none"},r=t.length;while("none"===o.name&&r>=0)r-=1,o=t[r].data;var c=o;i=c.enums,a=c.columns,window.lgr.debug("persons meta data: ".concat(JSON.stringify(o,null,2)));var l=ct(a.map(function(t){return t.meta}));return window.lgr.debug("persons vars: ".concat(JSON.stringify(l,null,2))),r=-1,t.forEach(function(t){r+=1,s=t.data;var i={};s.idib&&(a.forEach(function(t){if(window.lgr.debug("column idx: ".concat(t.idx," ").concat(t.field)),s[t.field]){var e=lt[t.type](s[t.field]);i[t.idx]=e,i[t.field]=e}}),e[s.codigo]=i,Object.keys(i).forEach(function(t){i[t]=i[t].str||i[t]}),n.push(i))}),Xr.dispatch("person/setEnums",i),Xr.dispatch("person/setMap",e),Object.assign({},t,{data:n,columns:a,enums:i})}}),pn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",[n("b-table",{attrs:{data:t.isEmpty?[]:t.products,columns:t.columns,striped:!0,paginated:"","per-page":20,"current-page":1,"opened-detailed":t.defaultOpenedDetails,detailed:"","detail-key":"codigo",focusable:""},on:{"details-open":function(e,n){return t.$toast.open("Expanded "+e.nombre)}},scopedSlots:t._u([{key:"header",fn:function(e){return[n("b-tooltip",{attrs:{position:"is-left",active:!!e.column.meta,label:e.column.meta,dashed:""}},[t._v("\n          "+t._s(e.column.label)+"\n        ")])]}},{key:"detail",fn:function(t){var e=t.row;return[n("product-detail",{attrs:{id:e.codigo}})]}}])},[n("template",{slot:"empty"},[n("section",{staticClass:"section"},[n("div",{staticClass:"content has-text-grey has-text-centered",staticStyle:{"font-size":"large"}},[n("icon",{attrs:{scale:"3",name:"thumbs-down"}}),n("p",[t._v("No results")])],1)])])],2),n("div",{staticClass:"block"},[t._v("\n        "+t._s(t.refresh)+"\n        "),n("button",{staticClass:"button is-small is-primary",on:{click:function(e){t.columnSelectorOpen=!t.columnSelectorOpen}}},[t._v("\n            Column Selection\n        ")])]),n("b-collapse",{staticClass:"panel",attrs:{open:t.columnSelectorOpen},on:{"update:open":function(e){t.columnSelectorOpen=e}}},[n("ul",[n("b-field",{attrs:{grouped:"","group-multiline":""}},t._l(t.columns,function(e,s){return n("div",{key:s,staticClass:"control"},[n("li",[n("b-checkbox",{model:{value:e.visible,callback:function(n){t.$set(e,"visible",n)},expression:"column.visible"}},[t._v("\n                "+t._s(e.meta)+"\n              ")])],1)])}))],1)])],1)},fn=[],bn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("nav",{staticClass:"level"},t._l(t.columns,function(e){return n("div",{staticClass:"level-item has-text-centered"},[n("div",[n("p",{staticClass:"heading"},[t._v(t._s(e.meta))]),n("p",{staticClass:"is-size-5"},[t._v(t._s(t.prod(t.id)[e.field]))])])])}))])},hn=[],gn=(console.log,{props:["id"],computed:Object(A["a"])({},Object(N["c"])("product",{prod:"getProduct",columns:"getColumns"}))}),Cn=gn,wn=(n("e7e0"),Object(I["a"])(Cn,bn,hn,!1,null,"272ac2c3",null));wn.options.__file="Retrieve.vue";var _n=wn.exports,yn={name:"ProductList",beforeMount:function(){window.lgr.warn("\n * * Ready to fetch products * * \n"),this.isLoadingList||this.products.length>0||this.onFetchProducts()},props:{tst:{val:"passed in with props"}},data:function(){var t=[];return{anObj:{tst:"passed in as data"},isFullPage:!1,isEmpty:!1,defaultOpenedDetails:[123],selected:t[1],columnSelectorOpen:!1}},components:{"product-detail":_n},computed:Object(A["a"])({},Object(N["c"])("product",{products:"list",prod:"getProduct",columns:"getColumns",getDirtyData:"getDirtyData"}),Object(N["c"])({loggedIn:"isAuthenticated"}),Object(N["d"])("product",{isLoadingList:"isFetchingList",isUpdating:"isUpdating",isCreating:"isCreating"}),{refresh:function(){return this.getDirtyData>0&&(window.lgr.error("* * Product list dirty? (".concat(this.getDirtyData,") * *")),this.fetchProducts()),this.getDirtyData>0?"|":"_"}}),methods:Object(A["a"])({},Object(N["b"])(["handle401","notifyUser"]),Object(N["b"])("product",{fetchProducts:"fetchAll",setColumns:"setColumns",setDirtyData:"setDirtyData"}),{onFetchProducts:function(){window.lgr.debug(" * * Try to fetch products * *"),this.fetchProducts()}})},xn=yn,On=Object(I["a"])(xn,pn,fn,!1,null,null,null);On.options.__file="List.vue";var kn=On.exports,Dn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",[n("b-tabs",[n("b-tab-item",{attrs:{label:"Products"}},[n("router-view",{attrs:{name:"productsList"}})],1)],1),n("router-link",{staticClass:"button is-small is-link is-outlined",attrs:{to:{name:"home"}}},[n("icon",{attrs:{name:"arrow-circle-up"}}),t._v("\n     Home\n  ")],1)],1)},En=[],Pn=(console.log,{name:"Product"}),Sn=Pn,In=Object(I["a"])(Sn,Dn,En,!1,null,null,null);In.options.__file="Layout.vue";var jn=In.exports,Tn=[{meta:"Codigo",label:"ID",field:"codigo",centered:!1,width:8,visible:!0,type:"integer",usage:"rw",numeric:!0,idx:0},{meta:"Nombre",label:"NBR",field:"nombre",centered:!0,width:70,visible:!0,type:"title",usage:"rw",numeric:!1,idx:1},{meta:"Unidad",label:"UNI",field:"unidad",centered:!1,width:16,visible:!0,type:"text",usage:"rw",numeric:!1,idx:2},{meta:"IVA",label:"IVA",field:"iva",centered:!1,width:"4",visible:!0,type:"percent",usage:"r",numeric:!0,idx:3},{meta:"Valor",label:"VAL",field:"valor",centered:!1,width:10,visible:!0,type:"usd",usage:"r",numeric:!0,idx:4},{meta:"Valor Distribuidor",label:"VLD",field:"valor_distribuidor",centered:!1,width:10,visible:!1,type:"usd",usage:"r",numeric:!0,idx:5},{meta:"Porcentaje",label:"PCT",field:"porcentaje",centered:!1,width:4,visible:!1,type:"percent",usage:"r",numeric:!0,idx:6}],An=console.log,Nn=[{name:Ft,path:"list",components:{productsList:kn}}],Ln=[].concat(Nn),$n=[{name:Mt,path:"products",component:jn,children:Ln}],Rn="codigo",Un="product",Mn=$()({resource:Un,idAttribute:Rn,client:X,state:{columns:Tn,enums:{},productsMap:{},paginator:{s:1,c:100},dirtyData:-1},actions:{fetchAll:function(t){var e=t.dispatch;An("<<<<<< fetchAll products >>>>>>");var n={customUrlFnArgs:Mn.state.paginator,config:{category:"Products",selector:{$and:[{_id:{$gte:"Product_1_0000000000000000"}},{_id:{$lt:"Product_3_0000000000000000"}}]}}};e("fetchList",n).then(function(t){window.lgr.info(" * * Fetched products * *"),window.lgr.debug("             >>================================================<<\n            products response: ".concat(JSON.stringify(t,null,2),"\n          ")),e("setColumns",t.columns),Mn.state.dirtyData=-1}).catch(function(t){window.lgr.error("*** Error while fetching products :: ".concat(t.message," ***")),t.message.endsWith("401")?e("handle401",null,{root:!0}):e("notifyUser",{txt:"Error while fetching products :: ".concat(t.message),lvl:"is-danger"},{root:!0})})},setColumns:function(t,e){var n=t.commit;window.lgr.debug("Product.index --\x3e actions.setColumns ".concat(JSON.stringify(e,null,2))),n("tableColumns",e)},setEnums:function(t,e){var n=t.commit;window.lgr.debug("Product.index --\x3e actions.setEnums"),n("enums",e)},setMap:function(t,e){var n=t.commit;window.lgr.debug("Product.index --\x3e actions.setProdMap"),n("prodMap",e)},setDirtyData:function(t,e){var n=t.commit;window.lgr.debug("Product.index --\x3e actions.setDirtyData"),n("dirtyData",e)}},getters:{getColumns:function(t){return t.columns},getProducts:function(t){return t.list},getEnums:function(t){return t.enums},getDirtyData:function(t){return t.dirtyData},getProductsMap:function(t){return t.productsMap},getPaginator:function(t){return t.paginator},getProduct:function(t){return function(e){return t.entities[e]}}},mutations:{products:function(t,e){An("".concat(e.id," = ").concat(e.data.codigo,"/").concat(e.data.nombre)),t.entities[e.id]=e.data},enums:function(t,e){t.enums=e},dirtyData:function(t,e){t.dirtyData=e},prodMap:function(t,e){t.productsMap=e},tableColumns:function(t,e){window.lgr.debug("Product.index --\x3e mutation.tableColumns"),t.columns=e}},onFetchListSuccess:function(t,e){window.lgr.error("\n      Parse list success handler >>>>>>>>>>>>>>>>>>>>>>>>>>\n      ".concat(JSON.stringify(t.dirtyData,null,2),"\n    ")),t.dirtyData=-1},customUrlFn:function(t,e){An("config server --\x3e ".concat(V.server)),An("client --\x3e ".concat(JSON.stringify(X,null,2))),An("using paginator --\x3e ".concat(e));var n=t?"/".concat(t):"",s=e?"s=".concat(e.s,"&c=").concat(e.c):"s=0&c=0";An("using customUrlFn( ".concat(n,", ").concat(s," )")),An("URI :: ".concat(V.server,"/api/").concat(Un).concat(n,"?").concat(s));var a="".concat(V.server,"/api/").concat(Un).concat(n,"?").concat(s);return a},parseSingle:function(t){An("parseSingle"),An(t.data),An(Xr.state.products.entities[t.data.itemID]);var e={};return e[Rn]=t.data.itemID,Object.assign({},t,{data:e})},parseList:function(t){var e={},n=[],s={},a=[],i=[];window.lgr.debug("||================================================||\n      products response: ".concat(JSON.stringify(t,null,2),"\n      products response length: ").concat(t.length,"\n    "));var o={name:"none"},r=t.length;while("none"===o.name&&r>=0)r-=1,o=t[r].data;a=o.columns,window.lgr.debug("products meta data: ".concat(JSON.stringify(o,null,2)));var c=ct(a.map(function(t){return t.meta}));return window.lgr.debug("products vars: ".concat(JSON.stringify(c,null,2))),r=-1,t.forEach(function(t){r+=1,s=t.data;var i={};s.idib&&(a.forEach(function(t){if(window.lgr.debug("column idx: ".concat(t.idx," ").concat(t.field)),s[t.field]){var e=lt[t.type](s[t.field]);i[t.idx]=e,i[t.field]=e}}),e[s.codigo]=i,Object.keys(i).forEach(function(t){i[t]=i[t].str||i[t]}),n.push(i))}),-1===i.length?Object.assign({},t,{data:n,columns:a,enums:i}):(Xr.dispatch("product/setEnums",i),Xr.dispatch("product/setMap",e),Object.assign({},t,{data:n,columns:a,enums:i}))}}),Fn=n("53ca"),Bn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",[n("b-loading",{attrs:{"is-full-page":!1,active:t.isBusy,canCancel:!0},on:{"update:active":function(e){t.isBusy=e}}}),n("b-table",{attrs:{data:t.isEmpty?[]:t.formattedInvoices,columns:t.columns,striped:!0,paginated:"","per-page":20,"current-page":1,"opened-detailed":t.defaultOpenedDetails,detailed:"","detail-key":"codigo",focusable:"",narrowed:!0,"mobile-cards":t.hasMobileCards},on:{"details-open":function(e,n){return t.$toast.open("Expanded "+e.nombre)}},scopedSlots:t._u([{key:"header",fn:function(e){return[n("b-tooltip",{attrs:{position:"is-left",active:!!e.column.meta,label:e.column.meta,dashed:""}},[t._v("\n        "+t._s(e.column.label)+"\n      ")])]}},{key:"detail",fn:function(t){var e=t.row;return[n("invoice-detail",{attrs:{id:e.codigo}})]}}])},[n("template",{slot:"empty"},[n("section",{staticClass:"section"},[n("div",{staticClass:"content has-text-grey has-text-centered",staticStyle:{"font-size":"large"}},[n("icon",{attrs:{scale:"3",name:"thumbs-down"}}),n("p",[t._v("No results")])],1)])])],2),n("div",{staticClass:"control cardMode"},[n("b-switch",{model:{value:t.hasMobileCards,callback:function(e){t.hasMobileCards=e},expression:"hasMobileCards"}},[t._v("Modo tarjeta "),n("small",[t._v("(filas estrechas)")])])],1),n("div",{staticClass:"block"},[n("button",{staticClass:"button is-small is-primary",on:{click:function(e){t.columnSelectorOpen=!t.columnSelectorOpen}}},[t._v("\n        Escoger Columnas\n    ")])]),n("b-collapse",{staticClass:"panel",attrs:{open:t.columnSelectorOpen},on:{"update:open":function(e){t.columnSelectorOpen=e}}},[n("ul",[n("b-field",{attrs:{grouped:"","group-multiline":""}},t._l(t.columns,function(e,s){return n("div",{key:s,staticClass:"control"},[n("li",[n("b-checkbox",{model:{value:e.visible,callback:function(n){t.$set(e,"visible",n)},expression:"column.visible"}},[t._v("\n              "+t._s(e.meta)+"\n            ")])],1)])}))],1)])],1)},Jn=[],Qn=n("826c"),Yn=n.n(Qn),qn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",[n("nav",{staticClass:"panel"},[n("p",{staticClass:"panel-heading"},[n("span",{staticClass:"is-size-6"},[t._v("Registro #"+t._s(t.p(t.id).codigo))])]),n("b-tabs",{model:{value:t.activeSubTab,callback:function(e){t.activeSubTab=e},expression:"activeSubTab"}},[n("b-tab-item",[n("template",{slot:"header"},[n("p",{staticClass:"button is-small is-outlined"},[n("b-icon",{attrs:{icon:"eye"}})],1)]),n("invoice-record",{attrs:{invc:t.p(t.id)}})],2),n("b-tab-item",{attrs:{visible:t.canAlter()}},[n("template",{slot:"header"},[n("p",{staticClass:"button is-small is-info is-outlined"},[n("b-icon",{attrs:{icon:"edit"}})],1)]),n("invoice-update",{attrs:{invc:t.p(t.id)}})],2),n("b-tab-item",{attrs:{visible:t.canAssign()}},[n("template",{slot:"header"},[n("p",{staticClass:"button is-small is-warning has-text-weight-bold is-outlined"},[n("b-icon",{attrs:{icon:"lock"}})],1)]),n("invoice-auth",{attrs:{invc:t.p(t.id)}})],2),n("b-tab-item",{attrs:{visible:t.canAssign()}},[n("template",{slot:"header"},[n("p",{staticClass:"button is-small is-danger is-outlined"},[n("b-icon",{attrs:{icon:"trash"}})],1)]),t._v('\n        The record for "'+t._s(t.p(t.id).nombre)+'" will be marked for deletion, will no longer appear in the invoices list, but will be kept for historical purposes.\n\n        '),n("nav",{staticClass:"level"},[n("div",{staticClass:"level-right"},[n("div",{staticClass:"level-item has-text-centered"},[n("a",{staticClass:"button is-info",on:{click:function(e){t.activeSubTab=0}}},[t._v("Go back")])])]),n("div",{staticClass:"level-left"},[n("div",{staticClass:"level-item has-text-centered"},[n("a",{staticClass:"button is-danger"},[t._v("Yes, Delete")])])])])],2)],1)],1)])},Vn=[],zn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("nav",{staticClass:"level"},[n("div",{staticClass:"level-left"},[n("div",{staticClass:"level-item has-text-centered"},[n("div",[n("p",{staticClass:"heading"},[t._v("Codigo")]),n("p",{staticClass:"is-size-5"},[t._v(t._s(t.invc.codigo))])])]),n("div",{staticClass:"level-item has-text-centered"},[n("div",[n("p",{staticClass:"heading"},[t._v("Fecha")]),n("p",{staticClass:"is-size-5"},[t._v(t._s(t.invc.fecha))])])])]),n("div",{staticClass:"level-item has-text-centered"},[n("div",[n("p",{staticClass:"heading"},[t._v("Cliente")]),n("p",{staticClass:"is-size-5"},[t._v(t._s(t.invc.codigo_cliente))]),n("p",{class:["si"===t.invc.distribuidor?"has-text-info":"is-invisible"]},[t._v("\n            Distribuidor\n          ")])])]),n("div",{staticClass:"level-right"},[n("div",{staticClass:"level-item has-text-centered"},[n("div",[n("p",{staticClass:"heading"},[t._v("Mail")]),n("p",{staticClass:"is-size-5"},[t._v(t._s(t.invc.email))])])])])]),n("nav",{staticClass:"level"},[n("div",{staticClass:"level-item has-text-centered"},[n("b-table",{attrs:{data:t.detail,narrowed:!0},scopedSlots:t._u([{key:"default",fn:function(e){return[n("b-table-column",{attrs:{field:"cant",label:"Cantidad",width:"10",numeric:""}},[t._v("\n                  "+t._s(e.row.cantidad)+"\n              ")]),n("b-table-column",{attrs:{field:"nombre",label:"Nombre",width:"400"}},[t._v("\n                  ("+t._s(e.row.codigo)+") "+t._s(e.row.nombre)+"\n              ")]),n("b-table-column",{attrs:{field:"nombre",label:"Unidades"}},[t._v("\n                  "+t._s(e.row.unidad)+"\n              ")]),n("b-table-column",{attrs:{field:"precio",label:"Precio",width:"100"}},[t._v("\n                  "+t._s(e.row.precio)+"\n              ")]),n("b-table-column",{attrs:{field:"descuento",label:"Descuento Especial",width:"10"}},[t._v("\n                  "+t._s(e.row.descuento)+"\n              ")]),n("b-table-column",{attrs:{field:"total",label:"Total",width:"100"}},[t._v("\n                  "+t._s(e.row.total)+"\n              ")])]}}])})],1)]),n("nav",{staticClass:"level"},[n("div",{staticClass:"level-left has-text-centered"},[n("div",[n("p",{staticClass:"heading"},[t._v("Estado")]),n("p",{staticClass:"is-size-5"},[t._v(t._s(t.enums[t.invc.estado]))])])]),n("div",{staticClass:"level-item has-text-centered"},[n("b-table",{attrs:{data:t.totals||[],bordered:!0,narrowed:!0,"mobile-cards":!0},scopedSlots:t._u([{key:"default",fn:function(e){return[n("b-table-column",{attrs:{field:"title"}},[t._v("\n                  "+t._s(e.row.title)+"\n              ")]),n("b-table-column",{attrs:{field:"value",numeric:""}},[t._v("\n                  "+t._s(e.row.value)+"\n              ")])]}}])})],1)])])},Gn=[],Kn=console.log,Wn={data:function(){var t=[];return{totals:t}},computed:Object(A["a"])({},Object(N["c"])("invoice",{enums:"getEnums"}),{detail:function(){Kn("  *************** INVC **********************\n      ");var t=this.invc,e=t.lista_de_items,n="si"===t.distribuidor;Kn(this);var s=[];Kn("items object"),Kn(e);for(var a=0;a<e.length;a+=1){var i=e[a],o=n?i[0].valor_distribuidor:i[0].valor,r=i[1],c=lt.percent(i[2],0);Kn("At ".concat(a," -- ").concat(i[0].unidad," (").concat(i[0].codigo,") ").concat(i[0].nombre)),s.push({codigo:i[0].codigo,nombre:i[0].nombre,unidad:i[0].unidad,cantidad:r,precio:o.str,descuento:lt.percent(1-c.raw,0).str,total:lt.usd(o.raw*r-c.raw).str})}return this.totals=[],this.totals.push({title:"Subtotal IVA 12%",value:t.subtotal_iva_12.str}),this.totals.push({title:"Descuento Especial",value:t.descuento_especial.str}),this.totals.push({title:"Valor",value:t.subtotal_descontado.str}),this.totals.push({title:"IVA",value:lt.usd(t.total_calculado.raw-t.subtotal_descontado.raw).str}),this.totals.push({title:"Valor Total",value:t.total_calculado.str}),this.totals.push({title:"Retenido",value:t.retenido.str}),this.totals.push({title:"Total Final",value:t.monto_final.str}),s}}),props:{invc:{type:Object,required:!0,default:function(){return{codigo:9999,ruc_cedula:"34-4545",nombre:"asdf asdf asdf asdf",telefono:"23452345",direccion:"asdfasdf",distribuidor:"si",retencion:"no",tipo_de_documento:"RUC"}}}}},Hn=Wn,Zn=(n("c2e7"),Object(I["a"])(Hn,zn,Gn,!1,null,"23bf70aa",null));Zn.options.__file="Retrieve.vue";var Xn=Zn.exports,ts=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("b-loading",{attrs:{"is-full-page":!1,active:t.isUpdating,canCancel:!0},on:{"update:active":function(e){t.isUpdating=e}}}),t.values?n("code",{staticClass:"my-form my-form--code",domProps:{textContent:t._s(t.values)}}):n("formulate",{staticClass:"my-form",attrs:{name:t.formUid,initial:t.invc},on:{submit:t.saveForm}},[n("formulate-element",{attrs:{name:"codigo",type:"hidden",placeholder:"-1"}}),n("article",{staticClass:"tile is-child box"},[n("h3",{staticClass:"title"},[t._v("Invoice")]),n("div",{staticClass:"columns is-mobile is-multiline is-centered"},[n("div",{staticClass:"control"},[n("formulate-element",{attrs:{type:"submit",name:"Save",elementClasses:"button is-info"}})],1)])])],1)],1)},es=[],ns=(console.log,{props:["invc"],data:function(){return{values:!1}},computed:Object(A["a"])({},Object(N["c"])("invoice",{enums:"getEnums"}),Object(N["d"])("invoice",{isUpdating:"isUpdating"}),{formUid:function(){return"pers_".concat(this.invc.codigo)},typesId:function(){var t=this.enums.DocTypeLookup,e=[];return Object.keys(t).forEach(function(n){var s=t[n];e.push({name:s,value:n,id:n,label:s})}),e}}),methods:Object(A["a"])({},Object(N["b"])("invoice",{saveForm:"saveForm"}))}),ss=ns,as=(n("366c"),Object(I["a"])(ss,ts,es,!1,null,null,null));as.options.__file="Update.vue";var is=as.exports,os=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.values?n("code",{staticClass:"my-form my-form--code",domProps:{textContent:t._s(t.values)}}):n("formulate",{staticClass:"my-form",attrs:{name:t.formUid,initial:t.permissionsField},on:{submit:t.saveForm}},[n("formulate-element",{attrs:{name:"codigo",type:"hidden",placeholder:"-1"}}),n("article",{staticClass:"tile is-child box"},[n("h3",[t._v(t._s(t.invc.nombre))]),n("h5",[t._v("Sus Permisos por Recurso")]),n("div",{staticClass:"columns is-mobile is-multiline is-centered"},[t._l(t.resources,function(e){return n("div",{staticClass:"column"},[n("div",{staticClass:"control"},[n("label",{staticClass:"label"},[t._v(t._s(e))]),n("formulate-element",{staticClass:"select is-small is-focused",attrs:{name:e,type:"select",initial:"0",options:t.levels}})],1)])}),n("div",{staticClass:"control"},[n("formulate-element",{attrs:{type:"submit",name:"Save",elementClasses:"button is-info"}})],1)],2)])],1)],1)},rs=[],cs=console.log,ls={props:["invc"],data:function(){return{values:!1}},computed:Object(A["a"])({},Object(N["c"])("invoice",{enums:"getEnums"}),{permissionsField:function(){return cs("xxxxxxxxxxxxxxxxxxx this.invc xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"),cs(this.invc),cs(this.invc.permissions),this.invc.permissions?this.invc.permissions:{}},formUid:function(){return"pers_".concat(this.invc.codigo)},levels:function(){return we.options},resources:function(){return cs("Resources"),cs(je),je}}),methods:Object(A["a"])({},Object(N["b"])("invoice",{saveForm:"saveForm"}))},us=ls,ds=(n("d224"),Object(I["a"])(us,os,rs,!1,null,null,null));ds.options.__file="Permissions.vue";var ms=ds.exports,vs={name:"RUDcards",props:["id","distributor"],data:function(){return{activeSubTab:0}},components:{"invoice-record":Xn,"invoice-update":is,"invoice-auth":ms},methods:{canAlter:function(){return this.$can("alter","invoice")},canAssign:function(){return this.$can("assign","invoice")}},computed:Object(A["a"])({},Object(N["c"])("invoice",{p:"getInvoice"}))},ps=vs,fs=Object(I["a"])(ps,qn,Vn,!1,null,null,null);fs.options.__file="RUDcards.vue";var bs=fs.exports,hs=console.log,gs={name:"InvoiceList",beforeMount:function(){var t=this;hs("\n\n\n                  * * Ready to fetch invoices * *\n\n\n      "),hs(vn.state.list.length),hs(vn.state.isFetchingList),hs(this.$store);var e=7;switch((vn.state.list.length>0||vn.state.isFetchingList)&&(hs("Don't load persons"),e-=4),(Mn.state.list.length>0||Mn.state.isFetchingList)&&(hs("Don't load products"),e-=2),(this.invoices.length>0||this.isLoadingList)&&(hs("Don't load invoices"),e-=1),e){case 7:case 6:hs("Load all"),this.$store.dispatch("person/fetchAll").then(function(){hs("Loaded persons"),t.$store.dispatch("product/fetchAll").then(function(){hs("Loaded products"),t.onFetchInvoices()})});break;case 5:case 4:hs("Person then invoices"),hs("Load all"),this.$store.dispatch("person/fetchAll").then(function(){hs("Loaded persons"),t.onFetchInvoices()});break;case 3:case 2:hs("Product then invoices"),hs("Load all"),this.$store.dispatch("product/fetchAll").then(function(){hs("Loaded products"),t.onFetchInvoices()});break;case 1:hs("Load invoices"),this.onFetchInvoices();break;default:hs("No loading needed")}},props:{tst:"passed in with props"},data:function(){var t=[];return{anObj:{tst:"passed in as data"},hasMobileCards:!1,isFullPage:!1,isEmpty:!1,defaultOpenedDetails:[4358],selected:t[1],columnSelectorOpen:!1}},components:{"invoice-detail":bs},computed:Object(A["a"])({},Object(N["c"])("invoice",{invoices:"list",columns:"getColumns"}),Object(N["c"])({loggedIn:"isAuthenticated"}),Object(N["d"])("invoice",{isLoadingList:"isFetchingList",isUpdating:"isUpdating",isCreating:"isCreating"}),{formattedInvoices:function(){return this.invoices.map(function(t){var e={};return Object.entries(t).forEach(function(t){var n=Object(Pt["a"])(t,2),s=n[0],a=n[1];e[s]=a.str||a}),e})},isBusy:function(){return this.isLoadingList||this.isUpdating||this.isCreating}}),methods:Object(A["a"])({},Object(N["b"])(["handle401","notifyUser"]),Object(N["b"])("invoice",{fetchInvoices:"fetchAll",setColumns:"setColumns"}),{onFetchInvoices:function(){var t=this;hs(" * * Try to fetch invoices * *"),Yn()().interval(100).times(20).condition(function(){return!vn.state.isFetchingList&&!Mn.state.isFetchingList}).done(function(){return t.fetchInvoices()})}})},Cs=gs,ws=(n("ecdc"),Object(I["a"])(Cs,Bn,Jn,!1,null,null,null));ws.options.__file="List.vue";var _s=ws.exports,ys=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",[n("b-tabs",{model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},[n("b-tab-item",{attrs:{label:"Invoices"}},[n("router-view",{attrs:{name:"invoicesList"}})],1),n("b-tab-item",{attrs:{visible:t.canEdit(),label:"Add Invoice"}},[n("Create")],1)],1),n("router-link",{staticClass:"button is-small is-link is-outlined",attrs:{to:{name:"home"}}},[n("icon",{attrs:{name:"arrow-circle-up"}}),t._v("\n     Home\n  ")],1)],1)},xs=[],Os=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("b-loading",{attrs:{"is-full-page":!1,active:t.isCreating,canCancel:!0},on:{"update:active":function(e){t.isCreating=e}}}),n("formulate",{staticClass:"my-form",attrs:{name:"createInvoice"},on:{submit:t.commitForm}},[n("formulate-element",{attrs:{name:"summation",type:"hidden",placeholder:"-1"}}),n("formulate-element",{attrs:{name:"items",type:"hidden",placeholder:"-1"}}),n("article",{staticClass:"tile is-child box"},[n("h3",{staticClass:"title"},[t._v("Invoice")]),n("div",{staticClass:"columns"},[n("div",{staticClass:"column is-centered"},[n("div",{staticClass:"control"},[n("label",{staticClass:"label"},[t._v("Cliente")]),n("formulate-element",{attrs:{name:"Persona",validation:"required","element-classes":"nameInput"}},[n("autocomplete-input",{attrs:{items:t.personsId||null},on:{"selection-made":t.setPersona},model:{value:t.Persona,callback:function(e){t.Persona=e},expression:"Persona"}})],1)],1)]),n("div",{staticClass:"column is-centered"},[n("div",{staticClass:"control"},[n("label",{staticClass:"label"},[t._v("Fecha")]),n("formulate-element",{attrs:{name:"InvoiceDate",validation:"required"}},[n("dateselect-input",{model:{value:t.InvoiceDate,callback:function(e){t.InvoiceDate=e},expression:"InvoiceDate"}})],1)],1)]),n("div",{staticClass:"column is-centered"},[n("div",{staticClass:"control"},[n("label",{staticClass:"label"},[t._v("Descuento")]),n("formulate-element",{attrs:{name:"desc",placeholder:"0","element-classes":"resizedTextbox",validation:"isPct(desc)"}})],1)])]),n("div",{staticClass:"columns is-mobile"},[n("div",{staticClass:"column"},[n("label",{staticClass:"label"},[t._v("Itemes")]),n("button",{staticClass:"button is-info",on:{click:t.openModal}},[n("b-icon",{attrs:{icon:"plus"}}),n("span",[t._v("Anadir item")])],1),n("button",{staticClass:"button field is-danger",attrs:{disabled:!t.checkedRows.length},on:{click:t.dropRow}},[n("b-icon",{attrs:{icon:"trash"}}),n("span",[t._v("Borrar seleccionadas")])],1),n("b-modal",{attrs:{active:t.isComponentModalActive,"has-modal-card":""},on:{"update:active":function(e){t.isComponentModalActive=e}}},[n("detailsForm")],1),n("b-table",{attrs:{data:t.tableData,"checked-rows":t.checkedRows,checkable:""},on:{"update:checkedRows":function(e){t.checkedRows=e}},scopedSlots:t._u([{key:"default",fn:function(e){return[n("b-table-column",{attrs:{label:"Codigo",numeric:""}},[t._v("\n                    "+t._s(e.row.codigo)+"\n                  ")]),n("b-table-column",{attrs:{label:"Producto/Servicio"}},[t._v("\n                    "+t._s(e.row.nombre)+"\n                  ")]),n("b-table-column",{attrs:{label:"Unidad"}},[t._v("\n                    "+t._s(e.row.unidad)+"\n                  ")]),n("b-table-column",{attrs:{label:"Valor",numeric:""}},[t._v("\n                    "+t._s(e.row.valor)+"\n                  ")]),n("b-table-column",{attrs:{label:"IVA",numeric:""}},[t._v("\n                    "+t._s(e.row.iva.str)+"\n                  ")]),n("b-table-column",{attrs:{label:"Cantidad",centered:""}},[t._v("\n                    "+t._s(e.row.cantidad)+"\n                  ")]),n("b-table-column",{attrs:{label:"Total",numeric:""}},[t._v("\n                    "+t._s(e.row.total)+"\n                  ")])]}}])},[n("template",{slot:"footer"},[n("div",{staticClass:"columns"},[n("div",{staticClass:"column is-offset-2 is-narrow-mobile"},[n("div",{staticClass:"box",staticStyle:{width:"125px"}},[t.retention?n("div",{class:["si"===t.retention?"":"strike-out"]},[t._v("\n                          Retencion\n                        ")]):t._e(),t.distributor?n("div",{class:["si"===t.distributor?"":"strike-out"]},[t._v("\n                          Distribuidor\n                        ")]):t._e()])]),n("div",{staticClass:"column is-5"},[n("div",{staticClass:"box"},[n("b-table",{attrs:{data:t.totals},scopedSlots:t._u([{key:"default",fn:function(e){return[n("b-table-column",{attrs:{width:"180"}},[t._v("\n                                "+t._s(e.row.label)+"\n                            ")]),n("b-table-column",{attrs:{numeric:""}},[t._v("\n                              "+t._s(e.row.value)+"\n                            ")])]}}])})],1)]),n("div",{staticClass:"column is-1"})])])],2),n("div",{staticClass:"control"},[n("formulate-element",{attrs:{type:"submit",name:"Save",elementClasses:"button is-info"}})],1)],1)])])],1)],1)},ks=[],Ds=(n("4917"),n("f4fb")),Es=n.n(Ds),Ps=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"autocomplete"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.search,expression:"search"}],ref:t.elemId,attrs:{type:"text",id:t.elemId},domProps:{value:t.search},on:{input:[function(e){e.target.composing||(t.search=e.target.value)},t.onChange],blur:t.onBlur,keyup:[function(e){return"button"in e||!t._k(e.keyCode,"down",40,e.key,["Down","ArrowDown"])?t.onArrowDown(e):null},function(e){return"button"in e||!t._k(e.keyCode,"up",38,e.key,["Up","ArrowUp"])?t.onArrowUp(e):null},function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.onEnter(e):null}]}}),n("ul",{directives:[{name:"show",rawName:"v-show",value:t.isOpen,expression:"isOpen"}],staticClass:"autocomplete-choices",attrs:{id:"autocomplete-choices"}},[t.isLoading?n("li",{staticClass:"loading"},[t._v("Loading choices")]):t._l(t.choices,function(e,s){return n("li",{key:s,staticClass:"autocomplete-choice",class:{"is-active":s===t.arrowCounter},on:{click:function(n){t.setChoice(e)}}},[t._v("\n      "+t._s(e)+"\n    ")])})],2)])},Ss=[],Is=(n("20d6"),n("386d"),console.log),js=(console.error,{name:"autocomplete",template:"#autocomplete",props:{elemId:{type:String,required:!0,default:function(){return"autocomplete"}},items:{type:Object,required:!1,default:function(){return{}}},isAsync:{type:Boolean,required:!1,default:!1}},data:function(){return{isOpen:!1,choices:[],search:"",isLoading:!1,arrowCounter:0}},methods:{onChange:function(){this.isAsync?this.isLoading=!0:(this.filterChoices(),this.isOpen=!0)},filterChoices:function(){var t=this;this.choices=this.items.list.filter(function(e){return e.label.toLowerCase().indexOf(t.search.toLowerCase())>-1}).map(function(t){return t.label})},setValue:function(t){Is("elemId ".concat(this.elemId)),Is("elemId ".concat(JSON.stringify(this.$refs,null,2))),this.$refs[this.elemId].value=t},setChoice:function(t){Is("setChoice = ".concat(t)),this.search=t,this.isOpen=!1,this.arrowCounter=this.choices.findIndex(function(e){return e===t}),this.gotOne()},onArrowDown:function(){this.arrowCounter<this.choices.length&&(this.arrowCounter+=1)},onArrowUp:function(){this.arrowCounter>0&&(this.arrowCounter-=1)},gotOne:function(){var t=this;Is(" gotOne \n\n"),this.search=this.choices[this.arrowCounter],this.search&&this.search.length>1&&this.choices.includes(this.search)&&(this.$emit("selection-made",this.items.list.filter(function(e){return e.label.indexOf(t.search)>-1})[0]),Is("Chose ".concat(this.search))),this.arrowCounter=-1},onBlur:function(){},onEnter:function(){Is(" onEnter ".concat(this.isOpen)),this.isOpen&&(this.gotOne(),this.isOpen=!1,this.arrowCounter=-1)},handleClickOutside:function(t){this.$el.contains(t.target)||(this.isOpen=!1,this.arrowCounter=-1,Is(" handleClickOutside "))}},watch:{items:function(t,e){t.length!==e.length&&(this.choices=t,this.isLoading=!1)}},mounted:function(){document.addEventListener("click",this.handleClickOutside)},destroyed:function(){document.removeEventListener("click",this.handleClickOutside)}}),Ts=js,As=(n("b295"),Object(I["a"])(Ts,Ps,Ss,!1,null,"316dd063",null));As.options.__file="AutoComplete.vue";var Ns=As.exports,Ls=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-date-picker",{ref:"datePicked",attrs:{formats:t.formats,mode:"single"},on:{input:t.datePick},model:{value:t.theDate,callback:function(e){t.theDate=e},expression:"theDate"}})},$s=[],Rs=(console.log,{props:{value:{type:[Date,Boolean],default:!1}},created:function(){this.$emit("input",new Date)},methods:{datePick:function(){this.$emit("input",this.theDate)}},data:function(){return{theDate:new Date,formats:{title:"MMMM / YYYY",weekdays:"W",navMonths:"MMM",input:["YYYY-MM-DD","YYYY/MM/DD"],dayPopover:"L",data:["L","YYYY-MM-DD","YYYY/MM/DD"]}}}}),Us=Rs,Ms=Object(I["a"])(Us,Ls,$s,!1,null,null,null);Ms.options.__file="DateSelect.vue";var Fs=Ms.exports,Bs=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"modal-card",staticStyle:{width:"auto"}},[n("formulate",{staticClass:"my-form",attrs:{name:"invoiceDetails"},on:{submit:t.saveForm}},[n("header",{staticClass:"modal-card-head"},[n("p",{staticClass:"title"},[t._v("Item")])]),n("section",{staticClass:"modal-card-body"},[n("div",{staticClass:"columns"},[n("div",{staticClass:"column is-four-fifths"},[n("div",{staticClass:"control"},[n("label",{staticClass:"label"},[t._v("Producto / Servicio")]),n("formulate-element",{staticClass:"select is-small is-focused",attrs:{name:"code",type:"select",initial:"nombre",options:t.typesId}})],1)]),n("div",{staticClass:"column is-one-fifth"},[n("div",{staticClass:"control"},[n("label",{staticClass:"label"},[t._v("Cantidad")]),n("formulate-element",{attrs:{name:"qty",placeholder:"cantidad","element-classes":"resizedTextbox"}})],1)])])]),n("footer",{staticClass:"modal-card-foot"},[n("button",{staticClass:"button",attrs:{type:"button"},on:{click:function(e){t.$parent.close()}}},[t._v("Close")]),n("formulate-element",{attrs:{type:"submit",name:"Save",elementClasses:"button is-info"}})],1)])],1)},Js=[],Qs=console.log,Ys={computed:Object(A["a"])({},Object(N["c"])("product",{products:"list",productsMap:"getProductsMap"}),{typesId:function(){Qs("%%%%%%%%%%%%%%%%%%%% CC %%%%%%%%%%%%%%%%%%"),Qs(this),Qs(this.$store.getters);var t=[],e=this.products;return e&&Object.keys(e).forEach(function(n){var s=e[n];t.push({name:s.nombre,value:s.codigo,id:s.codigo,label:"".concat(s.nombre," (").concat(s.unidad,")")})}),Qs(t),t}}),methods:Object(A["a"])({},Object(N["b"])("invoice",{saveRow:"saveRow"}),{saveForm:function(t){this.saveRow({rowNum:-1,values:t}),this.$parent.close()}})},qs=Ys,Vs=(n("777f"),Object(I["a"])(qs,Bs,Js,!1,null,"0c2d6ab8",null));Vs.options.__file="Details.vue";var zs=Vs.exports,Gs=console.log,Ks={props:["pers"],components:{detailsForm:zs,"autocomplete-input":Ns,"dateselect-input":Fs},created:function(){this.persons&&this.persons.length>0&&this.productsMap&&Object.keys(this.productsMap).length>0&&this.products&&this.products.length>0||this.$router.push({name:"home"})},data:function(){var t=[];return{totals:t,isComponentModalActive:!1,checkedRows:[],retention:null,distributor:null,myDate:new Date,formats:{title:"MMMM / YYYY",weekdays:"W",navMonths:"MMM",input:["YYYY-MM-DD","YYYY/MM/DD"],dayPopover:"L",data:["L","YYYY-MM-DD","YYYY/MM/DD"]}}},computed:Object(A["a"])({},Object(N["c"])("invoice",{enums:"getEnums"}),Object(N["c"])("product",{products:"list",productsMap:"getProductsMap"}),Object(N["c"])("person",{persons:"list",getPerson:"getPerson"}),Object(N["d"])("invoice",{isCreating:"isCreating",formRows:"formRows"}),Object(d["mapModels"])({Persona:"createInvoice/Persona",InvoiceDate:"createInvoice/InvoiceDate"}),{tableData:function(){var t=this,e=[],n=this.$store.state;if(n.values.createInvoice){var s=n.values.createInvoice;s.Persona=s.Persona||"(0) no one",s.InvoiceDate=s.InvoiceDate||new Date;var a=[{codigo:"codigo",nombre:"nombre",unidad:"unidad",iva:"iva",valor:"$0.00",cantidad:0,total:"$0.00"}];Gs("\n\n\n          tableData() ----------------------------"),Gs(this.productsMap);var i=s.Persona.match(/\(([^)]+)\)/)[1],o=this.getPerson(i);this.retention=o&&o.retencion||null,this.distributor=o&&o.distribuidor||null,this.totals=[];var r=0,c=0,l=0,u={distributor:this.distributor,person:i,discountPct:0,iva0:0,iva12:0,subtotal:0,discount:0,retention:0,total:0};if(this.products.length<1)return a;if(this.formRows.row.length<1)return a;if(this.formRows.row[0].code<0)return a;this.formRows.row.forEach(function(n){Gs("row"),Gs(n);var s=t.productsMap[n.code];Gs(s.porcentaje.raw),t.distributor&&"si"===t.distributor?(r=s.valor_distribuidor.str,c=s.valor_distribuidor.raw,l=lt.percent(s.valor_distribuidor.raw/s.valor.raw)):(r=s.valor.str,c=s.valor.raw,l=lt.percent(1));var a=c*n.qty;Gs(s.iva);var i=0===s.iva.raw?a:0,o=s.iva.raw>0?a:0;u.iva0+=i,u.iva12+=o,u.subtotal+=i+o,e.push({codigo:n.code,nombre:s.nombre,unidad:s.unidad,discount:l,iva:s.iva,valor:r,cantidad:n.qty,total:lt.usd(c*n.qty).str})}),Gs("rows"),Gs(e),u.discountPct=s&&s.desc||0,u.discount=u.discountPct/100*u.subtotal,u.valor=u.subtotal-u.discount,u.iva=.12*u.valor,u.total=u.valor+u.iva,u.final=u.total,u.iva0>0&&this.totals.push({label:"Subtotal IVA  0%",value:lt.usd(u.iva0).str}),this.totals.push({label:"Subtotal IVA 12%",value:lt.usd(u.iva12).str}),this.totals.push({label:"Descuento Especial",value:lt.usd(u.discount).str}),this.totals.push({label:"Valor",value:lt.usd(u.valor).str}),this.totals.push({label:"IVA",value:lt.usd(u.iva).str}),this.totals.push({label:"Valor Total",value:lt.usd(u.total).str}),u.final=u.total,"si"===this.retention&&(u.retention=.01*u.total,u.final=u.total-u.retention,this.totals.push({label:"Retenido",value:lt.usd(u.retention).str})),this.totals.push({label:"Total Final",value:lt.usd(u.final).str}),Gs("summation.iva0 ".concat(u.iva0)),Gs("summation.iva12 ".concat(u.iva12)),Gs("summation.discountPct ".concat(u.discountPct)),Gs("summation.discount ".concat(u.discount)),Gs("summation.valor ".concat(u.valor)),Gs("summation.iva ".concat(u.iva)),Gs("summation.total ".concat(u.total)),Gs("summation.retention ".concat(u.retention)),Gs("summation.final ".concat(u.final)),s.summation=u,s.items=e,Gs(s),Gs(this.$store),Gs(e)}return e},personsId:function(){Gs("%%%%%%%%%%%%%%%% personsId %%%%%%%%%%%%%%%%%% "),Gs(this);var t=[],e=this.persons;return e&&(Gs("prsns"),Object.keys(e).forEach(function(n){var s=e[n];t.push({value:s.codigo,label:"".concat(s.nombre)})})),Gs(t),{list:t,data:function(t){return"(".concat(t.value,") ").concat(t.label)}}}}),methods:Object(A["a"])({},Object(N["b"])("invoice",{saveForm:"saveForm"}),{setPersona:function(t){Gs("persona ".concat(JSON.stringify(t,null,2)))},openModal:function(t){t.preventDefault(),this.isComponentModalActive=!0},dropRow:function(t){var e=this;this.checkedRows.forEach(function(t){e.formRows.row.forEach(function(n,s){n.code===t.codigo&&n.code===t.codigo&&e.formRows.row.splice(s,1)})}),Gs(this.checkedRows),t.preventDefault()},commitForm:function(t){this.saveForm(t)},setItem:function(t){Gs("Item ".concat(t.qty," of ").concat(t.code))}})},Ws=Ks,Hs=(n("3f47"),Object(I["a"])(Ws,Os,ks,!1,null,"6fa630f9",null));Hs.options.__file="Create.vue";var Zs=Hs.exports,Xs=console.log,ta={name:"Invoice",components:{Create:Zs},computed:Object(A["a"])({},Object(N["c"])("invoice",{currentTab:"getCurrentTab"}),{activeTab:{get:function(){return Xr.state.invoice.currentTab},set:function(t){return Xr.dispatch("invoice/setCurrentTab",t)}}}),methods:Object(A["a"])({canEdit:function(){return this.$can("comment","invoices/list")},qtst:function(){Xs(" ------- Quick Test -------"),this.onCreateInvoice()}},Object(N["b"])("invoice",{createInvoice:"create",setTab:"setCurrentTab"}))},ea=ta,na=Object(I["a"])(ea,ys,xs,!1,null,null,null);na.options.__file="Layout.vue";var sa=na.exports,aa=[{meta:"Codigo",label:"COD",field:"codigo",centered:!1,visible:!0,width:5,numeric:!0,type:"integer",usage:"rw",idx:0},{meta:"Fecha",label:"FECH",field:"fecha",centered:!0,visible:!0,width:"10",numeric:!1,type:"date",usage:"rw",idx:1},{meta:"Estado",label:"ESTS",field:"estado",centered:!0,visible:!1,width:10,numeric:!1,type:"text",usage:"rw",idx:2},{meta:"Codigo Cliente",label:"CCLI",field:"codigo_cliente",centered:!0,visible:!0,width:6,numeric:!1,type:"foreignKey1",usage:"rw",idx:3},{meta:"Distribuidor",label:"DIST",field:"distribuidor",centered:!0,visible:!0,width:4,numeric:!1,type:"text",usage:"rw",idx:4},{meta:"Descuento Especial",label:"DESC",field:"descuento_especial",centered:!1,visible:!1,width:12,numeric:!0,type:"percent",usage:"rw",idx:5},{meta:"Lista de Items",label:"ITMS",field:"lista_de_items",centered:!0,visible:!1,width:4,numeric:!0,type:"JSON1",usage:"rw",idx:6},{meta:"Subtotal IVA 12%",label:"IV12",field:"subtotal_iva_12",centered:!1,visible:!1,width:12,numeric:!0,type:"usd",usage:"rw",idx:7},{meta:"Subtotal IVA 0%",label:"IV00",field:"subtotal_iva_0",centered:!1,visible:!1,width:12,numeric:!0,type:"usd",usage:"rw",idx:8},{meta:"Subtotal Descontado",label:"STDC",field:"subtotal_descontado",centered:!1,visible:!1,width:12,numeric:!0,type:"usd",usage:"rw",idx:9},{meta:"Total Calculado",label:"TOTL",field:"total_calculado",centered:!1,visible:!1,width:12,numeric:!0,type:"usd",usage:"rw",idx:10},{meta:"Retenido",label:"RETN",field:"retenido",centered:!1,visible:!1,width:12,numeric:!0,type:"usd",usage:"rw",idx:11},{meta:"Monto Final",label:"MNTO",field:"monto_final",centered:!1,visible:!0,width:12,numeric:!0,type:"usd",usage:"rw",idx:12},{meta:"Total Cobrado",label:"COBR",field:"total_cobrado",centered:!1,visible:!1,width:12,numeric:!0,type:"usd",usage:"rw",idx:13}],ia=void 0,oa=console.log,ra=[{name:Yt,path:"list",components:{invoicesList:_s}}],ca=[].concat(ra),la=[{name:qt,path:"invoices",component:sa,children:ca},{name:Vt,path:"invoice/:id",component:Xn}];L["client"].interceptors.request.use(function(t){var e=t,n=window.ls.get(V.tokenName);return null!=n&&(e.headers.Authorization="JWT ".concat(n)),e},function(t){return oa("request failed"),Promise.reject(t)});var ua={processPersonFK:function(t){var e=vn.state.entities[t];return e?e.nombre:"Usuario #".concat(t)},processDetailsJSON:function(t){if(!Mn.state.entities)return t;if(Object.keys(Mn.state.entities).length<1)return t;try{return JSON.parse(t.replace(/'/g,'"')).details.filter(function(t){return t[0]>0}).map(function(t){return[Mn.state.entities[t[0]],t[1],t[2]]})}catch(e){return t}}},da="codigo",ma="invoice",va=$()({resource:ma,idAttribute:da,urlRoot:"".concat(V.server),client:L["client"],state:{columns:aa,currentTab:0,enums:{},paginator:{s:1,c:1e4},formRows:{row:[]}},actions:{fetchAll:function(t){var e=t.dispatch;oa("<<<<<< fetchAll invoices >>>>>>"),e("fetchList",{customUrlFnArgs:va.state.paginator}).then(function(t){oa(" * * Fetched invoices * *"),oa(t.columns),e("setColumns",t.columns)}).catch(function(t){oa("*** Error while fetching invoices :: >".concat(t.message,"<***")),oa(t.message),t.message.endsWith("401")?e("handle401",null,{root:!0}):e("notifyUser",{txt:"Error fetching invoices :: ".concat(t.message),lvl:"is-danger"},{root:!0})})},setColumns:function(t,e){var n=t.commit;window.lgr.info("Invoice.index --\x3e actions.setColumns"),oa(e),n("tableColumns",e)},setCurrentTab:function(t,e){var n=t.commit;window.lgr.info("Invoice.index --\x3e actions.setCurrentTab -- ".concat(e)),n("tab",e)},setEnums:function(t,e){var n=t.commit;window.lgr.info("Invoice.index --\x3e actions.setEnums"),n("enums",e)},updLocal:function(t,e){var n=t.commit;oa("uuuuuuu Update local record uuuuuuuuuu"),oa("".concat(e.data.mode," ").concat(e.data.store," ").concat(e.id)),oa(e.data.data),n("invoice",{id:e.id,data:e.data.data})},newLocal:function(t,e){t.dispatch;oa("uuuuuuu Append new local record uuuuuuuuuu"),oa("".concat(e.data.mode," ").concat(e.data.store))},saveRow:function(t,e){oa("\n\n        Saving row......................");var n=t.rootGetters["product/getProduct"](e.values.code);oa(n),oa(e.values),t.commit("appendItemRow",e.values)},saveForm:function(t,e){var n=t.dispatch;window.lgr.info("Invoice.index --\x3e actions.saveForm"),oa("unununu save form ununununun"),oa(e),oa(ia);var s=e.items.map(function(t){return[t.codigo,parseInt(t.cantidad,10),t.discount.raw]}),a={data:{mode:"post",store:"invoice",data:{fecha:lt.date(e.InvoiceDate),estado:"REG",codigo_cliente:e.summation.person,distribuidor:e.summation.distributor,descuento_especial:lt.percent(e.summation.discountPct/100).raw,lista_de_items:JSON.stringify({details:s}).split('"').join("'"),subtotal_iva_12:lt.usd(e.summation.iva12).raw,subtotal_iva_0:lt.usd(e.summation.iva0).raw,subtotal_descontado:lt.usd(e.summation.valor).raw,total_calculado:lt.usd(e.summation.total).raw,retenido:lt.usd(e.summation.retention).raw,monto_final:lt.usd(e.summation.final).raw,total_cobrado:0}}};oa("@@@@@@@@@@ pkge @@@@@@@@"),oa(a),n("newLocal",a),n("create",a)},backToListTab:function(t){var e=t.getters;t.dispatch;Xr.dispatch("invoice/fetchList",{customUrlFnArgs:e.getPaginator}),Xr.dispatch("invoice/setCurrentTab",0)}},getters:{getCurrentTab:function(t){return t.currentTab},getColumns:function(t){return t.columns},getInvoices:function(t){return t.list},getEnums:function(t){return t.enums},getPaginator:function(t){return t.paginator},getInvoice:function(t){return function(e){return t.entities[e]}}},mutations:{tab:function(t,e){window.lgr.debug("Invoice.index --\x3e mutations.tab -- ".concat(e)),t.currentTab=e},invoice:function(t,e){oa("".concat(e.id," = ").concat(e.data.codigo,"/").concat(e.data.nombre)),t.entities[e.id]=e.data},appendItemRow:function(t,e){(!t.formRows.row||!t.formRows.row[0]||t.formRows.row[0].code<0)&&(t.formRows.row=[]),t.formRows.row.push(e)},enums:function(t,e){t.enums=e},tableColumns:function(t,e){window.lgr.debug("Invoice.index --\x3e mutation.tableColumns"),t.columns=e}},customUrlFn:function(t,e){oa(V.server),oa("using paginator --\x3e ".concat(e));var n=t?"/".concat(t):"",s=e?"s=".concat(e.s,"&c=").concat(e.c):"s=0&c=0";oa("using customUrlFn( ".concat(n,", ").concat(s," )")),oa("URI :: ".concat(V.server,"/api/").concat(ma).concat(n,"?").concat(s));var a="".concat(V.server,"/api/").concat(ma).concat(n,"?").concat(s);return a},onCreateSuccess:function(){Xr.dispatch("invoice/backToListTab"),window.lgr.info("Invoice.index --\x3e mutation.onCreateSuccess OK!")},onUpdateSuccess:function(){Xr.dispatch("invoice/backToListTab"),window.lgr.info("Invoice.index --\x3e mutation.onUpdateSuccess OK!")},parseSingle:function(t){oa("parseSingle"),oa(t.data),oa(Xr.state.invoice.entities[t.data.itemID]);var e={};return e[da]=t.data.itemID,Object.assign({},t,{data:e})},parseList:function(t){var e=t.data[ma],n=e.data,s=e.titles,a=e.meta,i=e.enums,o=ct(s),r=n.map(function(t,e){var n=t,s={};return a.forEach(function(t,e){n[e]=lt[t.type](n[e],{foreignKey1:{fn:ua.processPersonFK,vl:n[e]},JSON1:{fn:ua.processDetailsJSON,vl:n[e]}})}),n.forEach(function(t,e){s[o[e]]=t}),s});return Xr.dispatch("invoice/setEnums",i.StatusLookup),Object.assign({},t,{data:r,columns:a,enums:Object(Fn["a"])(i)})}}),pa=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",[n("b-loading",{attrs:{"is-full-page":!1,active:t.isBusy,canCancel:!0},on:{"update:active":function(e){t.isBusy=e}}}),n("b-table",{attrs:{data:t.isEmpty?[]:t.formattedBottles,columns:t.columns,striped:!0,paginated:"","per-page":20,"current-page":1,"opened-detailed":t.defaultOpenedDetails,detailed:"","detail-key":"codigo",focusable:"",narrowed:!0,"mobile-cards":t.hasMobileCards},on:{"details-open":function(e,n){return t.$toast.open("Expanded "+e.nombre)}},scopedSlots:t._u([{key:"header",fn:function(e){return[n("b-tooltip",{attrs:{position:"is-left",active:!!e.column.meta,label:e.column.meta,dashed:""}},[t._v("\n        "+t._s(e.column.label)+"\n      ")])]}},{key:"detail",fn:function(t){var e=t.row;return[n("bottle-detail",{attrs:{id:e.codigo}})]}}])},[n("template",{slot:"empty"},[n("section",{staticClass:"section"},[n("div",{staticClass:"content has-text-grey has-text-centered",staticStyle:{"font-size":"large"}},[n("icon",{attrs:{scale:"3",name:"thumbs-down"}}),n("p",[t._v("No results")])],1)])])],2),n("div",{staticClass:"control cardMode"},[n("b-switch",{model:{value:t.hasMobileCards,callback:function(e){t.hasMobileCards=e},expression:"hasMobileCards"}},[t._v("Modo tarjeta "),n("small",[t._v("(filas estrechas)")])])],1),n("div",{staticClass:"block"},[n("button",{staticClass:"button is-small is-primary",on:{click:function(e){t.columnSelectorOpen=!t.columnSelectorOpen}}},[t._v("\n        Escoger Columnas\n    ")])]),n("b-collapse",{staticClass:"panel",attrs:{open:t.columnSelectorOpen},on:{"update:open":function(e){t.columnSelectorOpen=e}}},[n("ul",[n("b-field",{attrs:{grouped:"","group-multiline":""}},t._l(t.columns,function(e,s){return n("div",{key:s,staticClass:"control"},[n("li",[n("b-checkbox",{model:{value:e.visible,callback:function(n){t.$set(e,"visible",n)},expression:"column.visible"}},[t._v("\n              "+t._s(e.meta)+"\n            ")])],1)])}))],1)])],1)},fa=[],ba=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",[n("nav",{staticClass:"panel"},[n("p",{staticClass:"panel-heading"},[n("span",{staticClass:"is-size-6"},[t._v("Registro #"+t._s(t.p(t.id).codigo))])]),n("b-tabs",{model:{value:t.activeSubTab,callback:function(e){t.activeSubTab=e},expression:"activeSubTab"}},[n("b-tab-item",[n("template",{slot:"header"},[n("p",{staticClass:"button is-small is-outlined"},[n("b-icon",{attrs:{icon:"eye"}})],1)]),n("bottle-record",{attrs:{invc:t.p(t.id)}})],2),n("b-tab-item",{attrs:{visible:t.canAlter()}},[n("template",{slot:"header"},[n("p",{staticClass:"button is-small is-info is-outlined"},[n("b-icon",{attrs:{icon:"edit"}})],1)]),n("bottle-update",{attrs:{invc:t.p(t.id)}})],2),n("b-tab-item",{attrs:{visible:t.canAssign()}},[n("template",{slot:"header"},[n("p",{staticClass:"button is-small is-warning has-text-weight-bold is-outlined"},[n("b-icon",{attrs:{icon:"lock"}})],1)]),n("bottle-auth",{attrs:{invc:t.p(t.id)}})],2),n("b-tab-item",{attrs:{visible:t.canAssign()}},[n("template",{slot:"header"},[n("p",{staticClass:"button is-small is-danger is-outlined"},[n("b-icon",{attrs:{icon:"trash"}})],1)]),t._v('\n        The record for "'+t._s(t.p(t.id).nombre)+'" will be marked for deletion, will no longer appear in the bottles list, but will be kept for historical purposes.\n\n        '),n("nav",{staticClass:"level"},[n("div",{staticClass:"level-right"},[n("div",{staticClass:"level-item has-text-centered"},[n("a",{staticClass:"button is-info",on:{click:function(e){t.activeSubTab=0}}},[t._v("Go back")])])]),n("div",{staticClass:"level-left"},[n("div",{staticClass:"level-item has-text-centered"},[n("a",{staticClass:"button is-danger"},[t._v("Yes, Delete")])])])])],2)],1)],1)])},ha=[],ga=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("nav",{staticClass:"level"},[n("div",{staticClass:"level-left"},[n("div",{staticClass:"level-item has-text-centered"},[n("div",[n("p",{staticClass:"heading"},[t._v("Codigo")]),n("p",{staticClass:"is-size-5"},[t._v(t._s(t.invc.codigo))])])]),n("div",{staticClass:"level-item has-text-centered"},[n("div",[n("p",{staticClass:"heading"},[t._v("Fecha")]),n("p",{staticClass:"is-size-5"},[t._v(t._s(t.invc.fecha))])])])]),n("div",{staticClass:"level-item has-text-centered"},[n("div",[n("p",{staticClass:"heading"},[t._v("Cliente")]),n("p",{staticClass:"is-size-5"},[t._v(t._s(t.invc.codigo_cliente))]),n("p",{class:["si"===t.invc.distribuidor?"has-text-info":"is-invisible"]},[t._v("\n            Distribuidor\n          ")])])]),n("div",{staticClass:"level-right"},[n("div",{staticClass:"level-item has-text-centered"},[n("div",[n("p",{staticClass:"heading"},[t._v("Mail")]),n("p",{staticClass:"is-size-5"},[t._v(t._s(t.invc.email))])])])])]),n("nav",{staticClass:"level"},[n("div",{staticClass:"level-item has-text-centered"},[n("b-table",{attrs:{data:t.detail,narrowed:!0},scopedSlots:t._u([{key:"default",fn:function(e){return[n("b-table-column",{attrs:{field:"cant",label:"Cantidad",width:"10",numeric:""}},[t._v("\n                  "+t._s(e.row.cantidad)+"\n              ")]),n("b-table-column",{attrs:{field:"nombre",label:"Nombre",width:"400"}},[t._v("\n                  ("+t._s(e.row.codigo)+") "+t._s(e.row.nombre)+"\n              ")]),n("b-table-column",{attrs:{field:"nombre",label:"Unidades"}},[t._v("\n                  "+t._s(e.row.unidad)+"\n              ")]),n("b-table-column",{attrs:{field:"precio",label:"Precio",width:"100"}},[t._v("\n                  "+t._s(e.row.precio)+"\n              ")]),n("b-table-column",{attrs:{field:"descuento",label:"Descuento Especial",width:"10"}},[t._v("\n                  "+t._s(e.row.descuento)+"\n              ")]),n("b-table-column",{attrs:{field:"total",label:"Total",width:"100"}},[t._v("\n                  "+t._s(e.row.total)+"\n              ")])]}}])})],1)]),n("nav",{staticClass:"level"},[n("div",{staticClass:"level-left has-text-centered"},[n("div",[n("p",{staticClass:"heading"},[t._v("Estado")]),n("p",{staticClass:"is-size-5"},[t._v(t._s(t.enums[t.invc.estado]))])])]),n("div",{staticClass:"level-item has-text-centered"},[n("b-table",{attrs:{data:t.totals||[],bordered:!0,narrowed:!0,"mobile-cards":!0},scopedSlots:t._u([{key:"default",fn:function(e){return[n("b-table-column",{attrs:{field:"title"}},[t._v("\n                  "+t._s(e.row.title)+"\n              ")]),n("b-table-column",{attrs:{field:"value",numeric:""}},[t._v("\n                  "+t._s(e.row.value)+"\n              ")])]}}])})],1)])])},Ca=[],wa=console.log,_a={data:function(){var t=[];return{totals:t}},computed:Object(A["a"])({},Object(N["c"])("bottle",{enums:"getEnums"}),{detail:function(){wa("  *************** INVC **********************\n      ");var t=this.invc,e=t.lista_de_items,n="si"===t.distribuidor;wa(this);var s=[];wa("items object"),wa(e);for(var a=0;a<e.length;a+=1){var i=e[a],o=n?i[0].valor_distribuidor:i[0].valor,r=i[1],c=lt.percent(i[2],0);wa("At ".concat(a," -- ").concat(i[0].unidad," (").concat(i[0].codigo,") ").concat(i[0].nombre)),s.push({codigo:i[0].codigo,nombre:i[0].nombre,unidad:i[0].unidad,cantidad:r,precio:o.str,descuento:lt.percent(1-c.raw,0).str,total:lt.usd(o.raw*r-c.raw).str})}return this.totals=[],this.totals.push({title:"Subtotal IVA 12%",value:t.subtotal_iva_12.str}),this.totals.push({title:"Descuento Especial",value:t.descuento_especial.str}),this.totals.push({title:"Valor",value:t.subtotal_descontado.str}),this.totals.push({title:"IVA",value:lt.usd(t.total_calculado.raw-t.subtotal_descontado.raw).str}),this.totals.push({title:"Valor Total",value:t.total_calculado.str}),this.totals.push({title:"Retenido",value:t.retenido.str}),this.totals.push({title:"Total Final",value:t.monto_final.str}),s}}),props:{invc:{type:Object,required:!0,default:function(){return{codigo:9999,ruc_cedula:"34-4545",nombre:"asdf asdf asdf asdf",telefono:"23452345",direccion:"asdfasdf",distribuidor:"si",retencion:"no",tipo_de_documento:"RUC"}}}}},ya=_a,xa=(n("48bb"),Object(I["a"])(ya,ga,Ca,!1,null,"b780b8b0",null));xa.options.__file="Retrieve.vue";var Oa=xa.exports,ka=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("b-loading",{attrs:{"is-full-page":!1,active:t.isUpdating,canCancel:!0},on:{"update:active":function(e){t.isUpdating=e}}}),t.values?n("code",{staticClass:"my-form my-form--code",domProps:{textContent:t._s(t.values)}}):n("formulate",{staticClass:"my-form",attrs:{name:t.formUid,initial:t.invc},on:{submit:t.saveForm}},[n("formulate-element",{attrs:{name:"codigo",type:"hidden",placeholder:"-1"}}),n("article",{staticClass:"tile is-child box"},[n("h3",{staticClass:"title"},[t._v("Bottle")]),n("div",{staticClass:"columns is-mobile is-multiline is-centered"},[n("div",{staticClass:"control"},[n("formulate-element",{attrs:{type:"submit",name:"Save",elementClasses:"button is-info"}})],1)])])],1)],1)},Da=[],Ea=(console.log,{props:["invc"],data:function(){return{values:!1}},computed:Object(A["a"])({},Object(N["c"])("bottle",{enums:"getEnums"}),Object(N["d"])("bottle",{isUpdating:"isUpdating"}),{formUid:function(){return"pers_".concat(this.invc.codigo)},typesId:function(){var t=this.enums.DocTypeLookup,e=[];return Object.keys(t).forEach(function(n){var s=t[n];e.push({name:s,value:n,id:n,label:s})}),e}}),methods:Object(A["a"])({},Object(N["b"])("bottle",{saveForm:"saveForm"}))}),Pa=Ea,Sa=(n("4d3c"),Object(I["a"])(Pa,ka,Da,!1,null,null,null));Sa.options.__file="Update.vue";var Ia=Sa.exports,ja=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.values?n("code",{staticClass:"my-form my-form--code",domProps:{textContent:t._s(t.values)}}):n("formulate",{staticClass:"my-form",attrs:{name:t.formUid,initial:t.permissionsField},on:{submit:t.saveForm}},[n("formulate-element",{attrs:{name:"codigo",type:"hidden",placeholder:"-1"}}),n("article",{staticClass:"tile is-child box"},[n("h3",[t._v(t._s(t.invc.nombre))]),n("h5",[t._v("Sus Permisos por Recurso")]),n("div",{staticClass:"columns is-mobile is-multiline is-centered"},[t._l(t.resources,function(e){return n("div",{staticClass:"column"},[n("div",{staticClass:"control"},[n("label",{staticClass:"label"},[t._v(t._s(e))]),n("formulate-element",{staticClass:"select is-small is-focused",attrs:{name:e,type:"select",initial:"0",options:t.levels}})],1)])}),n("div",{staticClass:"control"},[n("formulate-element",{attrs:{type:"submit",name:"Save",elementClasses:"button is-info"}})],1)],2)])],1)],1)},Ta=[],Aa=console.log,Na={props:["invc"],data:function(){return{values:!1}},computed:Object(A["a"])({},Object(N["c"])("bottle",{enums:"getEnums"}),{permissionsField:function(){return Aa("xxxxxxxxxxxxxxxxxxx this.invc xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"),Aa(this.invc),Aa(this.invc.permissions),this.invc.permissions?this.invc.permissions:{}},formUid:function(){return"pers_".concat(this.invc.codigo)},levels:function(){return we.options},resources:function(){return Aa("Resources"),Aa(je),je}}),methods:Object(A["a"])({},Object(N["b"])("bottle",{saveForm:"saveForm"}))},La=Na,$a=(n("fa42"),Object(I["a"])(La,ja,Ta,!1,null,null,null));$a.options.__file="Permissions.vue";var Ra=$a.exports,Ua={name:"RUDcards",props:["id","distributor"],data:function(){return{activeSubTab:0}},components:{"bottle-record":Oa,"bottle-update":Ia,"bottle-auth":Ra},methods:{canAlter:function(){return this.$can("alter","bottle")},canAssign:function(){return this.$can("assign","bottle")}},computed:Object(A["a"])({},Object(N["c"])("bottle",{p:"getBottle"}))},Ma=Ua,Fa=Object(I["a"])(Ma,ba,ha,!1,null,null,null);Fa.options.__file="RUDcards.vue";var Ba=Fa.exports,Ja=console.log,Qa={name:"BottleList",props:{tst:"passed in with props"},data:function(){var t=[];return{anObj:{tst:"passed in as data"},hasMobileCards:!1,isFullPage:!1,isEmpty:!1,defaultOpenedDetails:[4358],selected:t[1],columnSelectorOpen:!1}},components:{"bottle-detail":Ba},computed:Object(A["a"])({},Object(N["c"])("bottle",{bottles:"list",columns:"getColumns"}),Object(N["c"])({loggedIn:"isAuthenticated"}),Object(N["d"])("bottle",{isLoadingList:"isFetchingList",isUpdating:"isUpdating",isCreating:"isCreating"}),{formattedBottles:function(){return this.bottles.map(function(t){var e={};return Object.entries(t).forEach(function(t){var n=Object(Pt["a"])(t,2),s=n[0],a=n[1];e[s]=a.str||a}),e})},isBusy:function(){return this.isLoadingList||this.isUpdating||this.isCreating}}),methods:Object(A["a"])({},Object(N["b"])(["handle401","notifyUser"]),Object(N["b"])("bottle",{setColumns:"setColumns"}),{onFetchBottles:function(){var t=this;Ja(" * * Try to fetch bottles * *"),Yn()().interval(100).times(20).condition(function(){return!vn.state.isFetchingList&&!Mn.state.isFetchingList}).done(function(){return t.fetchBottles()})}})},Ya=Qa,qa=(n("003a"),Object(I["a"])(Ya,pa,fa,!1,null,null,null));qa.options.__file="List.vue";var Va=qa.exports,za=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"dialog-window"}},[n("div",{staticClass:"container is-fluid",attrs:{id:"header"}},[n("nav",{staticClass:"level"},[n("div",{staticClass:"level-left"},[t._m(0),t._m(1),n("div",{staticClass:"level-item"},[n("b-input",{attrs:{placeholder:"codigo de envase"},on:{focus:t.seekCodigoFocus,blur:t.seekCodigoBlur},model:{value:t.seekCodigo,callback:function(e){t.seekCodigo=e},expression:"seekCodigo"}}),n("strong",[t._v(t._s(t.seekIndicator))])],1)]),n("div",{staticClass:"level-right"},[n("p",{staticClass:"level-item"},[n("strong",[t._v(t._s(t.items.length))])]),n("p",{staticClass:"level-item"},[n("a",{staticClass:"button is-danger",on:{click:t.purge}},[t._v("Purge")])])])])]),n("div",{attrs:{id:"scrollable-content"}},[n("virtual-scroller",{staticClass:"virtual-list",attrs:{"page-mode":"",items:t.items||[],"item-height":"24","content-tag":"ul"},scopedSlots:t._u([{key:"default",fn:function(e){return["planta"===e.item.data.ubicacion.toLowerCase()?n("li",{key:e.itemKey},[t._v("\n          "+t._s(e.item.data.codigo)+": Movimientos "+t._s(e.item.data.movements&&e.item.data.movements.length||"_")+" - ubicacion: Planta\n        ")]):n("li",{key:e.itemKey},[t._v("\n          "+t._s(e.item.data.codigo)+": Movimientos "+t._s(e.item.data.movements&&e.item.data.movements.length||"_")+" - ubicacion: "),n("strong",[t._v(t._s(e.item.data.ultimo))])])]}}])})],1),t._v("\n  >"+t._s(t.getRelational)+"<\n  "+t._s(t.relationalData)+"\n")])},Ga=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"level-item"},[n("p",{staticClass:"subtitle is-6 is-primary"},[n("strong",[t._v("Buscar Envase")])])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"level-item"},[n("p",{staticClass:"subtitle is-7"},[n("strong",[t._v("Codigo")])])])}],Ka=(n("7514"),n("3b2b"),console.log),Wa=console.error,Ha="codigo de envase",Za=function(t,e){Ka("\n    ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::");var n=new RegExp("^.*","gi");return e!==Ha&&(n=new RegExp("^".concat(e,".*"),"gi")),t.liveFeedStatus="finding",Ka("Searching with: ".concat(n," from >").concat(e,"<")),t.$pouch.liveFind({selector:{"data.codigo":{$regex:n},"data.type":"bottle"},sort:[{"data.codigo":"asc"}]}).on("update",function(e,n){var s=e;0===s.doc.data.ultimo?t.getItems(s):t.$pouch.rel.find("aPerson",s.doc.data.ultimo).then(function(e){s.doc.data.ultimo=e.allPersons[0]&&e.allPersons[0].nombre||s.doc.data.ultimo,s.doc.data.extra=e,t.getItems(s)})}).on("ready",function(){Ka("###############   Initial query complete.   ##############"),t.$pouch.rel.find("aPerson",12357).then(function(t){Ka("prsn 12357"),Ka(t)}),t.liveFeedStatus="listening"}).on("cancelled",function(){Ka("###############   LiveFind cancelled.   ##############"),t.liveFeedStatus="idle",t.newSearch()}).on("error",function(t){Wa("Oh no!",t)})},Xa={data:function(){return{items:[],liveFeed:null,liveFeedStatus:"idle",seekCodigo:Ha,seekCodigoIsDirty:!1,seeking:!1,relationalData:"none"}},created:function(){this.liveFeed=Za(this,Ha)},computed:{getRelational:function(){Ka("###############   getRelational   ##############"),this.$pouch.allDocs({include_docs:!0}).then(function(t){Ka("====== all Docs ======"),Ka(t)}),this.$pouch.rel.find("aPerson",12347).then(function(t){Ka("====== Person 12347 ======"),Ka(t)})},seekIndicator:function(){return Ka("###############   seekIndicator   ##############"),Ka(this.seekCodigo),this.seeking?"⟳ Fetching new results":this.seekCodigoIsDirty?"... Typing":"✓ Done"}},watch:{seekCodigo:function(){Ka("###############   seekCodigo   ##############"),Ka(this.seekCodigo),this.seekCodigoIsDirty=!0,this.items=[],Ka(this.liveFeedStatus),this.liveFeedStatus="cancelling",this.liveFeed.cancel()}},methods:{purge:function(){Ka("###############   purge   ##############"),this.$pouch.rel.find("aPerson").then(function(t){Ka(t)})},newSearch:Object(g["debounce"])(function(){this.seekCodigo!==Ha&&(Ka("###############   newSearch   ##############"),this.seeking=!0,setTimeout(function(){Ka("setTimeout"),Ka(this.seekCodigo),this.seeking=!1,this.seekCodigoIsDirty=!1}.bind(this),2e3),this.liveFeed=Za(this,this.seekCodigo))},100),getItems:function(t){var e=null;switch(t.action){case"REMOVE":Ka("###############   LiveFind remove not implemented   ##############");break;case"UPDATE":e=this.items.findIndex(function(e){return e._id===t.id}),Ka("###############   LiveFind update   ##############"),Ka(this.items[e]),this.items[e]=t.doc,this.items=this.items.slice();break;default:this.items.push(t.doc)}},seekCodigoFocus:function(){this.seekCodigo===Ha&&(this.seekCodigo="")},seekCodigoBlur:function(){""===this.seekCodigo&&(this.seekCodigo=Ha)}}},ti=Xa,ei=(n("52be"),Object(I["a"])(ti,za,Ga,!1,null,null,null));ei.options.__file="Test.vue";var ni=ei.exports,si=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",[n("b-tabs",{model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},[n("b-tab-item",{attrs:{label:"Bottles"}},[n("router-view",{attrs:{name:"bottlesList"}})],1),n("b-tab-item",{attrs:{visible:t.canEdit(),label:"Add Bottle"}},[n("Create")],1)],1),n("router-link",{staticClass:"button is-small is-link is-outlined",attrs:{to:{name:"home"}}},[n("icon",{attrs:{name:"arrow-circle-up"}}),t._v("\n     Home\n  ")],1)],1)},ai=[],ii=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("b-loading",{attrs:{"is-full-page":!1,active:t.isCreating,canCancel:!0},on:{"update:active":function(e){t.isCreating=e}}}),n("formulate",{staticClass:"my-form",attrs:{name:"createBottle"},on:{submit:t.commitForm}},[n("formulate-element",{attrs:{name:"summation",type:"hidden",placeholder:"-1"}}),n("formulate-element",{attrs:{name:"items",type:"hidden",placeholder:"-1"}}),n("article",{staticClass:"tile is-child box"},[n("h3",{staticClass:"title"},[t._v("Bottle")]),n("div",{staticClass:"columns"},[n("div",{staticClass:"column is-centered"},[n("div",{staticClass:"control"},[n("label",{staticClass:"label"},[t._v("Cliente")]),n("formulate-element",{attrs:{name:"Persona",validation:"required"}},[n("autocomplete-input",{attrs:{options:t.personsId||null},model:{value:t.Persona,callback:function(e){t.Persona=e},expression:"Persona"}})],1)],1)]),n("div",{staticClass:"column is-centered"},[n("div",{staticClass:"control"},[n("label",{staticClass:"label"},[t._v("Fecha")]),n("formulate-element",{attrs:{name:"BottleDate",validation:"required"}},[n("dateselect-input",{model:{value:t.BottleDate,callback:function(e){t.BottleDate=e},expression:"BottleDate"}})],1)],1)]),n("div",{staticClass:"column is-centered"},[n("div",{staticClass:"control"},[n("label",{staticClass:"label"},[t._v("Descuento")]),n("formulate-element",{attrs:{name:"desc",placeholder:"0","element-classes":"resizedTextbox",validation:"isPct(desc)"}})],1)])]),n("div",{staticClass:"columns is-mobile"},[n("div",{staticClass:"column"},[n("label",{staticClass:"label"},[t._v("Itemes")]),n("button",{staticClass:"button is-info",on:{click:t.openModal}},[n("b-icon",{attrs:{icon:"plus"}}),n("span",[t._v("Anadir item")])],1),n("button",{staticClass:"button field is-danger",attrs:{disabled:!t.checkedRows.length},on:{click:t.dropRow}},[n("b-icon",{attrs:{icon:"trash"}}),n("span",[t._v("Borrar seleccionadas")])],1),n("b-modal",{attrs:{active:t.isComponentModalActive,"has-modal-card":""},on:{"update:active":function(e){t.isComponentModalActive=e}}},[n("detailsForm")],1),n("b-table",{attrs:{data:t.tableData,"checked-rows":t.checkedRows,checkable:""},on:{"update:checkedRows":function(e){t.checkedRows=e}},scopedSlots:t._u([{key:"default",fn:function(e){return[n("b-table-column",{attrs:{label:"Codigo",numeric:""}},[t._v("\n                    "+t._s(e.row.codigo)+"\n                  ")]),n("b-table-column",{attrs:{label:"Producto/Servicio"}},[t._v("\n                    "+t._s(e.row.nombre)+"\n                  ")]),n("b-table-column",{attrs:{label:"Unidad"}},[t._v("\n                    "+t._s(e.row.unidad)+"\n                  ")]),n("b-table-column",{attrs:{label:"Valor",numeric:""}},[t._v("\n                    "+t._s(e.row.valor)+"\n                  ")]),n("b-table-column",{attrs:{label:"IVA",numeric:""}},[t._v("\n                    "+t._s(e.row.iva.str)+"\n                  ")]),n("b-table-column",{attrs:{label:"Cantidad",centered:""}},[t._v("\n                    "+t._s(e.row.cantidad)+"\n                  ")]),n("b-table-column",{attrs:{label:"Total",numeric:""}},[t._v("\n                    "+t._s(e.row.total)+"\n                  ")])]}}])},[n("template",{slot:"footer"},[n("div",{staticClass:"columns"},[n("div",{staticClass:"column is-offset-2 is-narrow-mobile"},[n("div",{staticClass:"box",staticStyle:{width:"125px"}},[t.retention?n("div",{class:["si"===t.retention?"":"strike-out"]},[t._v("\n                          Retencion\n                        ")]):t._e(),t.distributor?n("div",{class:["si"===t.distributor?"":"strike-out"]},[t._v("\n                          Distribuidor\n                        ")]):t._e()])]),n("div",{staticClass:"column is-5"},[n("div",{staticClass:"box"},[n("b-table",{attrs:{data:t.totals},scopedSlots:t._u([{key:"default",fn:function(e){return[n("b-table-column",{attrs:{width:"180"}},[t._v("\n                                "+t._s(e.row.label)+"\n                            ")]),n("b-table-column",{attrs:{numeric:""}},[t._v("\n                              "+t._s(e.row.value)+"\n                            ")])]}}])})],1)]),n("div",{staticClass:"column is-1"})])])],2),n("div",{staticClass:"control"},[n("formulate-element",{attrs:{type:"submit",name:"Save",elementClasses:"button is-info"}})],1)],1)])])],1)],1)},oi=[],ri=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"modal-card",staticStyle:{width:"auto"}},[n("formulate",{staticClass:"my-form",attrs:{name:"bottleDetails"},on:{submit:t.saveForm}},[n("header",{staticClass:"modal-card-head"},[n("p",{staticClass:"title"},[t._v("Item")])]),n("section",{staticClass:"modal-card-body"},[n("div",{staticClass:"columns"},[n("div",{staticClass:"column is-four-fifths"},[n("div",{staticClass:"control"},[n("label",{staticClass:"label"},[t._v("Producto / Servicio")]),n("formulate-element",{staticClass:"select is-small is-focused",attrs:{name:"code",type:"select",initial:"nombre",options:t.typesId}})],1)]),n("div",{staticClass:"column is-one-fifth"},[n("div",{staticClass:"control"},[n("label",{staticClass:"label"},[t._v("Cantidad")]),n("formulate-element",{attrs:{name:"qty",placeholder:"cantidad","element-classes":"resizedTextbox"}})],1)])])]),n("footer",{staticClass:"modal-card-foot"},[n("button",{staticClass:"button",attrs:{type:"button"},on:{click:function(e){t.$parent.close()}}},[t._v("Close")]),n("formulate-element",{attrs:{type:"submit",name:"Save",elementClasses:"button is-info"}})],1)])],1)},ci=[],li=console.log,ui={computed:Object(A["a"])({},Object(N["c"])("product",{products:"list",productsMap:"getProductsMap"}),{typesId:function(){li("%%%%%%%%%%%%%%%%%%%% CC %%%%%%%%%%%%%%%%%%"),li(this),li(this.$store.getters);var t=[],e=this.products;return e&&Object.keys(e).forEach(function(n){var s=e[n];t.push({name:s.nombre,value:s.codigo,id:s.codigo,label:"".concat(s.nombre," (").concat(s.unidad,")")})}),li(t),t}}),methods:Object(A["a"])({},Object(N["b"])("bottle",{saveRow:"saveRow"}),{saveForm:function(t){this.saveRow({rowNum:-1,values:t}),this.$parent.close()}})},di=ui,mi=(n("1435"),Object(I["a"])(di,ri,ci,!1,null,"02e762fe",null));mi.options.__file="Details.vue";var vi=mi.exports,pi=console.log,fi=(console.error,{props:["pers"],components:{detailsForm:vi,"autocomplete-input":Ns,"dateselect-input":Fs},created:function(){this.persons&&this.persons.length>0&&this.productsMap&&Object.keys(this.productsMap).length>0&&this.products&&this.products.length>0||this.$router.push({name:"home"})},data:function(){var t=[];return{totals:t,isComponentModalActive:!1,checkedRows:[],retention:null,distributor:null,myDate:new Date,formats:{title:"MMMM / YYYY",weekdays:"W",navMonths:"MMM",input:["YYYY-MM-DD","YYYY/MM/DD"],dayPopover:"L",data:["L","YYYY-MM-DD","YYYY/MM/DD"]}}},computed:Object(A["a"])({},Object(N["c"])("bottle",{enums:"getEnums"}),Object(N["c"])("product",{products:"list",productsMap:"getProductsMap"}),Object(N["c"])("person",{persons:"list",getPerson:"getPerson"}),Object(N["d"])("bottle",{isCreating:"isCreating",formRows:"formRows"}),Object(d["mapModels"])({Persona:"createBottle/Persona",BottleDate:"createBottle/BottleDate"}),{tableData:function(){var t=this,e=[],n=this.$store.state;if(n.values.createBottle){var s=n.values.createBottle;s.Persona=s.Persona||"(0) no one",s.BottleDate=s.BottleDate||new Date;var a=[{codigo:"codigo",nombre:"nombre",unidad:"unidad",iva:"iva",valor:"$0.00",cantidad:0,total:"$0.00"}];pi("\n\n\n          tableData() ----------------------------"),pi(this.productsMap);var i=s.Persona.match(/\(([^)]+)\)/)[1],o=this.getPerson(i);this.retention=o&&o.retencion||null,this.distributor=o&&o.distribuidor||null,this.totals=[];var r=0,c=0,l=0,u={distributor:this.distributor,person:i,discountPct:0,iva0:0,iva12:0,subtotal:0,discount:0,retention:0,total:0};if(this.products.length<1)return a;if(this.formRows.row.length<1)return a;if(this.formRows.row[0].code<0)return a;this.formRows.row.forEach(function(n){pi("row"),pi(n);var s=t.productsMap[n.code];pi(s.porcentaje.raw),t.distributor&&"si"===t.distributor?(r=s.valor_distribuidor.str,c=s.valor_distribuidor.raw,l=lt.percent(s.valor_distribuidor.raw/s.valor.raw)):(r=s.valor.str,c=s.valor.raw,l=lt.percent(1));var a=c*n.qty;pi(s.iva);var i=0===s.iva.raw?a:0,o=s.iva.raw>0?a:0;u.iva0+=i,u.iva12+=o,u.subtotal+=i+o,e.push({codigo:n.code,nombre:s.nombre,unidad:s.unidad,discount:l,iva:s.iva,valor:r,cantidad:n.qty,total:lt.usd(c*n.qty).str})}),pi("rows"),pi(e),u.discountPct=s&&s.desc||0,u.discount=u.discountPct/100*u.subtotal,u.valor=u.subtotal-u.discount,u.iva=.12*u.valor,u.total=u.valor+u.iva,u.final=u.total,u.iva0>0&&this.totals.push({label:"Subtotal IVA  0%",value:lt.usd(u.iva0).str}),this.totals.push({label:"Subtotal IVA 12%",value:lt.usd(u.iva12).str}),this.totals.push({label:"Descuento Especial",value:lt.usd(u.discount).str}),this.totals.push({label:"Valor",value:lt.usd(u.valor).str}),this.totals.push({label:"IVA",value:lt.usd(u.iva).str}),this.totals.push({label:"Valor Total",value:lt.usd(u.total).str}),u.final=u.total,"si"===this.retention&&(u.retention=.01*u.total,u.final=u.total-u.retention,this.totals.push({label:"Retenido",value:lt.usd(u.retention).str})),this.totals.push({label:"Total Final",value:lt.usd(u.final).str}),pi("summation.iva0 ".concat(u.iva0)),pi("summation.iva12 ".concat(u.iva12)),pi("summation.discountPct ".concat(u.discountPct)),pi("summation.discount ".concat(u.discount)),pi("summation.valor ".concat(u.valor)),pi("summation.iva ".concat(u.iva)),pi("summation.total ".concat(u.total)),pi("summation.retention ".concat(u.retention)),pi("summation.final ".concat(u.final)),s.summation=u,s.items=e,pi(s),pi(this.$store),pi(e)}return e},personsId:function(){pi("%%%%%%%%%%%%%%%% personsId %%%%%%%%%%%%%%%%%% "),pi(this);var t=[],e=this.persons;return e&&(pi("prsns"),Object.keys(e).forEach(function(n){var s=e[n];t.push({value:s.codigo,label:"".concat(s.nombre)})})),pi(t),{list:t,data:function(t){return"(".concat(t.value,") ").concat(t.label)}}}}),methods:Object(A["a"])({},Object(N["b"])("bottle",{saveForm:"saveForm"}),{openModal:function(t){t.preventDefault(),this.isComponentModalActive=!0},dropRow:function(t){var e=this;this.checkedRows.forEach(function(t){e.formRows.row.forEach(function(n,s){n.code===t.codigo&&n.code===t.codigo&&e.formRows.row.splice(s,1)})}),pi(this.checkedRows),t.preventDefault()},commitForm:function(t){this.saveForm(t)},setItem:function(t){pi("Item ".concat(t.qty," of ").concat(t.code))}})}),bi=fi,hi=(n("f021"),Object(I["a"])(bi,ii,oi,!1,null,"07a38249",null));hi.options.__file="CreateBottle.vue";var gi=hi.exports,Ci=console.log,wi={name:"Bottle",components:{Create:gi},computed:Object(A["a"])({},Object(N["c"])("bottle",{currentTab:"getCurrentTab"}),{activeTab:{get:function(){return Xr.state.bottle.currentTab},set:function(t){return Xr.dispatch("bottle/setCurrentTab",t)}}}),methods:Object(A["a"])({canEdit:function(){return this.$can("comment","bottles/list")},qtst:function(){Ci(" ------- Quick Test -------"),this.onCreateBottle()}},Object(N["b"])("bottle",{createBottle:"create",setTab:"setCurrentTab"}))},_i=wi,yi=Object(I["a"])(_i,si,ai,!1,null,null,null);yi.options.__file="Layout.vue";var xi=yi.exports,Oi=[{meta:"Codigo",label:"COD",field:"codigo",centered:!1,visible:!0,width:5,numeric:!0,type:"integer",usage:"rw",idx:0},{meta:"Fecha",label:"FECH",field:"fecha",centered:!0,visible:!0,width:"10",numeric:!1,type:"date",usage:"rw",idx:1},{meta:"Estado",label:"ESTS",field:"estado",centered:!0,visible:!1,width:10,numeric:!1,type:"text",usage:"rw",idx:2},{meta:"Codigo Cliente",label:"CCLI",field:"codigo_cliente",centered:!0,visible:!0,width:6,numeric:!1,type:"foreignKey1",usage:"rw",idx:3},{meta:"Distribuidor",label:"DIST",field:"distribuidor",centered:!0,visible:!0,width:4,numeric:!1,type:"text",usage:"rw",idx:4},{meta:"Descuento Especial",label:"DESC",field:"descuento_especial",centered:!1,visible:!1,width:12,numeric:!0,type:"percent",usage:"rw",idx:5},{meta:"Lista de Items",label:"ITMS",field:"lista_de_items",centered:!0,visible:!1,width:4,numeric:!0,type:"JSON1",usage:"rw",idx:6},{meta:"Subtotal IVA 12%",label:"IV12",field:"subtotal_iva_12",centered:!1,visible:!1,width:12,numeric:!0,type:"usd",usage:"rw",idx:7},{meta:"Subtotal IVA 0%",label:"IV00",field:"subtotal_iva_0",centered:!1,visible:!1,width:12,numeric:!0,type:"usd",usage:"rw",idx:8},{meta:"Subtotal Descontado",label:"STDC",field:"subtotal_descontado",centered:!1,visible:!1,width:12,numeric:!0,type:"usd",usage:"rw",idx:9},{meta:"Total Calculado",label:"TOTL",field:"total_calculado",centered:!1,visible:!1,width:12,numeric:!0,type:"usd",usage:"rw",idx:10},{meta:"Retenido",label:"RETN",field:"retenido",centered:!1,visible:!1,width:12,numeric:!0,type:"usd",usage:"rw",idx:11},{meta:"Monto Final",label:"MNTO",field:"monto_final",centered:!1,visible:!0,width:12,numeric:!0,type:"usd",usage:"rw",idx:12},{meta:"Total Cobrado",label:"COBR",field:"total_cobrado",centered:!1,visible:!1,width:12,numeric:!0,type:"usd",usage:"rw",idx:13}],ki=void 0,Di=console.log,Ei=[{name:ae,path:"list",components:{bottlesList:Va}}],Pi=[].concat(Ei),Si=[{name:ie,path:"bottles",component:xi,children:Pi},{name:oe,path:"bottle/:id",component:Oa},{name:se,path:"bottles/test",component:ni}];L["client"].interceptors.request.use(function(t){var e=t,n=window.ls.get(V.tokenName);return null!=n&&(e.headers.Authorization="JWT ".concat(n)),e},function(t){return Di("request failed"),Promise.reject(t)});var Ii={processPersonFK:function(t){var e=vn.state.entities[t];return e?e.nombre:"Usuario #".concat(t)},processDetailsJSON:function(t){if(!Mn.state.entities)return t;if(Object.keys(Mn.state.entities).length<1)return t;try{return JSON.parse(t.replace(/'/g,'"')).details.filter(function(t){return t[0]>0}).map(function(t){return[Mn.state.entities[t[0]],t[1],t[2]]})}catch(e){return t}}},ji="codigo",Ti="bottle",Ai=$()({resource:Ti,idAttribute:ji,urlRoot:"".concat(V.server),client:L["client"],state:{columns:Oi,currentTab:0,enums:{},paginator:{s:1,c:1e4},formRows:{row:[]}},actions:{setColumns:function(t,e){var n=t.commit;window.lgr.info("Bottle.index --\x3e actions.setColumns"),Di(e),n("tableColumns",e)},setCurrentTab:function(t,e){var n=t.commit;window.lgr.info("Bottle.index --\x3e actions.setCurrentTab -- ".concat(e)),n("tab",e)},setEnums:function(t,e){var n=t.commit;window.lgr.info("Bottle.index --\x3e actions.setEnums"),n("enums",e)},updLocal:function(t,e){var n=t.commit;Di("uuuuuuu Update local record uuuuuuuuuu"),Di("".concat(e.data.mode," ").concat(e.data.store," ").concat(e.id)),Di(e.data.data),n("bottle",{id:e.id,data:e.data.data})},newLocal:function(t,e){t.dispatch;Di("uuuuuuu Append new local record uuuuuuuuuu"),Di("".concat(e.data.mode," ").concat(e.data.store))},saveRow:function(t,e){Di("\n\n        Saving row......................");var n=t.rootGetters["product/getProduct"](e.values.code);Di(n),Di(e.values),t.commit("appendItemRow",e.values)},saveForm:function(t,e){var n=t.dispatch;window.lgr.info("Bottle.index --\x3e actions.saveForm"),Di("unununu save form ununununun"),Di(e),Di(ki);var s=e.items.map(function(t){return[t.codigo,parseInt(t.cantidad,10),t.discount.raw]}),a={data:{mode:"post",store:"bottle",data:{fecha:lt.date(e.BottleDate),estado:"REG",codigo_cliente:e.summation.person,distribuidor:e.summation.distributor,descuento_especial:lt.percent(e.summation.discountPct/100).raw,lista_de_items:JSON.stringify({details:s}).split('"').join("'"),subtotal_iva_12:lt.usd(e.summation.iva12).raw,subtotal_iva_0:lt.usd(e.summation.iva0).raw,subtotal_descontado:lt.usd(e.summation.valor).raw,total_calculado:lt.usd(e.summation.total).raw,retenido:lt.usd(e.summation.retention).raw,monto_final:lt.usd(e.summation.final).raw,total_cobrado:0}}};Di("@@@@@@@@@@ pkge @@@@@@@@"),Di(a),n("newLocal",a),n("create",a)},backToListTab:function(t){var e=t.getters;t.dispatch;Xr.dispatch("bottle/fetchList",{customUrlFnArgs:e.getPaginator}),Xr.dispatch("bottle/setCurrentTab",0)}},getters:{getCurrentTab:function(t){return t.currentTab},getColumns:function(t){return t.columns},getBottles:function(t){return t.list},getEnums:function(t){return t.enums},getPaginator:function(t){return t.paginator},getBottle:function(t){return function(e){return t.entities[e]}}},mutations:{tab:function(t,e){window.lgr.debug("Bottle.index --\x3e mutations.tab -- ".concat(e)),t.currentTab=e},bottle:function(t,e){Di("".concat(e.id," = ").concat(e.data.codigo,"/").concat(e.data.nombre)),t.entities[e.id]=e.data},appendItemRow:function(t,e){(!t.formRows.row||!t.formRows.row[0]||t.formRows.row[0].code<0)&&(t.formRows.row=[]),t.formRows.row.push(e)},enums:function(t,e){t.enums=e},tableColumns:function(t,e){window.lgr.debug("Bottle.index --\x3e mutation.tableColumns"),t.columns=e}},customUrlFn:function(t,e){Di(V.server),Di("using paginator --\x3e ".concat(e));var n=t?"/".concat(t):"",s=e?"s=".concat(e.s,"&c=").concat(e.c):"s=0&c=0";Di("using customUrlFn( ".concat(n,", ").concat(s," )")),Di("URI :: ".concat(V.server,"/api/").concat(Ti).concat(n,"?").concat(s));var a="".concat(V.server,"/api/").concat(Ti).concat(n,"?").concat(s);return a},onCreateSuccess:function(){Xr.dispatch("bottle/backToListTab"),window.lgr.info("Bottle.index --\x3e mutation.onCreateSuccess OK!")},onUpdateSuccess:function(){Xr.dispatch("bottle/backToListTab"),window.lgr.info("Bottle.index --\x3e mutation.onUpdateSuccess OK!")},parseSingle:function(t){Di("parseSingle"),Di(t.data),Di(Xr.state.bottle.entities[t.data.itemID]);var e={};return e[ji]=t.data.itemID,Object.assign({},t,{data:e})},parseList:function(t){var e=t.data[Ti],n=e.data,s=e.titles,a=e.meta,i=e.enums,o=ct(s),r=n.map(function(t,e){var n=t,s={};return a.forEach(function(t,e){n[e]=lt[t.type](n[e],{foreignKey1:{fn:Ii.processPersonFK,vl:n[e]},JSON1:{fn:Ii.processDetailsJSON,vl:n[e]}})}),n.forEach(function(t,e){s[o[e]]=t}),s});return Di(" * * Parsed bottles data * * "),Di("result"),Di(r),Xr.dispatch("bottle/setEnums",i.StatusLookup),Di(" - - - - - - - - - -  Parsed bottle list  - - - - - - - - - - "),Object.assign({},t,{data:r,columns:a,enums:Object(Fn["a"])(i)})}}),Ni=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("nav",{staticClass:"navbar is-transparent",staticStyle:{"background-color":"transparent"}},[n("div",{staticClass:"navbar-brand"},[n("router-link",{attrs:{to:{name:"home"}}},[n("img",{attrs:{src:t.logo,alt:"Iridium Blue Logo"}}),n("span",{staticStyle:{"font-family":"'Advent Pro'","font-size":"48px"},attrs:{"data-cyp":"appTitle"}},[t._v("iridium blue")])]),t._m(0)],1),n("div",{staticClass:"navbar-menu burger-bar",attrs:{id:"burgerBar"}},[n("div",{staticClass:"navbar-start"},[n("Shop"),n("Distributor"),n("Admin"),n("Tests")],1),n("div",{staticClass:"navbar-end"},[n("div",{staticClass:"navbar-item"},[n("div",{staticClass:"field is-grouped"},[n("Authentication")],1)])])])])},Li=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"navbar-burger burger",attrs:{id:"burger","data-target":"burgerBar"}},[n("span"),n("span"),n("span")])}],$i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.isKnown&&t.isHere?n("div",[n("a",{staticClass:"button is-small",class:t.highLightAdmin,attrs:{"data-cyp":"logOut"},on:{click:t.signOut}},[n("span",{attrs:{name:"icon"}},[n("icon",{attrs:{name:"sign-out-alt"}})],1),t._v(" "+t._s(t.$t("label.signout"))+", "+t._s(t.user)+"\n    ")])]):n("div",[t._v("\n     \n    "),n("a",{staticClass:"button is-small",attrs:{"data-cyp":"logIn"},on:{click:t.logIn}},[n("icon",{attrs:{name:"sign-in-alt"}}),t._v(" "+t._s(t.$t("label.signin"))+"\n    ")],1)])])},Ri=[],Ui=(n("6b54"),console.log),Mi={name:"auth",data:function(){return{tkn:null,axStkn:"unused",isActive:"unused"}},beforeUpdate:function(){this.$store.getters.permissions&&this.access!==this.$store.getters.permissions&&(this.access=this.$store.getters.permissions)},created:function(){var t=this;window.ls.on(V.activityName,function(e){window.lgr.warn("Auth.vue :: Activity updated :: ".concat(e)),t.setActivity(e)}),window.ls.on(V.authName,function(e){Ui("\n  ???????????????????\n   Do we ever get here?\n   Authentication vm.created() localStore onChange event\n  ???????????????????"),window.lgr.warn("Auth.vue :: Auth updated :: ".concat(e)),t.setAuth(e)}),this.axStkn=window.ls.get(V.tokenName,0),window.ls.on(V.tokenName,function(e){window.lgr.warn("Auth.vue :: New token value in local store :: ".concat(e)),t.keepTkn({token:e,ability:t.$ability})})},computed:Object(A["a"])({highLightAdmin:function(){return"admin"===this.$store.getters.accessLevel.toString()?"is-warning":""}},Object(N["c"])({jwt:"axsToken",isHere:"isActive",isKnown:"isAuthenticated",user:"nameUser",roles:"permissions",priv:"accessLevel"})),methods:Object(A["a"])({},Object(N["b"])(["keepTkn","logIn","logOut","setActivity","setAuth"]),{signOut:function(){this.logOut(),this.$router.push({name:"home"})},signIn:function(){this.logIn(),window.lgr.info("Auth.vue :: signin '[".concat(this.access,"]'"))}})},Fi=Mi,Bi=Fi,Ji=(n("5582"),Object(I["a"])(Bi,$i,Ri,!1,null,null,null));Ji.options.__file="Authentication.vue";var Qi=Ji.exports,Yi=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"navbar-item has-dropdown is-hoverable",on:{click:t.shutBurger}},[n("router-link",{staticClass:"navbar-item",attrs:{to:{name:"start"}}},[t._v("\n    Shop\n  ")]),n("div",{staticClass:"navbar-dropdown is-boxed"},[n("router-link",{staticClass:"navbar-item",style:t.canOpen("invoices/list"),attrs:{to:{name:"invoices/list"}}},[t._v("\n      Invoicing\n    ")]),n("router-link",{staticClass:"navbar-item",style:t.canOpen("products/list"),attrs:{to:{name:"products/list"}}},[t._v("\n      Products\n    ")]),n("router-link",{staticClass:"navbar-item",style:t.canOpen("start"),attrs:{to:{name:"start"},event:""}},[t._v("\n      Payment\n    ")]),n("router-link",{staticClass:"navbar-item",style:t.canOpen("start"),attrs:{to:{name:"start"}}},[t._v("\n      Bottle Returns\n    ")])],1)],1)},qi=[],Vi=(console.log,{methods:{canOpen:function(t){return this.$can("only_view",t)?"":"color: bisque;"},shutBurger:function(){E()}}}),zi=Vi,Gi=Object(I["a"])(zi,Yi,qi,!1,null,null,null);Gi.options.__file="Menu.vue";var Ki=Gi.exports,Wi=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"navbar-item has-dropdown is-hoverable",on:{click:t.shutBurger}},[n("router-link",{staticClass:"navbar-item",attrs:{to:{name:"start"}}},[t._v("\n    Admin\n  ")]),n("div",{staticClass:"navbar-dropdown is-boxed"},[n("router-link",{staticClass:"navbar-item",style:t.canOpen("persons/list"),attrs:{to:{name:"persons/list"}}},[t._v("\n      User Management\n    ")]),n("router-link",{staticClass:"navbar-item",style:t.canOpen("start"),attrs:{to:{name:"start"}}},[t._v("\n      Accounts Payable\n    ")]),n("router-link",{staticClass:"navbar-item",style:t.canOpen("start"),attrs:{to:{name:"start"}}},[t._v("\n      Accounts Receivable\n    ")])],1)],1)},Hi=[],Zi=(console.log,{methods:{canOpen:function(t){return this.$can("only_view",t)?"":"color: bisque;"},shutBurger:function(){E()}}}),Xi=Zi,to=Object(I["a"])(Xi,Wi,Hi,!1,null,null,null);to.options.__file="Menu.vue";var eo=to.exports,no=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"navbar-item has-dropdown is-hoverable",on:{click:t.shutBurger}},[n("router-link",{staticClass:"navbar-item",attrs:{to:{name:"start"}}},[t._v("\n    Tests\n  ")]),n("div",{staticClass:"navbar-dropdown is-boxed"},[n("router-link",{staticClass:"navbar-item",style:t.canOpen("start"),attrs:{to:{name:"start"}}},[t._v("\n      Emails\n    ")]),n("router-link",{staticClass:"navbar-item",style:t.canOpen("start"),attrs:{to:{name:"start"}}},[t._v("\n      Profile\n    ")]),n("router-link",{staticClass:"navbar-item",style:t.canOpen("protected"),attrs:{to:{name:"protected"}}},[t._v("\n      Protected\n    ")]),n("router-link",{staticClass:"navbar-item",style:t.canOpen("classified"),attrs:{to:{name:"classified"}}},[t._v("\n      Classified\n    ")])],1)],1)},so=[],ao=(console.log,{methods:{canOpen:function(t){return this.$can("only_view",t)?"":"color: bisque;"},shutBurger:function(){E()}}}),io=ao,oo=Object(I["a"])(io,no,so,!1,null,null,null);oo.options.__file="Menu.vue";var ro=oo.exports,co=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"navbar-item has-dropdown is-hoverable",on:{click:t.shutBurger}},[n("router-link",{staticClass:"navbar-item",attrs:{to:{name:"start"}}},[t._v("\n    Distributor\n  ")]),n("div",{staticClass:"navbar-dropdown is-boxed"},[n("router-link",{staticClass:"navbar-item",style:t.canOpen("start"),attrs:{to:{name:"start"}}},[t._v("\n      Sales\n    ")]),n("router-link",{staticClass:"navbar-item",style:t.canOpen("start"),attrs:{to:{name:"start"}}},[t._v("\n      Bonus\n    ")]),n("router-link",{staticClass:"navbar-item",style:t.canOpen("bottles/list"),attrs:{to:{name:"bottles/list"}}},[t._v("\n      Bottle Inventory\n    ")]),n("router-link",{staticClass:"navbar-item",style:t.canOpen("bottles/test"),attrs:{to:{name:"bottles/test"}}},[t._v("\n      Bottle test\n    ")])],1)],1)},lo=[],uo=(console.log,{methods:{canOpen:function(t){return this.$can("only_view",t)?"":"color: bisque;"},shutBurger:function(){E()}}}),mo=uo,vo=Object(I["a"])(mo,co,lo,!1,null,null,null);vo.options.__file="Menu.vue";var po=vo.exports,fo=console.log,bo={components:{Authentication:Qi,Shop:Ki,Admin:eo,Tests:ro,Distributor:po},data:function(){return{activeTab:0,logo:"".concat("/","img/WaterDrop_50.png")}},methods:{showTab:function(){return!0},shutBurger:function(){fo(E())}}},ho=bo,go=(n("52db"),Object(I["a"])(ho,Ni,Li,!1,null,"6d8c9212",null));go.options.__file="NavBar.vue";var Co=go.exports,wo=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"card-edge"},[n("div",{staticClass:"card"},[n("header",{staticClass:"card-header"},[t._m(0),n("div",{staticClass:"card-header-icon",attrs:{"aria-label":"more options"}},[n("button",{ref:"personsButton",class:t.PersonsButton.class,attrs:{id:"control-button"},on:{click:function(e){t.openShutPersons("toggle")}}},[n("span",{staticClass:"is-size-7"},[t._v(t._s(t.PersonsButton.text))])]),n("button",{ref:"CameraButton",class:t.CameraButton.class,attrs:{id:"control-button"},on:{click:function(e){t.openShutCamera("toggle")}}},[n("span",{staticClass:"is-size-7"},[t._v(t._s(t.CameraButton.text))])])])]),n("div",{staticClass:"card-content"},[n("nav",{staticClass:"level"},[n("div",{staticClass:"level-left"},[t._m(1),n("div",{staticClass:"level-item"},[n("autocomplete-input",{ref:"prsnPckr",attrs:{elemId:"person-picker",items:t.personPicker||null}})],1),t.autocompleteDirty?n("div",{staticClass:"level-item"},[n("a",{staticClass:"button is-small is-black is-inverted",on:{click:t.clearAutoComplete}},[t._m(2)])]):t._e()]),n("div",{staticClass:"level-right"})]),n("b-collapse",{ref:"collapsePersons",attrs:{open:!0}},[n("div",{attrs:{id:"scrollable-content"}},[n("virtual-scroller",{ref:"scroller",staticClass:"virtual-list",attrs:{items:t.items||[],"type-field":"type","item-height":"24","content-tag":"table","page-mode":""},scopedSlots:t._u([{key:"default",fn:function(e){return["chosen"===e.item.type?n("tr",{key:e.itemKey,staticClass:"chosen"},[n("td",{staticClass:"tag is-info persons",on:{click:function(n){t.picked(e)}}},[t._v("\n                      "+t._s(e.item.data.nombre)+" -  \n                      "),n("span",{staticClass:"italic"},[t._v("   "+t._s(e.item.data.email))])])]):t._e(),"person"===e.item.type?n("tr",{key:e.itemKey,staticClass:"person"},[n("td",{staticClass:"persons",on:{click:function(n){t.picked(e)}}},[t._v("\n                      "+t._s(e.item.data.nombre)+" -  \n                      "),n("span",{staticClass:"italic"},[t._v("   "+t._s(e.item.data.email))])])]):t._e()]}}])})],1)])],1),n("div",{staticClass:"columns"},[n("div",{staticClass:"column is-one-quarter",attrs:{id:"drag-column"}},[n("hr"),n("nav",{staticClass:"level"},[n("div",{staticClass:"tags has-addons level-item has-text-centered"},[n("span",{staticClass:"tag is-dark"},[t._v("nosotros")]),n("span",{staticClass:"tag is-outlined tag-inventory"},[n("strong",[t._v(t._s(t.currentUser.nombre||"_____"))])])])]),n("nav",{staticClass:"level"},[n("div",{staticClass:"level-item has-text-centered control is-small"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.newInventoryBottle,expression:"newInventoryBottle"}],staticClass:"input is-small",attrs:{disabled:!t.autocompleteDirty,type:"text",placeholder:"Codigo",id:"inp-esp-envase"},domProps:{value:t.newInventoryBottle},on:{keyup:function(e){if(!("button"in e)&&13!==e.keyCode)return null;t.addNewBottle("Inventory")},focus:function(e){t.closeError(t.UNKNOWN_BOTTLE_ERROR)},input:function(e){e.target.composing||(t.newInventoryBottle=e.target.value)}}})]),n("p",{staticClass:"level-item has-text-centered control is-small"},[n("a",{staticClass:"button is-small",attrs:{disabled:!t.autocompleteDirty,id:"butt-add-inventory-bottle"},on:{click:function(e){t.addNewBottle("Inventory")}}},[t._m(3)])])]),n("div",{staticClass:"container scrollable-container"},[n("Container",{attrs:{"group-name":"1","get-child-payload":t.inventoryPayload,"should-accept-drop":t.shouldAcceptInventory},on:{drop:function(e){t.onDrop("inventory",e)}}},t._l(t.inventory,function(e){return n("Draggable",{key:e.id},[n("div",{class:e.props.className,style:e.props.style,attrs:{id:e.id}},[t._v("\n                    "+t._s(e.data)+"\n                  ")])])}))],1)]),n("div",{staticClass:"column is-one-quarter",attrs:{id:"drag-column"}},[n("hr"),t._m(4),n("div",{staticClass:"trashBin"},[n("nav",{staticClass:"level"},[n("div",{staticClass:"level-item has-text-centered"},[n("Container",{attrs:{"group-name":"1","should-accept-drop":t.shouldTrash},on:{drop:function(e){t.onDrop("trash",e)}}},[n("Draggable",{staticClass:"icon is-invisible"},[n("i",{staticClass:"far fa-trash-alt"})]),n("Draggable",{staticClass:"icon"},[n("i",{staticClass:"far fa-trash-alt"})])],1)],1)])]),n("div",{staticClass:"container scrollable-container"},[n("Container",{attrs:{"group-name":"1","get-child-payload":t.exchangePayload,"should-accept-drop":t.shouldAcceptExchange},on:{drop:function(e){t.onDrop("exchange",e)}}},t._l(t.exchange,function(e){return n("Draggable",{key:e.id},[n("div",{class:e.props.className,style:e.props.style,attrs:{id:e.id}},[t._v("\n                    "+t._s(e.data)+"\n                  ")])])}))],1),n("nav",{staticClass:"level"},[n("div",{staticClass:"level-item has-text-centered control is-small is-primary"},[n("a",{staticClass:"button is-small is-warning",attrs:{disabled:!t.autocompleteDirty,id:"butt-save-moves"},on:{click:t.saveMovements}},[t._m(5)])])])]),n("div",{staticClass:"column is-one-quarter",attrs:{id:"drag-column"}},[n("hr"),n("nav",{staticClass:"level"},[n("div",{staticClass:"tags has-addons level-item has-text-centered"},[n("span",{staticClass:"tag is-dark"},[t._v("cliente")]),n("span",{staticClass:"tag is-outlined tag-customer"},[n("strong",[t._v(t._s(t.personChosen.nombre||"_____"))])])])]),n("nav",{staticClass:"level"},[n("div",{staticClass:"level-item has-text-centered control is-small"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.newCustomerBottle,expression:"newCustomerBottle"}],staticClass:"input is-small",attrs:{disabled:!t.autocompleteDirty,type:"text",placeholder:"Codigo",id:"inp-esp-envase"},domProps:{value:t.newCustomerBottle},on:{keyup:function(e){if(!("button"in e)&&13!==e.keyCode)return null;t.addNewBottle("Customer")},focus:function(e){t.closeError(t.UNKNOWN_BOTTLE_ERROR)},input:function(e){e.target.composing||(t.newCustomerBottle=e.target.value)}}})]),n("p",{staticClass:"level-item has-text-centered control is-small"},[n("a",{staticClass:"button is-small",attrs:{disabled:!t.autocompleteDirty,id:"butt-add-customer-bottle"},on:{click:function(e){t.addNewBottle("Customer")}}},[t._m(6)])])]),n("div",{staticClass:"container scrollable-container"},[n("Container",{attrs:{"group-name":"1","get-child-payload":t.customerPayload,"should-accept-drop":t.shouldAcceptCustomer},on:{drop:function(e){t.onDrop("customer",e)}}},t._l(t.customer,function(e){return n("Draggable",{key:e.id},[n("div",{class:e.props.className,style:e.props.style,attrs:{id:e.id}},[t._v("\n                    "+t._s(e.data)+"\n                  ")])])}))],1)])]),n("div",{staticClass:"card-image"},[t._l(t.errors,function(e){return n("div",{staticClass:"alert alert-danger",attrs:{role:"alert"}},[n("b-notification",{attrs:{type:"is-danger"}},[t._v("\n              "+t._s(e)+"\n            ")])],1)}),n("b-collapse",{ref:"collapseCamera",attrs:{open:!0}})],2),t._m(7),n("p",[t._v("currentUser: "+t._s(t.currentUser.id)+"\n               Bottles: "+t._s(t.currentUser.bottles&&t.currentUser.bottles.length)+" ")]),n("p",[t._v("personChosen: "+t._s(t.personChosen.id)+"\n                Bottles: "+t._s(t.personChosen.bottles&&t.personChosen.bottles.length)+" ")])])])])},_o=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("p",{staticClass:"card-header-title"},[n("span",{staticClass:"is-size-7"},[t._v("Traspaso de Envases")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"level-item"},[n("div",{staticClass:"is-small"},[t._v("Nombre de Persona")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",{staticClass:"icon is-small"},[n("i",{staticClass:"far fa-trash-alt"})])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",{staticClass:"is-size-7"},[n("strong",[t._v("Especificar Envase")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("nav",{staticClass:"level"},[n("div",{staticClass:"tags level-item has-text-centered"},[n("span",{staticClass:"tag is-dark"},[t._v("Intercambio")])])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",{staticClass:"is-size-7"},[n("strong",[t._v("Grabar Movimientos")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",{staticClass:"is-size-7"},[n("strong",[t._v("Especificar Envase")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("footer",{staticClass:"card-footer"},[n("a",{staticClass:"card-footer-item",attrs:{href:"#"}},[t._v("Save")]),n("a",{staticClass:"card-footer-item",attrs:{href:"#"}},[t._v("Edit")]),n("a",{staticClass:"card-footer-item",attrs:{href:"#"}},[t._v("Delete")])])}],yo=(n("55dd"),n("ca49")),xo=n("2909"),Oo=function(t,e){var n=e.removedIndex,s=e.addedIndex,a=e.payload;if(null===n&&null===s)return t;var i=Object(xo["a"])(t),o=a;return null!==n&&(o=i.splice(n,1)[0]),null!==s&&i.splice(s,0,o),i},ko=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("QrcodeReader",{on:{decode:t.onDecode,init:t.onInit}},[n("div",{staticClass:"decoded-content"},[t._v(t._s(t.content))]),n("LoadingIndicator",{directives:[{name:"show",rawName:"v-show",value:t.loading,expression:"loading"}]})],1)},Do=[],Eo=n("9a3e"),Po=(n("96cf"),n("1da1")),So=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"loading-indicator"},[t._v("\n  Loading...\n")])},Io=[],jo=(n("6101"),{}),To=Object(I["a"])(jo,So,Io,!1,null,null,null);To.options.__file="LoadingIndicator.vue";var Ao=To.exports,No=console.log,Lo={components:{LoadingIndicator:Ao},data:function(){return{loading:!1}},methods:{onInit:function(){var t=Object(Po["a"])(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.loading=!0,t.prev=1,t.next=4,e;case 4:this.$emit("success"),t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](1),"NotAllowedError"===t.t0.name?this.$emit("error","To detect and decode QR codes this page needs access to your camera"):"NotFoundError"===t.t0.name?this.$emit("error","Seems like you have no suitable camera on your device."):"NotSupportedError"===t.t0.name?this.$emit("error","Seems like this page is served in non-secure context. Your browser doesn't support that"):"NotReadableError"===t.t0.name?this.$emit("error","Couldn't access your camera. Is it already in use?"):"OverconstrainedError"===t.t0.name?this.$emit("error","Constraints don't match any installed camera. Did you asked for the front camera although there is none?"):(this.$emit("error","UNKNOWN ERROR: ".concat(t.t0.message)),No(t.t0));case 10:return t.prev=10,this.loading=!1,t.finish(10);case 13:case"end":return t.stop()}},t,this,[[1,7,10,13]])}));return function(e){return t.apply(this,arguments)}}()}},$o={components:{QrcodeReader:Eo["QrcodeReader"]},mixins:[Lo],data:function(){return{content:""}},methods:{onDecode:function(t){this.content=t}}},Ro=$o,Uo=(n("7b60"),Object(I["a"])(Ro,ko,Do,!1,null,"90722470",null));Uo.options.__file="Decoder.vue";var Mo=Uo.exports,Fo=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("label",{staticClass:"file-select"},[n("div",{staticClass:"select-button"},[t.value?n("span",[t._v("Selected File: "+t._s(t.value.name))]):n("span",[t._v("Select File")])]),n("input",{attrs:{type:"file"},on:{change:t.handleFileChange}})])},Bo=[],Jo={name:"awesomplete",data:function(){return{model:"",awesomplete:{}}},props:{placeholder:{default:"",type:String,required:!1},list:{default:"",type:Array,required:!0},classes:{default:String,type:String,required:!1}},mounted:function(){var t=this,e=this;this.$nextTick(function(){t.awesomplete=new Es.a(e.$refs.awesomplete,{minChars:3,maxItems:5,list:t.list}),t.$refs.awesomplete.focus()})}},Qo=Jo,Yo=Object(I["a"])(Qo,Fo,Bo,!1,null,null,null);Yo.options.__file="BaseInputText.vue";var qo=Yo.exports,Vo=(n("f5766"),n("bc3a")),zo=n.n(Vo),Go=V.dbServerProtocol,Ko=V.dbServerURI,Wo=V.databaseName,Ho=console.log;console.error;if(Ho("PouchDb configuration...\n  ".concat(JSON.stringify(V,null,2),"\n")),!Go)throw new Error("VuePouchDB Error → remote database server protocol is required!");if(!Ko)throw new Error("VuePouchDB Error → remote database server URI is required!");if(!Wo)throw new Error("VuePouchDB Error → a main database name is required!");var Zo=function(t){var e=t.state.categoryCounts,n=Object.keys(e),s=!0;if(n.forEach(function(t){window.lgr.debug("Category ".concat(t," ").concat(e[t].total," ").concat(e[t].loaded)),e[t].total>e[t].loaded&&(s=!1)}),window.lgr.debug("Category load levels available? - ".concat(s)),s)return window.lgr.debug("Category counts : ".concat(JSON.stringify(t.state.categoryCounts,null,2),"}")),void t.commit("setCategoriesLoading",!0);window.lgr.debug("Getting category loads state"),t.commit("setCategoriesLoading",!1);var a=t.getters.getDbMgr,i={};a.allDocs({include_docs:!0}).then(function(e){e.rows.forEach(function(t){if(t.doc.data){var e=t.doc.data;n.includes(e.type)&&(i[e.type]=i[e.type]?i[e.type]+=1:1,window.lgr.debug("Counts values :: ".concat(JSON.stringify(i,null,2))))}}),window.lgr.debug("Counts values :: ".concat(JSON.stringify(i,null,2))),Object.keys(i).forEach(function(e){window.lgr.debug("Count ".concat(e," ").concat(i[e]," ")),t.commit("setCategoryLoadedCount",{key:e,value:i[e]})});var s=t.state.categoryCounts,a=Object.keys(s).filter(function(t){return s[t].total<1||s[t].total>s[t].loaded});a.length<1&&t.commit("setCategoriesLoading",!0),window.lgr.debug("Category counts : ".concat(JSON.stringify(t.state.categoryCounts,null,2),"}"))}).catch(function(t){window.lgr.error("".concat(t,"\n      QQQQQQQQQQQQQQQQQQQQ got nothing QQQQQQQQQQQQQQQQQQQQ"))})},Xo=function(t){if(window.lgr.debug("Getting category counts ".concat(JSON.stringify(t.rootState.Auth,null,2))),!(t.rootGetters.isAuthenticated<1)){var e=t.state,n=e.user,s=e.srvr,a=e.categoryCounts,i=Object.keys(a),o=!0;if(i.forEach(function(t){window.lgr.debug("Category ".concat(t," ").concat(a[t].total," ").concat(a[t].loaded)),a[t].total<1&&(o=!1)}),window.lgr.debug("Category totals available? - ".concat(o)),o)Zo(t);else{t.commit("setCategoriesLoading",!1);var r=s.databaseName,c="".concat(s.dbServerProtocol,"://").concat(s.dbServerURI,"/"),l="".concat(r,"/_design/visible/_view");window.lgr.info("Getting category totals :: ".concat(n.name," ").concat(c).concat(l));var u=[];i.forEach(function(t){u.push(zo.a.get("".concat(c).concat(l,"/count_").concat(t),{auth:{username:n.name,password:n.password},method:"get"}).then(function(e){if(200===e.status){var n=e.data.rows[0].value;return window.lgr.debug("Got '".concat(t,"' category count ").concat(JSON.stringify(n,null,2))),{key:t,value:n}}return window.lgr.error("* ERROR COUNTING PRODUCTS * ".concat(JSON.stringify(e,null,2),"}")),null}).catch(function(t){window.lgr.error("Axios connexion error :: ".concat(JSON.stringify(t.response.data,null,2),"}"))}))}),Promise.all(u).then(function(e){window.lgr.debug("CATEGORIES: ".concat(JSON.stringify(e,null,2),"}"));var n={};e.forEach(function(t){n[t.key]={total:t.value,loaded:0}}),window.lgr.debug("Items per category : ".concat(JSON.stringify(n,null,2),"}")),t.commit("setCategoryCounts",n),window.lgr.debug("Category counts : ".concat(JSON.stringify(t.state.categoryCounts,null,2),"}")),Zo(t)})}}},tr={user:{name:null,password:null},dbMgr:"asdf",categoryCounts:{product:{total:0,loaded:0},person:{total:0,loaded:0},bottle:{total:0,loaded:0},invoice:{total:0,loaded:0}},categoriesLoading:!1,srvr:{dbServerProtocol:Go,dbServerURI:Ko,databaseName:Wo}},er={getUserCredentials:function(t){return t.user},getDbMgr:function(t){return t.dbMgr},getCategoriesLoading:function(t){return t.categoriesLoading},getCategoryCounts:function(t){return t.categoryCounts},getCategoryCounters:function(t){return t.categoryCounters}},nr={setUserCredentials:function(t,e){window.lgr.debug('Database (mutation) :: recording new user credentials "'.concat(e.name,'"')),t.user=e},setDbMgr:function(t,e){window.lgr.debug("Database (mutation) :: recording database manager "),t.dbMgr=e},setCategoriesLoading:function(t,e){window.lgr.debug('Database (mutation) :: setting categoriesLoading "'.concat(JSON.stringify(e,null,2),'"')),t.categoriesLoading=e},setCategoryCounts:function(t,e){window.lgr.debug('Database (mutation) :: recording categoryCounts "'.concat(JSON.stringify(e,null,2),'"')),t.categoryCounts=e},setCategoryLoadedCount:function(t,e){window.lgr.debug('Database (mutation) :: recording categoryCount "'.concat(JSON.stringify(e,null,2),'"')),t.categoryCounts[e.key].loaded=e.value,window.lgr.debug('Database (mutation) :: recorded "'.concat(JSON.stringify(t.categoryCounts,null,2),'"'))}},sr={setUserCredentials:function(t,e){if(e.payload.couchdb){var n=e.payload.couchdb;window.lgr.debug("Database (action) :: recording new user credentials > ".concat(JSON.stringify(e.payload,null,2))),window.lgr.debug(n),t.commit("setUserCredentials",n)}},connectToRemoteService:function(t,e){window.lgr.debug("\n\n      Connext to remote service >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>\n    "),window.lgr.debug(e),window.lgr.debug(t);var n=t.state,s=n.user,a=n.srvr,i=n.dbMgr;i.setMaxListeners(20);var o=a.databaseName,r="".concat(a.dbServerProtocol,"://").concat(s.name,":").concat(s.password,"@").concat(a.dbServerURI,"/").concat(a.databaseName),c=new R["a"](r,{skip_setup:!0}),l={},u=[{type:"view",name:"visible/compact_invoice"},{type:"view",name:"visible/compact_bottle"},{type:"view",name:"visible/compact_person"},{type:"view",name:"visible/compact_product"}];u.forEach(function(e){var n={live:!0,retry:!0};n[e.type]=e.name,i.replicate.from(c,n).on("change",function(n){window.lgr.info("".concat(o,"/").concat(e.name," ***  INCOMING REPLICATION DELTA **** read: ").concat(n.docs_read," wrote: ").concat(n.docs_written)),"ddocs/this_ddoc"===e.name&&window.lgr.debug(n),window.lgr.info("Replication from: ".concat(n.docs.length," records.")),n.docs.forEach(function(t){l[t.data.type]||(l[t.data.type]=0),l[t.data.type]+=1}),Object.keys(l).forEach(function(e){var n=l[e];window.lgr.debug("Count ".concat(e," ").concat(n," ")),t.commit("setCategoryLoadedCount",{key:e,value:n});var s="".concat(e,"/setDirtyData");try{t.dispatch(s,n,{root:!0}),window.lgr.debug("Dispatched ".concat(s," with ").concat(n," for ").concat(e,"."))}catch(t){window.lgr.warn("Action ".concat(s," not found."))}}),window.lgr.debug("'from' counts by type : ".concat(JSON.stringify(l,null,2)))}).on("paused",function(){window.lgr.info("".concat(o,"/").concat(e.name," **********  INCOMING REPLICATION ON HOLD *********")),t.dispatch("collectCategoryCounts")}).on("active",function(){window.lgr.info("".concat(o,"/").concat(e.name," **********  INCOMING REPLICATION RESUMED *********"))}).on("denied",function(t){window.lgr.info("".concat(o,"/").concat(e.name," **********  INCOMING REPLICATION DENIED ********* ").concat(t))}).on("error",function(t){return window.lgr.error("".concat(o,"/").concat(e.name," INCOMING REPLICATION FAILURE ************ ").concat(t))})});var d="ExchangeRequest",m=function(t){return t._id.substring(0,15)===d},v={live:!0,retry:!0,filter:m};i.replicate.to(c,v).on("change",function(t){window.lgr.info("".concat(o,"/").concat(d," **********  OUTGOING REPLICATION DELTA ********* "));var e=t.change.docs.filter(function(t){return!t.data||"person"!==t.data.type&&"bottle"!==t.data.type});e.forEach(function(t){window.lgr.debug("DOC :: ".concat(JSON.stringify(t,null,2)))})}).on("paused",function(){window.lgr.info("".concat(o,"/").concat(d," **********  OUTGOING REPLICATION ON HOLD ********* ").concat(s.name)),i.allDocs({include_docs:!0,attachments:!0}).then(function(t){window.lgr.debug("allDocs fetch result ".concat(JSON.stringify(t,null,2)))}).catch(function(t){window.lgr.error("allDocs fetch failure ".concat(t))})}).on("active",function(){window.lgr.info("".concat(o,"/").concat(d," **********  OUTGOING REPLICATION RESUMED *********"))}).on("denied",function(t){window.lgr.info("".concat(o,"/").concat(d," **********  OUTGOING REPLICATION DENIED ********* ").concat(t))}).on("error",function(t){return window.lgr.error("".concat(o,"/").concat(d," OUTGOING REPLICATION FAILURE ************ ").concat(t))})},collectCategoryCounts:function(t){Xo(t)},rememberDbMgr:function(t,e){window.lgr.debug("\n\n      Remember DB manager >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>\n      ".concat(JSON.stringify(e,null,2),"\n    ")),t.commit("setDbMgr",e.dbmgr)}},ar=function(t,e){return(t+e).substring(e.length)},ir=function(){var t=new Date,e="";e+=t.getFullYear(),e+=ar("00",(1+t.getMonth()).toString()),e+=ar("00",t.getDate().toString()),e+=ar("00",t.getHours().toString()),e+=ar("00",t.getMinutes().toString()),e+=ar("00",t.getSeconds().toString());var n=parseInt("".concat(e),10);return n};function or(){var t=ir();return or.old=t>or.old?t:or.old+=1,or.old}function rr(){return or()}or.old=0;var cr=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"_";return"".concat(rr()).concat(e).concat(t.toString().padStart(5,"0"))},lr={namespaced:!0,state:tr,getters:er,mutations:nr,actions:sr},ur=console.log,dr=console.error,mr=function(t){var e=t;ur("\n    uuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuu");var n=new RegExp("^.*","gi");return e.liveFeedStatus="finding",ur("Searching with: ".concat(n)),e.$pouch.liveFind({selector:{"data.type":"person","data.nombre":{$regex:n}},sort:["data.type","data.nombre"]}).on("update",function(t,n){var s=t;e.getItems(s)}).on("ready",function(){ur("###############   Initial query complete.   ##############"),e.liveFeedStatus="listening"}).on("cancelled",function(){ur("###############   LiveFind cancelled.   ##############"),e.liveFeedStatus="idle"}).on("error",function(t){dr("Oh no!",t)})},vr=[],pr="Lista de Envases",fr={class:"button is-small is-info",text:"Ver Personas"},br={class:"button is-small is-info is-outlined",text:"Esconder Personas"},hr={class:"button is-small is-info",text:"Ver QR"},gr={class:"button is-small is-info is-outlined",text:"Esconder QR"},Cr=99999999,wr={id:Cr,data:"Rastrear envases aqui\n  ",src:"",props:{className:"card",style:{marginLeft:"10px",marginRight:"10px",marginTop:"10px",paddingTop:"20px",backgroundColor:"#fffff0",textAlign:"center"}}},_r=function(t,e){t.map(function(t,n){return e.includes(t.id)?n:-1}).sort(function(t,e){return-1*(t-e)}).forEach(function(e){return t.splice(e,1)}),t.findIndex(function(t){return t.id===Cr})<0&&t.push(wr)},yr="Error: Envase desconocido!",xr={name:"bottle-tasks",data:function(){return{thoseChosen:[],personChosen:{name:null,id:"------",bottles:[]},selectedDemo:"qrDecode",PersonsButton:br,CameraButton:gr,autocompleteDirty:!1,personPicker:{list:[],data:function(t){return{label:"[".concat(t.pos,"] ").concat(t.label),value:t.pos}}},items:vr,inwardOutward:"Recibir de",newCustomerBottle:"",newInventoryBottle:"",PLACEMARKER:pr,UNKNOWN_BOTTLE_ERROR:yr,bottles:[pr],errors:[],currentUser:{id:null,bottles:[]},inventory:[],customer:[],exchange:[wr],trash:[wr],fruits:[{codigo:101,nombre:"Apple"},{codigo:102,nombre:"Banana"},{codigo:103,nombre:"Orange"},{codigo:104,nombre:"Mango"},{codigo:105,nombre:"Pear"},{codigo:106,nombre:"Peach"},{codigo:107,nombre:"Grape"},{codigo:108,nombre:"Tangerine"},{codigo:109,nombre:"Pineapple"}]}},methods:{personPicked:function(){var t=this;this.$nextTick(function(){ur("%%%%%%%%%%%%%%%% person picked %%%%%%%%%%%%%%%%%% "),ur(t.$refs.prsnPckr.$el),ur(t.$refs.prsnPckr.$el._value-1);var e=t.$refs.prsnPckr.$el._value-1;ur(e);var n=Object(g["cloneDeep"])(t.items[e]);ur(t.items[e].data.nombre),ur(n.data.nombre),ur(Object(g["cloneDeep"])(t.items[e]).data.nombre),t.$refs.prsnPckr.$el.value=n.data.nombre,t.picked({itemIndex:e})})},clearAutoComplete:function(){var t=this;this.autocompleteDirty=!1,this.thoseChosen.forEach(function(e){t.items[e].type="person"}),this.$refs.prsnPckr.$el.value="",this.personChosen.bottles=[],this.personChosen.nombre=null,this.customer=[],this.exchange=[],this.exchange.push(wr),this.openShutPersons("open")},addNewBottle:function(t){var e=this;ur("%%%%%%%%%%%%%%%% add new bottle %%%%%%%%%%%%%%%%%% ");var n=this["new".concat(t,"Bottle")].toUpperCase();ur(this.inventory),ur(this.customer),ur(this.exchange),this.$pouch.find({selector:{"data.type":"bottle","data.codigo":n}}).then(function(s){if(s.docs.length<1)return e.openError(yr),void(e["new".concat(t,"Bottle")]=null);var a=e.inventory.filter(function(t){return t.data===n}),i=e.customer.filter(function(t){return t.data===n}),o=Object(Pt["a"])(s.docs,1),r=o[0];if(a.length>0){var c=Object(Pt["a"])(a,1);r=c[0],ur("move from inventory ".concat(JSON.stringify(a,null,2))),e.inventory=e.inventory.filter(function(t){return t!==a[0]})}else if(i.length>0){var l=Object(Pt["a"])(i,1);r=l[0],ur("move from customer ".concat(JSON.stringify(i,null,2))),e.customer=e.customer.filter(function(t){return t!==i[0]})}else ur("add to exchange ".concat(JSON.stringify(r,null,2))),r={id:parseInt(r.data.id,10),data:r.data.codigo,src:"#".concat(t.slice(0,1)),props:{className:"draggable-item draggable-".concat(t.toLowerCase()," dashed"),style:{textAlign:"center",backgroundColor:"Inventory"===t?"#c0ebfd":"#f0fff0"}}};e.exchange.push(r),e.exchange=e.exchange.filter(function(t){return 99999999!==t.id})}).catch(function(t){e.openError("Error: Búsqueda fallida! (".concat(t,")"))}),this.bottles[0]===this.PLACEMARKER?this.bottles.splice(0,1,n):this.bottles.push(n)},saveMovements:function(){var t=this;ur("%%%%%%%%%%%%%%%% save movements %%%%%%%%%%%%%%%%%% ");var e=parseInt(this.personChosen.idib,10),n=parseInt(this.currentUser.id,10),s="ExchangeRequest",a=this.exchange.filter(function(t){return t.src.match(/C/)}),i=a.map(function(t){return t.id}),o=this.exchange.filter(function(t){return t.src.match(/I/)}),r=o.map(function(t){return t.id});if(i.length>0){var c=this.$pouch.rel.makeDocID({type:s,id:cr(e,"I")}),l=this.$pouch.rel.parseDocID(c),u={_id:c,data:{id:l.id,type:s,inOut:"in",status:"new",bottles:i,customer:e,inventory:n}};ur("movement in ".concat(JSON.stringify(u,null,2))),this.$pouch.put(u).then(function(e){ur("---------- Saved movement IN --------"),_r(t.exchange,i),a.forEach(function(e){return t.inventory.push(e)}),a.length=0,ur(e)})}if(r.length>0){var d=this.$pouch.rel.makeDocID({type:s,id:cr(e,"O")}),m=this.$pouch.rel.parseDocID(d),v={_id:d,data:{id:m.id,type:s,status:"new",inOut:"out",bottles:r,customer:e,inventory:n}};ur("movement out ".concat(JSON.stringify(v,null,2))),this.$pouch.put(v).then(function(e){ur("---------- Saved movement OUT --------"),_r(t.exchange,r),o.forEach(function(e){return t.customer.push(e)}),o.length=0,ur(e)})}this.$pouch.rel.find("Movement").then(function(t){ur("wwwwwwwwwwwwwwwww Result wwwwwwwwwwwwwww"),ur(t)})},dropBottle:function(t){this.bottles.splice(this.bottles.indexOf(t),1)},dropBottles:function(){this.bottles=[this.PLACEMARKER]},openShutPersons:function(t){var e=this.$refs.collapsePersons.isOpen;switch(this.$refs.personsButton.blur(),t){case"open":if(e)return void(this.PersonsButton=br);break;case"shut":if(!e)return void(this.PersonsButton=fr);break;default:}this.PersonsButton=e?fr:br,this.$refs.collapsePersons.toggle()},openShutCamera:function(t){var e=this.$refs.collapseCamera.isOpen;switch(this.$refs.CameraButton.blur(),t){case"open":if(e)return void(this.CameraButton=gr);break;case"shut":if(!e)return void(this.CameraButton=hr);break;default:}this.CameraButton=e?hr:gr,this.$refs.collapseCamera.toggle()},onDrop:function(t,e){this[t]=Oo(this[t],e),"exchange"===t&&(ur("onDrop"),this.exchange.length>1?this.exchange=this.exchange.filter(function(t){return 99999999!==t.id}):this.exchange.length<1&&this.exchange.push(wr),ur(e))},inventoryPayload:function(t){return this.inventory[t]},exchangePayload:function(t){return this.exchange[t]},customerPayload:function(t){return this.customer[t]},trashPayload:function(t){return this.trash[t]},shouldAcceptCustomer:function(t,e){return ur("shouldAcceptCustomer"),ur(e),"C"===e.src&&this.autocompleteDirty},shouldAcceptInventory:function(t,e){return ur("shouldAcceptInventory"),ur(e),"I"===e.src&&this.autocompleteDirty},shouldAcceptExchange:function(t,e){return ur("shouldAcceptExchange"),ur(e),this.autocompleteDirty},shouldTrash:function(t,e){return ur("shouldTrash"),ur(e.src),"#"===e.src.slice(0,1)},picked:function(t){var e=this;ur("picked ".concat(JSON.stringify(t,null,2))),ur(t);var n=Object(g["cloneDeep"])(this.items[t.itemIndex]);if(this.autocompleteDirty=!0,this.personChosen.nombre===n.data.nombre)this.personChosen.nombre=null,this.items[t.itemIndex].type="person",this.thoseChosen=[],this.openShutPersons("open");else{this.thoseChosen.forEach(function(t){e.items[t].type="person"}),this.thoseChosen.push(t.itemIndex),this.items[t.itemIndex].type="chosen",this.personChosen=n.data,this.$refs.prsnPckr.setValue(this.personChosen.nombre);var s=parseInt(this.personChosen.idib,10),a=this.$pouch.rel.makeDocID({type:"aPerson",id:s});ur(a),this.$pouch.liveFind({selector:{_id:{$eq:a}}}).on("update",function(){ur("~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ Chosen User Updated ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~"),e.$pouch.rel.find("aPerson",s).then(function(t){ur("\n              !!!!!!!!!!!!!!!!  [ picked ]  !!!!!!!!!!!!!!!!!!\n              ".concat(JSON.stringify(e.personChosen,null,2),"\n              ")),ur(t),t.allBottles?(e.customer=t.allBottles.filter(function(e){return t.allPersons[0].bottles.includes(e.id)}).map(function(t){return{id:t.id,data:t.codigo,src:"C",props:{className:"draggable-item draggable-customer ",style:{backgroundColor:"#f0fff0",textAlign:"center"}}}}),ur(e.personChosen)):(e.personChosen.bottles=[],e.customer=[])})}),this.$refs.collapsePersons.toggle(),this.openShutPersons("shut")}},getItems:function(t){var e=null,n=null,s=null,a=null,i=null;switch(t.action){case"REMOVE":ur("###############   LiveFind remove not implemented   ##############");break;case"UPDATE":a=this.$pouch.rel.parseDocID(t.id).id.toString(),e=this.items.findIndex(function(t){return t.data.idib==a}),ur("###############   LiveFind update   ##############"),i=t.doc.data,this.items[e]?this.items[e].data=i:ur("?????????????????????????????????????????????????????????????????????\n              What is wrong with ".concat(JSON.stringify(this.items,null,2),"\n              ?????????????????????????????????????????????????????????????????????")),s=i.codigo,n=this.personPicker.list.findIndex(function(t){return t.value===s});try{this.personPicker.list[n-1].value=s,this.personPicker.list[n-1].label=i.nombre}catch(t){ur("Unexpected missing list item in personPicker\n              pouchData.doc.data.codigo :: ".concat(s,"\n              personPicker.list :: ").concat(n))}break;default:this.items.push({type:"person",data:t.doc.data}),this.personPicker.list.push({pos:this.personPicker.list.length+1,value:t.doc.data.codigo,label:t.doc.data.nombre})}},openError:function(t){this.errors.push(t)},closeError:function(t){var e=this.errors.indexOf(t);this.errors.splice(e,1)},clearErrors:function(){this.errors=[]}},created:function(){this.liveFeed=mr(this)},mounted:function(){var t=this;ur("!!!!!!!!!!!!!!!! mounted !!!!!!!!!!!!!!!!!!"),Z.start(this.$loading),this.$store.watch(function(t){return t.dbmgr.categoriesLoading},Z.kill),this.currentUser.id=parseInt(this.$store.state.dbmgr.user.name,10),ur(this.currentUser);var e=this.$pouch.rel.makeDocID({type:"aPerson",id:this.currentUser.id});ur(e),this.$pouch.liveFind({selector:{_id:{$eq:e}}}).on("update",function(){ur("~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ Current User Updated ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~"),t.$pouch.rel.find("aPerson",t.currentUser.id).then(function(e){ur(e),ur(e.allPersons),ur(e.allPersons.length),e.allPersons&&e.allPersons.length>0&&(t.currentUser.bottles=e.allBottles.filter(function(t){return e.allPersons[0].bottles.includes(t.id)}),t.currentUser.nombre=e.allPersons[0].nombre,t.inventory=t.currentUser.bottles.map(function(t){var e={id:t.id,data:t.codigo,src:"I",props:{className:"draggable-item draggable-inventory ",style:{backgroundColor:"#c0ebfd",textAlign:"center"}}};return e}),ur(t.currentUser))})})},components:{Container:yo["Container"],Draggable:yo["Draggable"],qrDecode:Mo,"autocomplete-input":Ns,"base-input":qo},watch:{selectedDemo:"clearErrors"},computed:{draggableItemStyle:function(t,e){return ur("\n        !!!!!!!!!!!!!!!! draggableItemStyle !!!!!!!!!!!!!!!!!!\n        "),ur(t),ur(e),"draggable-item draggable-customer"}}},Or=xr,kr=Or,Dr=(n("f72f"),Object(I["a"])(kr,wo,_o,!1,null,"58bbbfdf",null));Dr.options.__file="BottleTasks.vue";var Er=Dr.exports,Pr=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t._v("help text !!")])},Sr=[],Ir={},jr=Object(I["a"])(Ir,Pr,Sr,!1,null,null,null);jr.options.__file="BottleTasksHelper.vue";var Tr=jr.exports,Ar=console.log,Nr=[{path:"",name:"home",components:{nav_bar:Co,default:Er,helper:Tr}}],Lr={namespaced:!0,state:{personChosen:"escoger",resetList:!1},getters:{personChosen:function(t){return t.personChosen},resetList:function(t){return t.resetList}},mutations:{setChosenPerson:function(t,e){Ar("Set chosen to - ".concat(e)),t.personChosen=e},toggleDirty:function(t){Ar("Toggle dirty from - ".concat(t.resetList)),t.resetList=!t.resetList}},actions:{choosePerson:function(t,e){Ar("Choosing - ".concat(e)),t.commit("setChosenPerson",e)},unChooseAll:function(t){Ar("UN Choosing"),t.commit("toggleDirty")}}},$r=n("14b7"),Rr=n.n($r),Ur=console.log,Mr=function(t){var e=Rr.a.decode(t);return Ur(e),e},Fr=Mr,Br=1,Jr=0,Qr=1,Yr=0,qr="no token",Vr=console.log,zr={accessToken:qr,accessExpiry:null,active:Jr,authenticated:Yr,nameUser:"",permissions:"",accessLevel:""},Gr={axsToken:function(t){return t.accessToken},isActive:function(t){return t.active},isAuthenticated:function(t){return t.authenticated},nameUser:function(t){return t.nameUser},accessExpiry:function(t){return t.accessExpiry},accessLevel:function(t){return t.accessLevel},permissions:function(t){return t.permissions}},Kr={saveToken:function(t,e){var n=e.token,s=e.payload;s&&(window.lgr.info("Auth(mutation) => Saving jwt. Permissions :: [".concat(s.permissions,"]")),Vr(s.permissions),Vr(t),window.ls.set(V.tokenName,n),t.accessToken=n,t.nameUser=s.name,t.permissions=s.permissions,t.accessExpiry=s.exp,t.accessLevel="Iridium Blue"===t.nameUser?"admin":"user",window.ls.set(V.authName,Qr),t.authenticated=Qr,window.ls.set(V.activityName,Qr),t.active=Br)},toSignedOut:function(t){window.lgr.warn("Auth(mutation) :: Requesting to sign out here"),window.ls.set(V.tokenName,null),t.accessToken=""},activity:function(t,e){window.lgr.warn("Auth(mutation) :: Changing activity state"),t.active=e,window.ls.set(V.activityName,e)},auth:function(t,e){window.lgr.warn("Auth(mutation) :: Changing authentication state"),t.authenticated=e,window.ls.set(V.authName,e)}},Wr={keepTkn:function(t,e){var n=e.token,s=e.ability,a=Rr.a.decode(n);a&&(t.dispatch("dbmgr/setUserCredentials",{payload:a}),t.dispatch("dbmgr/connectToRemoteService",{payload:a}),t.dispatch("a12n/resetPermissions",{payload:a,ability:s}),t.commit("saveToken",{token:n,payload:a}))},refreshToken:function(t,e){var n=e,s=qr;Vr("--------------  VALIDATE TOKEN ------------------"),Vr("pyld"),Vr(n),n?Vr(Rr.a.decode(n)):n=qr;var a,i=0,o=1,r=2,c=null,l=null,u=null,d=null;Vr("check pyld token");try{c=Fr(n),l=Rr.a.decode(n).exp,i+=o}catch(t){Vr("Payload token invalid :: ".concat(t))}Vr("Check stored token");try{u=window.ls.get(V.tokenName,qr),d=Rr.a.decode(t.getters.axsToken).exp,i+=r}catch(t){Vr("Stored token invalid :: ".concat(t))}switch(i){case 1:Vr("Committing token from payload"),s=c;break;case 2:Vr("Refreshing stored token from payload"),s=u;break;case 3:a=l>d,Vr("Refreshing ".concat(a?"payload token":"stored token"," from payload")),s=a?c:u;break;default:}t.commit("saveToken",s)},logIn:function(t){t.commit;var e=t.dispatch;e("setActivity",Br),e("authenticate")},authenticate:function(t){t.commit,t.dispatch;var e="STATIC_PUB",n="";window.lgr.info("Auth(action) :: Authenticating... ".concat(e)),n="".concat(V.server).concat(V.authPath,"?mode=").concat(e);var s=Object({NODE_ENV:"production",VUE_APP_STATIC_MODE:"STATIC_PUB",VUE_APP_COUCH_PROTOCOL:"https",VUE_APP_COUCH_URI:"yourdb.yourpublic.work",VUE_APP_COUCH_NAME:"ib2018_101",BASE_URL:"/"})[V.testAuthUrlEnvVar];window.lgr.info("Auth(action) :: Faked authentication URL :: ".concat(s)),s&&(n=s),window.location.assign(n),ml.$route.name.includes("home")||(window.lgr.info("Auth(action) :: Set return route in local storage - ".concat(V.returnRouteName,': "').concat(ml.$route.name,'"')),window.ls.set(V.returnRouteName,ml.$route.name))},logOut:function(t){var e=t.commit,n=t.dispatch;n("setActivity",Jr),n("setAuth",Yr),e("toSignedOut")},setActivity:function(t,e){var n=t.commit;n("activity",e)},setAuth:function(t,e){var n=t.commit;n("auth",e)},handle401:function(t){var e=9e5,n=(new Date).getTime()/1e3,s=t.state.accessExpiry-n;Vr("sessionTime  - ".concat(e)),Vr("now  - ".concat(n/1e3)),Vr("exp  - ".concat(t.state.accessExpiry)),Vr("remaining  - ".concat(s));var a=s>1?"expired":"remaining validity (secs): ".concat(s);window.lgr.info("Auth(action) handle401:: Token status : ".concat(a)),t.state.authenticated<1?(window.lgr.info("Auth(action) handle401:: Not logged in."),t.dispatch("logIn")):s<1?(window.lgr.info("Auth(action) handle401:: Expired token."),t.dispatch("notifyUser",{txt:"Your session expired. Logging you in again.",lvl:"is-warning"}),t.dispatch("logIn")):(window.lgr.info("Auth(action) handle401:: Wrong user??"),window.ls.storage.removeItem(V.localStorageNameSpace+V.returnRouteName))}},Hr={state:zr,getters:Gr,mutations:Kr,actions:Wr},Zr=console.log;s["default"].use(N["a"]);var Xr=new N["a"].Store({state:Object(A["a"])({counter:0,isDebug:!1,isError:!1,msgError:{txt:"We got failure happening",lvl:"is-warning"},axsRights:["visitor"],integrityCheck:{person:9999,product:8888,invoice:7777}},Object(d["formulateState"])()()),getters:Object(A["a"])({isDebug:function(t){return t.isDebug},isError:function(t){return t.isError},msgError:function(t){return t.msgError},theRoles:function(t){return window.lgr.debug(t.axsRights),t.axsRights},theCounter:function(t){return{cntr:t.counter,other:"okok"}},theFormData:function(){return{email:"a@b.ca",password_confirmation:"qwer",password:"qwer"}}},Object(d["formulateGetters"])()),mutations:Object(A["a"])({notifyUser:function(t,e){window.lgr.warn(e.txt),Zr(t),t.msgError=e,t.isError=!0},debugMode:function(t,e){t.isDebug=e},updateIntegrityCheck:function(t,e){window.lgr.warn(e),t.integrityCheck=e},clearNotifyUser:function(t){t.msgError="",t.isError=!1},axsRole:function(t,e){window.lgr.debug(e.roles),t.axsRights=e.roles},increment:function(t){window.lgr.warn("UU"),t.counter+=1},decrement:function(t){Zr("DD"),t.counter-=1},fillFormPerX:function(t){Zr("QQQQQ GG QQQQQQ"),Zr(t),t.values.person={email:"a@b.es",description:"qwer",name:"qwer"}},fillForm:function(t){Zr("QQQQQQQQQQQ"),Zr(t),t.values.registration={email:"a@b.c",password_confirmation:"qwer",password:"qwer"}}},Object(d["formulateMutations"])()),actions:{updateIntegrityCheck:function(t,e){var n=t.commit;n("updateIntegrityCheck",e)},notifyUser:function(t,e){var n=t.commit;n("notifyUser",e)},clearNotifyUser:function(t){var e=t.commit;e("clearNotifyUser")},debugMode:function(t,e){var n=t.commit;n("debugMode",e)},setAxsRole:function(t,e){var n=t.commit;n("axsRole",e)},increment:function(t){return Zr("QQQQQ  increment QQQQQQ"),Zr(t),t.commit("increment")},decrement:function(t){var e=t.commit;e("decrement")},fillForm:function(t){var e=t.commit;e("fillForm")}},modules:{Auth:Hr,a12n:Se,dbmgr:lr,person:vn,product:Mn,invoice:va,bottle:Ai,movement:Lr}}),tc=(n("673e"),{id:"es-AR",message:{hello:"Che!"}}),ec={id:"es-419",message:{hello:"Hola!"}},nc={id:"es",sub:[ec,tc],message:{hello:"Saludos amigos!!!"},label:{signup:"Inscribirse",signin:"Ingresar",signout:"Salir"}},sc={id:"en-GB",message:{hello:"Watcha!"}},ac={id:"en-US",message:{hello:"Howdy",damned:"Thrown under a bus"}},ic={id:"en",sub:[ac,sc],message:{hello:"Hello!!!",damned:"Thrown to the wolves"},label:{signup:"Join",signin:"Log in",signout:"Log out"}},oc=[nc,ic],rc={};oc.forEach(function(t){t.sub.forEach(function(t){rc[t.id]=t}),rc[t.id]=t});var cc=rc,lc=n("8c4f"),uc=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticStyle:{"margin-left":"30px"}},[n("h1",[t._v("Some Protected Sections!")]),n("ol",[n("li",[n("h3",[t._v("Read-only view")]),t.$can("only_view","protected")?n("p",{staticStyle:{"margin-left":"30px"}},[t._v("\n        You are allowed to see this text.\n      ")]):t._e()]),n("li",[n("h3",[t._v("Limited Edits")]),t.$can("comment","protected")?n("p",{staticStyle:{"margin-left":"30px"}},[t._v("\n        You are allowed to make some edits.\n      ")]):t._e()]),n("li",[n("h3",[t._v("Any Edits")]),t.$can("alter","protected")?n("p",{staticStyle:{"margin-left":"30px"}},[t._v("\n        You are allowed any edits of this resource.\n      ")]):t._e()]),n("li",[n("h3",[t._v("Alter Privileges")]),t.$can("assign","protected")?n("p",{staticStyle:{"margin-left":"30px"}},[t._v("\n        You are allowed to control access to this resource.\n      ")]):t._e()])]),n("hr"),n("p",[t._v("Unprotected text")]),n("p",{directives:[{name:"show",rawName:"v-show",value:t.$can("only_view","protected"),expression:"$can('only_view', 'protected')"}]},[t._v("Protected text!")]),t._v("\n  "+t._s(t.qtst)+"\n\n  "),n("hr"),n("router-link",{staticClass:"button is-small is-link is-outlined",attrs:{to:{name:"home"}}},[n("icon",{attrs:{name:"arrow-circle-up"}}),t._v("\n     Home\n  ")],1),n("router-link",{staticClass:"button is-small is-link is-outlined",attrs:{to:{name:"classified"}}},[n("icon",{attrs:{name:"arrow-circle-right"}}),t._v("\n     Classified\n  ")],1)],1)},dc=[],mc=console.log,vc={computed:{qtst:function(){var t=" ------- Quick Test -------";return mc(t),mc(we),mc(this.$ability),mc(window.ability),mc(this.$can("alter","protected")),t}}},pc=vc,fc=Object(I["a"])(pc,uc,dc,!1,null,null,null);fc.options.__file="Protected.vue";var bc=fc.exports,hc=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"columns is-mobile"},[n("div",{staticClass:"column is-one-quarter"}),n("Container",{staticClass:"column is-one-quarter",attrs:{"group-name":"1","get-child-payload":t.sourcePayload},on:{drop:function(e){t.onDrop("source",e)}}},t._l(t.source,function(e){return n("Draggable",{key:e.id},[n("div",{staticClass:"draggable-item"},[t._v("\n        "+t._s(e.data)+"\n      ")])])})),n("Container",{staticClass:"column is-one-quarter",attrs:{"group-name":"1","get-child-payload":t.targetPayload},on:{drop:function(e){t.onDrop("target",e)}}},t._l(t.target,function(e){return n("Draggable",{key:e.id},[n("div",{staticClass:"draggable-item"},[t._v("\n        "+t._s(e.data)+"\n      ")])])})),n("div",{staticClass:"column is-one-quarter"})],1)},gc=[],Cc={name:"Groups",components:{Container:yo["Container"],Draggable:yo["Draggable"]},data:function(){return{source:[{id:100001,data:"IBAA001"},{id:100005,data:"IBAA005"}],target:[{id:100014,data:"IBAA014"},{id:100015,data:"CLAA015"}]}},methods:{onDrop:function(t,e){this[t]=Oo(this[t],e)},sourcePayload:function(t){return this.source[t]},targetPayload:function(t){return this.target[t]}}},wc=Cc,_c=Object(I["a"])(wc,hc,gc,!1,null,null,null);_c.options.__file="Classified.vue";var yc=_c.exports,xc=(console.log,[{name:Ht,path:"protected",component:bc},{name:Zt,path:"classified",component:yc}]),Oc=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",[n("NavBar"),n("PseudoAuthorizations"),n("router-view"),n("router-view",{attrs:{name:"helper"}}),n("Footer")],1)},kc=[],Dc=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.isDebug?n("div",{attrs:{id:"pauth"}},[n("b-collapse",{attrs:{id:"divTbl",open:!1}},[n("button",{staticClass:"button is-small is-primary",attrs:{slot:"trigger"},slot:"trigger"},[t._v("Authorizations Tester")]),n("div",[n("table",{staticClass:"table is-narrow is-hoverable is-size-6",attrs:{id:"axsCtrl"}},[n("thead",[n("tr",[n("th",{attrs:{id:"colRsrc"}},[t._v("Resource")]),n("th",{attrs:{id:"colPrvlg"}},[t._v("Privilege")])])]),n("tbody",t._l(t.getUserPermissions,function(e,s,a){return n("tr",[n("th",{staticClass:"is-size-7",attrs:{id:"colRsrc"}},[t._v(t._s(s))]),n("td",{attrs:{id:"colPrvlg"}},[n("b-field",[n("b-select",{staticClass:"is-size-7",attrs:{id:s,placeholder:t.axsLvls[0].axs},nativeOn:{change:function(e){return t.updPermissions(e)}},model:{value:t.user.permissions[s],callback:function(e){t.$set(t.user.permissions,s,e)},expression:"user.permissions[key]"}},t._l(t.axsLvls,function(e){return n("option",{key:e.id,domProps:{value:e.id}},[t._v("\n                     "+t._s(e.axs)+"\n                    ")])}))],1)],1)])})),n("tfoot",{staticClass:"is-hidden"},[n("tr",[n("th",{attrs:{id:"colRsrc"}},[t._v("Resource")]),n("th",{attrs:{id:"colPrvlg"}},[t._v("Privilege")])])])])])]),t._v("\n\n"+t._s(t.getUserPermissions)+"\n\n  ")],1):t._e()},Ec=[],Pc=console.log,Sc={data:function(){return{axsLvls:we.olvls,axsLvl:{Example:0,Person:3},role:"admin"}},computed:Object(A["a"])({},Object(N["d"])("a12n",["domains","user"]),Object(N["c"])("a12n",["getUserPermissions"]),Object(N["c"])({isDebug:"isDebug"})),methods:Object(A["a"])({},Object(N["b"])("a12n",["changePermissions"]),{onRoleChange:function(){Pc("================================ ".concat(this.domains)),this.changeRole(this.role)},updPermissions:function(t){this.changePermissions({change:{resource:t.target.id,setting:t.target.value},ability:this.$ability})}})},Ic=Sc,jc=(n("975e"),Object(I["a"])(Ic,Dc,Ec,!1,null,"2e069d99",null));jc.options.__file="PseudoAuthorizations.vue";var Tc=jc.exports,Ac=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("section",[n("b-notification",{attrs:{type:t.msgError.lvl,"has-icon":"",active:t.isError},on:{"update:active":function(e){t.isError=e}}},[t._v("\n      "+t._s(t.msgError.txt)+"\n    ")])],1),n("div",{staticClass:"control"},[n("b-switch",{attrs:{type:"is-danger"},model:{value:t.aclDebug,callback:function(e){t.aclDebug=e},expression:"aclDebug"}},[t._v("\n      Debug\n    ")])],1),t.aclDebug?n("div",[n("div",{staticClass:"mdl-grid"},[n("div",{staticClass:"mdl-cell mdl-cell--3-col mdl-cell mdl-cell--1-col-tablet mdl-cell--hide-phone"},[n("router-link",{staticClass:"mdl-button mdl-js-button mdl-button--fab mdl-button--colored",attrs:{to:{name:"persons"}}},[n("i",{staticClass:"material-icons"},[t._v("Persons")])]),n("router-link",{staticClass:"mdl-button mdl-js-button mdl-button--fab mdl-button--colored",attrs:{to:{name:"ohv"}}},[n("i",{staticClass:"material-icons"},[t._v("Old Home ")])])],1)]),n("a",{staticClass:"button is-small"},[t._v(t._s(t.isHere))]),n("a",{staticClass:"button is-small"},[t._v(t._s(t.isKnown))]),t._m(0),n("div",[t._v('\n      User status :: " '+t._s(t.getExpiry())+' "\n    ')]),n("a",{staticClass:"button is-small",on:{click:t.qtst}},[t._v("\n      Quick Tests\n    ")])]):n("div",{staticClass:"is-small"},[t._v("Version :: v"+t._s(t.theVersion))])])},Nc=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("p",{staticClass:"content"},[n("b",[t._v("Privileges:")]),t._v("\n      { { access } }\n    ")])}],Lc=console.log,$c={methods:{getExpiry:function(){try{var t=new Date(1e3*Rr.a.decode(this.tkn).exp),e=new Date;return"Token expiry at ".concat(t.getDate()," ").concat(t.toTimeString(),"  vs  ").concat(e.getDate()," ").concat(e.toTimeString())}catch(t){return"Logged out"}},qtst:function(){Lc(" ------- Quick Test -------")}},computed:Object(A["a"])({aclDebug:{get:function(){return this.$store&&this.$store.state&&this.$store.state.isDebug||!1},set:function(){Lc(this),this.$store.dispatch("debugMode",this.$store.state.isDebug=!this.$store.state.isDebug)}},theVersion:function(){return window.version}},Object(N["c"])({tkn:"axsToken",isHere:"isActive",isKnown:"isAuthenticated",isError:"isError",msgError:"msgError"}))},Rc=$c,Uc=Object(I["a"])(Rc,Ac,Nc,!1,null,null,null);Uc.options.__file="Footer.vue";var Mc=Uc.exports,Fc={components:{PseudoAuthorizations:Tc,NavBar:Co,Authentication:Qi,Footer:Mc}},Bc=Fc,Jc=(n("63fe"),Object(I["a"])(Bc,Oc,kc,!1,null,"0b628fa2",null));Jc.options.__file="BaseLayer.vue";var Qc=Jc.exports,Yc=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},qc=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("h3",[t._v("Email Subscriptions")])])}],Vc={},zc=Object(I["a"])(Vc,Yc,qc,!1,null,null,null);zc.options.__file="UserEmailsSubscriptions.vue";var Gc=zc.exports,Kc=(console.log,[]),Wc=[{path:"emails",name:"emails",components:{nav_bar:Co,default:Gc},props:{nav_bar:{setTab:"Admin"}}}],Hc=Kc.concat(xc).concat(un).concat($n).concat(la).concat(Si).concat(Nr).concat(Wc),Zc=[{path:"",name:"start",component:Qc,children:Hc}];s["default"].use(lc["a"]);var Xc=console.log,tl=[],el=tl.concat(Zc),nl=function(t,e,n){if(window.lgr&&window.lgr.info("Guard: processServerSideChanges."),Xr&&Xr.state&&Xr.state.Auth&&Xr.state.Auth.accessToken.length>10){var s="".concat(V.server,"/api/metadata"),a={headers:{Accept:"application/json, text/plain, */*",Authorization:"JWT ".concat(Xr.state.Auth.accessToken)}};zo.a.get(s,a).then(function(t){var e=t.data.metadata.checks,n=Xr.state.integrityCheck;Object.keys(e).forEach(function(t){e[t]!==n[t]&&(n[t]=e[t],Xc("will call -- store.dispatch('".concat(t,"/fetchAll')")),Xr.dispatch("".concat(t,"/fetchAll")),Xr.dispatch("updateIntegrityCheck",n))})}).catch(function(t){Xc("*** Error while fetching metadata :: >".concat(t.message,"<***")),Xc(t.message),t.message.endsWith("401")?Xr.dispatch("handle401",null,{root:!0}):Xr.dispatch("notifyUser",{txt:"Error fetching invoices :: ".concat(t.message),lvl:"is-danger"},{root:!0})})}return null},sl=function(t,e,n){return window.lgr&&window.lgr.info("Guard: clearErrorNotification."),Xr.dispatch("clearNotifyUser"),null},al=[];al=al.concat(nl).concat(sl).concat(Oe);var il=new lc["a"]({routes:el});il.beforeEach(function(t,e,n){Xc("Router.beforeEach ==> Routing from '".concat(e.name,"' to '").concat(t.name,"'. Params '").concat(e.params,"').")),Xc(t),Xc(e),Xc("beforeEachTasks.length ".concat(al.length)),Xc(al);var s=null;al.forEach(function(a){null===s&&(s=a(t,e,n))}),null===s?n():n(s)});var ol=il,rl=console.log;s["default"].use(ot),s["default"].use(r["b"],ye),s["default"].component("Can",r["a"]),s["default"].use(l.a,V.logger),s["default"].use(a["a"]),s["default"].use(o.a,{namespace:"vuesppwa-"}),s["default"].use(f.a,{defaultIconPack:"fa"}),s["default"].use(h.a),s["default"].use(m.a,{rules:{isPct:function(t){var e=t.value;return!C.a.inRange(e||0,0,101)&&"Value ".concat(e," is not in range 0 to 100.")}}}),s["default"].use(w["a"]),s["default"].component("icon",u["a"]),s["default"].config.productionTip=V.productionTip;var cl=cc,ll=navigator.languages[0]||"en",ul=new a["a"]({locale:ll.split("-")[0]||"en",fallbackLocale:"en",messages:cl});Object(v["sync"])(Xr,ol);var dl=new s["default"]({el:"#app",i18n:ul,router:ol,store:Xr,beforeCreate:function(){rl("<<<<<<<<<< beforeCreate >>>>>>>>>>>"),window.lgr=this.$log,window.ls=this.$ls,window.ability=this.$ability,this.$store.dispatch("dbmgr/rememberDbMgr",{dbmgr:this.$pouch});var t=this.$route.query.tkn?this.$route.query.tkn:this.$ls.get(V.tokenName);rl("<<<<<<<<<< keeping token >>>>>>>>>>>"),this.$store.dispatch("keepTkn",{token:t,ability:this.$ability}),this.$store.dispatch("dbmgr/collectCategoryCounts")},created:function(){rl("<<<<<<<<<< created >>>>>>>>>>>"),window.version=V.version,this.$log.info("microservice = ".concat(V.server)),rl("\n      !!!!!!!!!?  returnToExitPoint  ?!!!!!!!!!");var t=window.localStorage,e=V.localStorageNameSpace+V.returnRouteName,n=JSON.parse(t.getItem(e));if(n){var s=n.value;s&&s.length>0&&!s.includes("home")&&(rl("\n    !!!!!!!!!?  return to ".concat(s,"  !!!!!!!!!")),rl(this.$router.push({name:s})),t.removeItem(e))}},render:function(t){return t(T)}}),ml=e["default"]=dl},5764:function(t,e,n){},6101:function(t,e,n){"use strict";var s=n("44f7"),a=n.n(s);a.a},"63fe":function(t,e,n){"use strict";var s=n("f1c5"),a=n.n(s);a.a},"6c59":function(t,e,n){},7425:function(t,e,n){"use strict";var s=n("6c59"),a=n.n(s);a.a},"777f":function(t,e,n){"use strict";var s=n("bf52"),a=n.n(s);a.a},"7b60":function(t,e,n){"use strict";var s=n("9ca1"),a=n.n(s);a.a},"852f":function(t,e,n){},9294:function(t,e,n){},"975e":function(t,e,n){"use strict";var s=n("9294"),a=n.n(s);a.a},"9be0":function(t,e,n){},"9ca1":function(t,e,n){},b1e1:function(t,e,n){},b295:function(t,e,n){"use strict";var s=n("852f"),a=n.n(s);a.a},b7fe:function(t,e,n){},ba60:function(t,e,n){},bce2:function(t,e,n){},bf52:function(t,e,n){},c21b:function(t,e,n){},c2e7:function(t,e,n){"use strict";var s=n("e514"),a=n.n(s);a.a},c742:function(t,e,n){},c9ea:function(t,e,n){},d224:function(t,e,n){"use strict";var s=n("c9ea"),a=n.n(s);a.a},d662:function(t,e,n){},d8f1:function(t,e,n){},d968:function(t,e,n){},da9c:function(t,e,n){},e514:function(t,e,n){},e7e0:function(t,e,n){"use strict";var s=n("3e91"),a=n.n(s);a.a},ecdc:function(t,e,n){"use strict";var s=n("bce2"),a=n.n(s);a.a},ee67:function(t,e,n){},f021:function(t,e,n){"use strict";var s=n("ba60"),a=n.n(s);a.a},f1c5:function(t,e,n){},f72f:function(t,e,n){"use strict";var s=n("b1e1"),a=n.n(s);a.a},fa42:function(t,e,n){"use strict";var s=n("d968"),a=n.n(s);a.a},fdca:function(t,e,n){}});
//# sourceMappingURL=app.d6aa78b1.js.map